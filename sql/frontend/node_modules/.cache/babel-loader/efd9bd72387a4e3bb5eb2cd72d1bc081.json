{"ast":null,"code":"import { getTextWidth, getTextHeight, assembleFont } from '../util/text';\nexport default function (shape) {\n  var attrs = shape.attr();\n  var x = attrs.x,\n      y = attrs.y,\n      text = attrs.text,\n      fontSize = attrs.fontSize,\n      lineHeight = attrs.lineHeight;\n  var font = attrs.font;\n\n  if (!font) {\n    // 如果未组装 font\n    font = assembleFont(attrs);\n  }\n\n  var width = getTextWidth(text, font);\n  var bbox;\n\n  if (!width) {\n    // 如果width不存在，四点共其实点\n    bbox = {\n      x: x,\n      y: y,\n      width: 0,\n      height: 0\n    };\n  } else {\n    var textAlign = attrs.textAlign,\n        textBaseline = attrs.textBaseline;\n    var height = getTextHeight(text, fontSize, lineHeight); // attrs.height\n    // 默认左右对齐：left, 默认上下对齐 bottom\n\n    var point = {\n      x: x,\n      y: y - height\n    };\n\n    if (textAlign) {\n      if (textAlign === 'end' || textAlign === 'right') {\n        point.x -= width;\n      } else if (textAlign === 'center') {\n        point.x -= width / 2;\n      }\n    }\n\n    if (textBaseline) {\n      if (textBaseline === 'top') {\n        point.y += height;\n      } else if (textBaseline === 'middle') {\n        point.y += height / 2;\n      }\n    }\n\n    bbox = {\n      x: point.x,\n      y: point.y,\n      width: width,\n      height: height\n    };\n  }\n\n  return bbox;\n}","map":{"version":3,"sources":["../../src/bbox/text.ts"],"names":[],"mappings":"AAEA,SAAS,YAAT,EAAuB,aAAvB,EAAsC,YAAtC,QAA0D,cAA1D;AAEA,eAAc,UAAW,KAAX,EAAwB;AACpC,MAAM,KAAK,GAAG,KAAK,CAAC,IAAN,EAAd;AACQ,MAAA,CAAC,GAAoC,KAAK,CAAzC,CAAD;AAAA,MAAG,CAAC,GAAiC,KAAK,CAAtC,CAAJ;AAAA,MAAM,IAAI,GAA2B,KAAK,CAAhC,IAAV;AAAA,MAAY,QAAQ,GAAiB,KAAK,CAAtB,QAApB;AAAA,MAAsB,UAAU,GAAK,KAAK,CAAV,UAAhC;AACR,MAAI,IAAI,GAAG,KAAK,CAAC,IAAjB;;AACA,MAAI,CAAC,IAAL,EAAW;AACT;AACA,IAAA,IAAI,GAAG,YAAY,CAAC,KAAD,CAAnB;AACD;;AACD,MAAM,KAAK,GAAG,YAAY,CAAC,IAAD,EAAO,IAAP,CAA1B;AACA,MAAI,IAAJ;;AACA,MAAI,CAAC,KAAL,EAAY;AACV;AACA,IAAA,IAAI,GAAG;AACL,MAAA,CAAC,EAAA,CADI;AAEL,MAAA,CAAC,EAAA,CAFI;AAGL,MAAA,KAAK,EAAE,CAHF;AAIL,MAAA,MAAM,EAAE;AAJH,KAAP;AAMD,GARD,MAQO;AACG,QAAA,SAAS,GAAmB,KAAK,CAAxB,SAAT;AAAA,QAAW,YAAY,GAAK,KAAK,CAAV,YAAvB;AACR,QAAM,MAAM,GAAG,aAAa,CAAC,IAAD,EAAO,QAAP,EAAiB,UAAjB,CAA5B,CAFK,CAEqD;AAC1D;;AACA,QAAM,KAAK,GAAG;AACZ,MAAA,CAAC,EAAA,CADW;AAEZ,MAAA,CAAC,EAAE,CAAC,GAAG;AAFK,KAAd;;AAIA,QAAI,SAAJ,EAAe;AACb,UAAI,SAAS,KAAK,KAAd,IAAuB,SAAS,KAAK,OAAzC,EAAkD;AAChD,QAAA,KAAK,CAAC,CAAN,IAAW,KAAX;AACD,OAFD,MAEO,IAAI,SAAS,KAAK,QAAlB,EAA4B;AACjC,QAAA,KAAK,CAAC,CAAN,IAAW,KAAK,GAAG,CAAnB;AACD;AACF;;AACD,QAAI,YAAJ,EAAkB;AAChB,UAAI,YAAY,KAAK,KAArB,EAA4B;AAC1B,QAAA,KAAK,CAAC,CAAN,IAAW,MAAX;AACD,OAFD,MAEO,IAAI,YAAY,KAAK,QAArB,EAA+B;AACpC,QAAA,KAAK,CAAC,CAAN,IAAW,MAAM,GAAG,CAApB;AACD;AACF;;AAED,IAAA,IAAI,GAAG;AACL,MAAA,CAAC,EAAE,KAAK,CAAC,CADJ;AAEL,MAAA,CAAC,EAAE,KAAK,CAAC,CAFJ;AAGL,MAAA,KAAK,EAAA,KAHA;AAIL,MAAA,MAAM,EAAA;AAJD,KAAP;AAMD;;AACD,SAAO,IAAP;AACD","sourceRoot":"","sourcesContent":["import { getTextWidth, getTextHeight, assembleFont } from '../util/text';\r\nexport default function (shape) {\r\n    var attrs = shape.attr();\r\n    var x = attrs.x, y = attrs.y, text = attrs.text, fontSize = attrs.fontSize, lineHeight = attrs.lineHeight;\r\n    var font = attrs.font;\r\n    if (!font) {\r\n        // 如果未组装 font\r\n        font = assembleFont(attrs);\r\n    }\r\n    var width = getTextWidth(text, font);\r\n    var bbox;\r\n    if (!width) {\r\n        // 如果width不存在，四点共其实点\r\n        bbox = {\r\n            x: x,\r\n            y: y,\r\n            width: 0,\r\n            height: 0,\r\n        };\r\n    }\r\n    else {\r\n        var textAlign = attrs.textAlign, textBaseline = attrs.textBaseline;\r\n        var height = getTextHeight(text, fontSize, lineHeight); // attrs.height\r\n        // 默认左右对齐：left, 默认上下对齐 bottom\r\n        var point = {\r\n            x: x,\r\n            y: y - height,\r\n        };\r\n        if (textAlign) {\r\n            if (textAlign === 'end' || textAlign === 'right') {\r\n                point.x -= width;\r\n            }\r\n            else if (textAlign === 'center') {\r\n                point.x -= width / 2;\r\n            }\r\n        }\r\n        if (textBaseline) {\r\n            if (textBaseline === 'top') {\r\n                point.y += height;\r\n            }\r\n            else if (textBaseline === 'middle') {\r\n                point.y += height / 2;\r\n            }\r\n        }\r\n        bbox = {\r\n            x: point.x,\r\n            y: point.y,\r\n            width: width,\r\n            height: height,\r\n        };\r\n    }\r\n    return bbox;\r\n}\r\n//# sourceMappingURL=text.js.map"]},"metadata":{},"sourceType":"module"}