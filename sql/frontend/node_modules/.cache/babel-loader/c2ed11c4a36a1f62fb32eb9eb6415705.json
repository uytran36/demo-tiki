{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nimport G6 from '@antv/g6';\nimport { defaultMargin, defaultLabelStyle, defaultTitleLabelStyle, defaultTitleRectStyle, defaultCardStyle, defaultIconStyle } from './constants';\nimport { getStyle, getCssPadding } from './utils';\nimport { createMarker } from './elements'; // 通用指标卡\n\nexport var registerIndicatorCardNode = function () {\n  G6.registerNode('indicator-card', {\n    // @ts-ignore\n    draw: function (cfg, group) {\n      if (cfg === void 0) {\n        cfg = {};\n      }\n\n      var _a = cfg.value,\n          value = _a === void 0 ? {} : _a,\n          nodeCfg = cfg.nodeCfg,\n          markerCfg = cfg.markerCfg;\n      var _b = nodeCfg,\n          titleCfg = _b.title,\n          itemsCfg = _b.items,\n          _c = _b.label,\n          label = _c === void 0 ? {} : _c,\n          style = _b.style,\n          _d = _b.padding,\n          padding = _d === void 0 ? 0 : _d,\n          customContent = _b.customContent;\n      var labelStyle = label.style;\n      var paddingArray = getCssPadding(padding);\n\n      var _e = titleCfg !== null && titleCfg !== void 0 ? titleCfg : {},\n          titleStyle = _e.style,\n          titleContainerStyle = _e.containerStyle;\n\n      var _f = itemsCfg !== null && itemsCfg !== void 0 ? itemsCfg : {},\n          itemStyle = _f.style,\n          itemContainerStyle = _f.containerStyle,\n          layout = _f.layout,\n          _g = _f.itemSpacing,\n          itemSpacing = _g === void 0 ? 4 : _g,\n          sort = _f.sort,\n          _h = _f.padding,\n          itemPadding = _h === void 0 ? [6, 0, 0] : _h;\n\n      var itemPaddingArray = getCssPadding(itemPadding);\n      var _j = value,\n          title = _j.title,\n          items = _j.items;\n      var size = (cfg === null || cfg === void 0 ? void 0 : cfg.size) || [100, 30];\n      if (typeof size === 'number') size = [size, size];\n      var height = 0; // 统计容器总高度，动态设置\n\n      var shapeWidth = size[0];\n      var contentWidth = shapeWidth - paddingArray[1] - paddingArray[3]; // card box\n\n      var cardStyle = getStyle(style, cfg, group);\n      var shape = group.addShape('rect', {\n        attrs: __assign(__assign({\n          x: 0,\n          y: 0,\n          width: size[0],\n          height: size[1]\n        }, defaultCardStyle), cardStyle),\n        name: 'main-box',\n        draggable: true\n      }); // node title\n\n      var titleTextShape, itemShape, titleShape;\n\n      if (title) {\n        // title rect\n        titleShape = group.addShape('rect', {\n          attrs: __assign(__assign({\n            x: 0,\n            y: 0,\n            width: size[0],\n            height: 0\n          }, defaultTitleRectStyle), getStyle(titleContainerStyle, cfg, group)),\n          name: 'title-rect',\n          draggable: true\n        });\n        titleTextShape = group.addShape('text', {\n          attrs: __assign(__assign({\n            x: paddingArray[3],\n            y: paddingArray[0],\n            textBaseline: 'top',\n            text: title\n          }, defaultTitleLabelStyle), getStyle(titleStyle, cfg, group)),\n          name: 'title'\n        });\n        var titleHeight = (titleTextShape ? titleTextShape.getBBox() : {\n          height: size[1] / 2\n        }).height;\n        titleShape === null || titleShape === void 0 ? void 0 : titleShape.attr('height', titleHeight + paddingArray[0] + paddingArray[2]);\n        height += titleShape.getBBox().height;\n      }\n\n      if (items) {\n        itemShape = group.addShape('rect', {\n          attrs: __assign({\n            x: paddingArray[3],\n            y: height,\n            width: contentWidth,\n            height: 0\n          }, getStyle(itemContainerStyle, cfg, group)),\n          name: 'item-box'\n        });\n        height += itemPaddingArray[0];\n        var itemContentWidth_1 = contentWidth - itemPaddingArray[1] - itemPaddingArray[3];\n        var isArray_1 = Array.isArray(items);\n\n        var createRowItems_1 = function (item, contentWidth, startX, index) {\n          if (index === void 0) {\n            index = 0;\n          }\n\n          var rowHeight = [];\n          var valueShapeWidth = 0;\n          var keys = sort ? Object.keys(item) : ['text', 'value', 'icon'];\n          keys.forEach(function (key, keyIndex) {\n            var x;\n            var isIcon = key.startsWith('icon'); // sort 直接均分，简单化\n\n            if (sort || layout === 'flex') {\n              x = keyIndex * contentWidth / keys.length;\n            } else if (layout === 'follow') {\n              x = valueShapeWidth;\n            } else {\n              // layout === 'bundled'\n              // 直接均分，icon 紧随 value\n              x = key === 'text' ? 0 : contentWidth / 2;\n              x += isIcon ? valueShapeWidth : 0;\n            }\n\n            var keyShape = group.addShape(isIcon ? 'image' : 'text', {\n              attrs: __assign(__assign({\n                textBaseline: 'top',\n                x: startX + x,\n                y: height,\n                text: item[key],\n                img: item[key]\n              }, isIcon ? defaultIconStyle : defaultLabelStyle), getStyle(itemStyle || labelStyle, cfg, group, key)),\n              name: key + \"-\" + index + \"-\" + keyIndex\n            });\n\n            if (key === 'value' || layout === 'follow') {\n              valueShapeWidth += keyShape.getBBox().width;\n              valueShapeWidth += layout === 'follow' ? itemSpacing : 0;\n            }\n\n            rowHeight.push(keyShape.getBBox().height);\n          });\n          return rowHeight;\n        };\n\n        var createItems_1 = function (item, index) {\n          var _a;\n\n          if (index === void 0) {\n            index = 0;\n          }\n\n          var itemsHeight = [];\n\n          if (customContent) {\n            itemsHeight.push((_a = customContent(item, group, {\n              startX: paddingArray[3] + itemPaddingArray[3],\n              startY: height,\n              width: itemContentWidth_1\n            })) !== null && _a !== void 0 ? _a : 0);\n          } else {\n            itemsHeight.push.apply(itemsHeight, createRowItems_1(item, itemContentWidth_1, paddingArray[3] + itemPaddingArray[3], index));\n          }\n\n          height += Math.max.apply(Math, itemsHeight);\n\n          if (isArray_1 && index !== items.length - 1) {\n            height += defaultMargin;\n          }\n        };\n\n        if (Array.isArray(items)) {\n          items.forEach(function (item, index) {\n            createItems_1(item, index);\n          });\n        } else {\n          createItems_1(items);\n        }\n      }\n\n      itemShape === null || itemShape === void 0 ? void 0 : itemShape.attr('height', Math.max(height - (titleShape === null || titleShape === void 0 ? void 0 : titleShape.getBBox().height) + itemPaddingArray[2], size[1]));\n      shape === null || shape === void 0 ? void 0 : shape.attr('height', items ? (titleShape === null || titleShape === void 0 ? void 0 : titleShape.getBBox().height) + (itemShape === null || itemShape === void 0 ? void 0 : itemShape.getBBox().height) + paddingArray[2] : (titleShape === null || titleShape === void 0 ? void 0 : titleShape.getBBox().height) + (itemShape === null || itemShape === void 0 ? void 0 : itemShape.getBBox().height)); // collapse marker\n\n      if (markerCfg) {\n        var _k = shape.getBBox(),\n            shapeWidth_1 = _k.width,\n            shapeHeight = _k.height;\n\n        var _l = typeof markerCfg === 'function' ? markerCfg(cfg, group) : markerCfg,\n            show = _l.show,\n            _m = _l.position,\n            position = _m === void 0 ? 'right' : _m,\n            collapsed = _l.collapsed,\n            markerStyle = _l.style;\n\n        createMarker({\n          show: show,\n          position: position,\n          collapsed: collapsed,\n          style: markerStyle\n        }, group, [shapeWidth_1, shapeHeight]);\n        shape.attr('defaultCollapsed', collapsed);\n      }\n\n      return shape;\n    },\n\n    /**\r\n     * 更新节点，包含文本\r\n     * @override\r\n     * @param  {Object} cfg 节点的配置项\r\n     * @param  {Node} node 节点\r\n     */\n    update: function (cfg, node) {\n      var group = node.getContainer();\n      var markerShape = group.get('children').find(function (item) {\n        return item.get('type') === 'marker';\n      });\n      var collapsed = node.getModel().collapsed;\n      markerShape === null || markerShape === void 0 ? void 0 : markerShape.attr({\n        symbol: collapsed ? G6.Marker.expand : G6.Marker.collapse\n      });\n    }\n  }, 'single-node');\n}; // 组织架构图\n\nexport var registerOrganizationCardNode = function () {\n  G6.registerNode('organization-card', {\n    draw: function (cfg, group) {\n      if (cfg === void 0) {\n        cfg = {};\n      }\n\n      var _a = cfg.value,\n          value = _a === void 0 ? {} : _a,\n          nodeCfg = cfg.nodeCfg,\n          markerCfg = cfg.markerCfg;\n      var _b = nodeCfg,\n          style = _b.style,\n          _c = _b.padding,\n          padding = _c === void 0 ? 0 : _c,\n          _d = _b.label,\n          label = _d === void 0 ? {} : _d,\n          customContent = _b.customContent;\n      var labelStyle = label.style;\n      var paddingArray = getCssPadding(padding);\n      var size = (cfg === null || cfg === void 0 ? void 0 : cfg.size) || [100, 30];\n      if (typeof size === 'number') size = [size, size];\n      var height = 0; // 统计容器总高度，动态设置，宽度不做调整\n\n      var contentWidth = size[0] - paddingArray[1] - paddingArray[3]; // card box\n\n      var cardStyle = getStyle(style, cfg, group);\n      var shape = group.addShape('rect', {\n        attrs: __assign(__assign({\n          x: 0,\n          y: 0,\n          width: size[0],\n          height: size[1]\n        }, defaultCardStyle), cardStyle),\n        name: 'main-box',\n        draggable: true\n      });\n\n      if (value) {\n        height += paddingArray[0];\n\n        var createRowItems_2 = function (item, contentWidth, startX, index) {\n          if (index === void 0) {\n            index = 0;\n          }\n\n          var iconWidth = 0;\n          var rowHeight = [];\n          var keys = ['icon', 'text', 'value'];\n\n          var getXY = function (type, layoutCfg) {\n            var _a = layoutCfg.fontSize,\n                fontSize = _a === void 0 ? 12 : _a;\n            var x = 0;\n            var y = 0;\n\n            switch (type) {\n              case 'icon':\n                x = startX;\n                y = height;\n                break;\n\n              case 'text':\n                x = startX + (contentWidth + iconWidth) / 2;\n                y = item.value ? paddingArray[0] : (size[1] - fontSize) / 2;\n                break;\n\n              case 'value':\n                x = startX + (contentWidth + iconWidth) / 2;\n                y = item.text ? paddingArray[0] + rowHeight[1] + defaultMargin : (size[1] - fontSize) / 2;\n                break;\n\n              default:\n                break;\n            }\n\n            return {\n              x: x,\n              y: y\n            };\n          };\n\n          keys.forEach(function (key, keyIndex) {\n            var isIcon = key.startsWith('icon');\n            var shapeStyle = getStyle(labelStyle, cfg, group, key);\n\n            if (key === 'icon' && item[key]) {\n              iconWidth = shapeStyle.width || 32;\n            }\n\n            var keyShape = group.addShape(isIcon ? 'image' : 'text', {\n              attrs: __assign(__assign(__assign(__assign({\n                textBaseline: 'top',\n                textAlign: 'center'\n              }, getXY(key, shapeStyle)), {\n                text: item[key],\n                img: item[key]\n              }), isIcon ? defaultIconStyle : defaultLabelStyle), shapeStyle),\n              name: key + \"-\" + index + \"-\" + keyIndex\n            });\n            rowHeight.push(keyShape.getBBox().height);\n          });\n          return rowHeight;\n        };\n\n        var createItems = function (item, index) {\n          var _a;\n\n          if (index === void 0) {\n            index = 0;\n          }\n\n          var itemsHeight = [];\n\n          if (customContent) {\n            itemsHeight.push((_a = customContent(item, group, {\n              startX: paddingArray[3],\n              startY: height,\n              width: contentWidth\n            })) !== null && _a !== void 0 ? _a : 0);\n          } else {\n            itemsHeight.push.apply(itemsHeight, createRowItems_2(item, contentWidth, paddingArray[3], index));\n          }\n\n          height += Math.max.apply(Math, itemsHeight);\n        };\n\n        createItems(value);\n      }\n\n      shape === null || shape === void 0 ? void 0 : shape.attr('height', Math.max(height + paddingArray[2], size[1])); // collapse marker\n\n      if (markerCfg) {\n        var _e = shape.getBBox(),\n            shapeWidth = _e.width,\n            shapeHeight = _e.height;\n\n        var _f = typeof markerCfg === 'function' ? markerCfg(cfg, group) : markerCfg,\n            show = _f.show,\n            _g = _f.position,\n            position = _g === void 0 ? 'right' : _g,\n            collapsed = _f.collapsed,\n            markerStyle = _f.style;\n\n        createMarker({\n          show: show,\n          position: position,\n          collapsed: collapsed,\n          style: markerStyle\n        }, group, [shapeWidth, shapeHeight]);\n        shape.attr('defaultCollapsed', collapsed);\n      }\n\n      return shape;\n    }\n  }, 'single-node');\n};","map":{"version":3,"sources":["E:/sqlindex2/sql/frontend/node_modules/@ant-design/charts/es/graphs/customItems.js"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","G6","defaultMargin","defaultLabelStyle","defaultTitleLabelStyle","defaultTitleRectStyle","defaultCardStyle","defaultIconStyle","getStyle","getCssPadding","createMarker","registerIndicatorCardNode","registerNode","draw","cfg","group","_a","value","nodeCfg","markerCfg","_b","titleCfg","title","itemsCfg","items","_c","label","style","_d","padding","customContent","labelStyle","paddingArray","_e","titleStyle","titleContainerStyle","containerStyle","_f","itemStyle","itemContainerStyle","layout","_g","itemSpacing","sort","_h","itemPadding","itemPaddingArray","_j","size","height","shapeWidth","contentWidth","cardStyle","shape","addShape","attrs","x","y","width","name","draggable","titleTextShape","itemShape","titleShape","textBaseline","text","titleHeight","getBBox","attr","itemContentWidth_1","isArray_1","Array","isArray","createRowItems_1","item","startX","index","rowHeight","valueShapeWidth","keys","forEach","key","keyIndex","isIcon","startsWith","keyShape","img","push","createItems_1","itemsHeight","startY","Math","max","_k","shapeWidth_1","shapeHeight","_l","show","_m","position","collapsed","markerStyle","update","node","getContainer","markerShape","get","find","getModel","symbol","Marker","expand","collapse","registerOrganizationCardNode","createRowItems_2","iconWidth","getXY","type","layoutCfg","fontSize","shapeStyle","textAlign","createItems"],"mappings":"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","sourcesContent":["var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport G6 from '@antv/g6';\r\nimport { defaultMargin, defaultLabelStyle, defaultTitleLabelStyle, defaultTitleRectStyle, defaultCardStyle, defaultIconStyle, } from './constants';\r\nimport { getStyle, getCssPadding } from './utils';\r\nimport { createMarker } from './elements';\r\n// 通用指标卡\r\nexport var registerIndicatorCardNode = function () {\r\n    G6.registerNode('indicator-card', {\r\n        // @ts-ignore\r\n        draw: function (cfg, group) {\r\n            if (cfg === void 0) { cfg = {}; }\r\n            var _a = cfg.value, value = _a === void 0 ? {} : _a, nodeCfg = cfg.nodeCfg, markerCfg = cfg.markerCfg;\r\n            var _b = nodeCfg, titleCfg = _b.title, itemsCfg = _b.items, _c = _b.label, label = _c === void 0 ? {} : _c, style = _b.style, _d = _b.padding, padding = _d === void 0 ? 0 : _d, customContent = _b.customContent;\r\n            var labelStyle = label.style;\r\n            var paddingArray = getCssPadding(padding);\r\n            var _e = titleCfg !== null && titleCfg !== void 0 ? titleCfg : {}, titleStyle = _e.style, titleContainerStyle = _e.containerStyle;\r\n            var _f = itemsCfg !== null && itemsCfg !== void 0 ? itemsCfg : {}, itemStyle = _f.style, itemContainerStyle = _f.containerStyle, layout = _f.layout, _g = _f.itemSpacing, itemSpacing = _g === void 0 ? 4 : _g, sort = _f.sort, _h = _f.padding, itemPadding = _h === void 0 ? [6, 0, 0] : _h;\r\n            var itemPaddingArray = getCssPadding(itemPadding);\r\n            var _j = value, title = _j.title, items = _j.items;\r\n            var size = (cfg === null || cfg === void 0 ? void 0 : cfg.size) || [100, 30];\r\n            if (typeof size === 'number')\r\n                size = [size, size];\r\n            var height = 0; // 统计容器总高度，动态设置\r\n            var shapeWidth = size[0];\r\n            var contentWidth = shapeWidth - paddingArray[1] - paddingArray[3];\r\n            // card box\r\n            var cardStyle = getStyle(style, cfg, group);\r\n            var shape = group.addShape('rect', {\r\n                attrs: __assign(__assign({ x: 0, y: 0, width: size[0], height: size[1] }, defaultCardStyle), cardStyle),\r\n                name: 'main-box',\r\n                draggable: true,\r\n            });\r\n            // node title\r\n            var titleTextShape, itemShape, titleShape;\r\n            if (title) {\r\n                // title rect\r\n                titleShape = group.addShape('rect', {\r\n                    attrs: __assign(__assign({ x: 0, y: 0, width: size[0], height: 0 }, defaultTitleRectStyle), getStyle(titleContainerStyle, cfg, group)),\r\n                    name: 'title-rect',\r\n                    draggable: true,\r\n                });\r\n                titleTextShape = group.addShape('text', {\r\n                    attrs: __assign(__assign({ x: paddingArray[3], y: paddingArray[0], textBaseline: 'top', text: title }, defaultTitleLabelStyle), getStyle(titleStyle, cfg, group)),\r\n                    name: 'title',\r\n                });\r\n                var titleHeight = (titleTextShape\r\n                    ? titleTextShape.getBBox()\r\n                    : { height: size[1] / 2 }).height;\r\n                titleShape === null || titleShape === void 0 ? void 0 : titleShape.attr('height', titleHeight + paddingArray[0] + paddingArray[2]);\r\n                height += titleShape.getBBox().height;\r\n            }\r\n            if (items) {\r\n                itemShape = group.addShape('rect', {\r\n                    attrs: __assign({ x: paddingArray[3], y: height, width: contentWidth, height: 0 }, getStyle(itemContainerStyle, cfg, group)),\r\n                    name: 'item-box',\r\n                });\r\n                height += itemPaddingArray[0];\r\n                var itemContentWidth_1 = contentWidth - itemPaddingArray[1] - itemPaddingArray[3];\r\n                var isArray_1 = Array.isArray(items);\r\n                var createRowItems_1 = function (item, contentWidth, startX, index) {\r\n                    if (index === void 0) { index = 0; }\r\n                    var rowHeight = [];\r\n                    var valueShapeWidth = 0;\r\n                    var keys = sort ? Object.keys(item) : ['text', 'value', 'icon'];\r\n                    keys.forEach(function (key, keyIndex) {\r\n                        var x;\r\n                        var isIcon = key.startsWith('icon');\r\n                        // sort 直接均分，简单化\r\n                        if (sort || layout === 'flex') {\r\n                            x = (keyIndex * contentWidth) / keys.length;\r\n                        }\r\n                        else if (layout === 'follow') {\r\n                            x = valueShapeWidth;\r\n                        }\r\n                        else {\r\n                            // layout === 'bundled'\r\n                            // 直接均分，icon 紧随 value\r\n                            x = key === 'text' ? 0 : contentWidth / 2;\r\n                            x += isIcon ? valueShapeWidth : 0;\r\n                        }\r\n                        var keyShape = group.addShape(isIcon ? 'image' : 'text', {\r\n                            attrs: __assign(__assign({ textBaseline: 'top', x: startX + x, y: height, text: item[key], img: item[key] }, (isIcon ? defaultIconStyle : defaultLabelStyle)), getStyle(itemStyle || labelStyle, cfg, group, key)),\r\n                            name: key + \"-\" + index + \"-\" + keyIndex,\r\n                        });\r\n                        if (key === 'value' || layout === 'follow') {\r\n                            valueShapeWidth += keyShape.getBBox().width;\r\n                            valueShapeWidth += layout === 'follow' ? itemSpacing : 0;\r\n                        }\r\n                        rowHeight.push(keyShape.getBBox().height);\r\n                    });\r\n                    return rowHeight;\r\n                };\r\n                var createItems_1 = function (item, index) {\r\n                    var _a;\r\n                    if (index === void 0) { index = 0; }\r\n                    var itemsHeight = [];\r\n                    if (customContent) {\r\n                        itemsHeight.push((_a = customContent(item, group, {\r\n                            startX: paddingArray[3] + itemPaddingArray[3],\r\n                            startY: height,\r\n                            width: itemContentWidth_1,\r\n                        })) !== null && _a !== void 0 ? _a : 0);\r\n                    }\r\n                    else {\r\n                        itemsHeight.push.apply(itemsHeight, createRowItems_1(item, itemContentWidth_1, paddingArray[3] + itemPaddingArray[3], index));\r\n                    }\r\n                    height += Math.max.apply(Math, itemsHeight);\r\n                    if (isArray_1 && index !== items.length - 1) {\r\n                        height += defaultMargin;\r\n                    }\r\n                };\r\n                if (Array.isArray(items)) {\r\n                    items.forEach(function (item, index) {\r\n                        createItems_1(item, index);\r\n                    });\r\n                }\r\n                else {\r\n                    createItems_1(items);\r\n                }\r\n            }\r\n            itemShape === null || itemShape === void 0 ? void 0 : itemShape.attr('height', Math.max(height - (titleShape === null || titleShape === void 0 ? void 0 : titleShape.getBBox().height) + itemPaddingArray[2], size[1]));\r\n            shape === null || shape === void 0 ? void 0 : shape.attr('height', items\r\n                ? (titleShape === null || titleShape === void 0 ? void 0 : titleShape.getBBox().height) + (itemShape === null || itemShape === void 0 ? void 0 : itemShape.getBBox().height) + paddingArray[2]\r\n                : (titleShape === null || titleShape === void 0 ? void 0 : titleShape.getBBox().height) + (itemShape === null || itemShape === void 0 ? void 0 : itemShape.getBBox().height));\r\n            // collapse marker\r\n            if (markerCfg) {\r\n                var _k = shape.getBBox(), shapeWidth_1 = _k.width, shapeHeight = _k.height;\r\n                var _l = typeof markerCfg === 'function' ? markerCfg(cfg, group) : markerCfg, show = _l.show, _m = _l.position, position = _m === void 0 ? 'right' : _m, collapsed = _l.collapsed, markerStyle = _l.style;\r\n                createMarker({\r\n                    show: show,\r\n                    position: position,\r\n                    collapsed: collapsed,\r\n                    style: markerStyle,\r\n                }, group, [shapeWidth_1, shapeHeight]);\r\n                shape.attr('defaultCollapsed', collapsed);\r\n            }\r\n            return shape;\r\n        },\r\n        /**\r\n         * 更新节点，包含文本\r\n         * @override\r\n         * @param  {Object} cfg 节点的配置项\r\n         * @param  {Node} node 节点\r\n         */\r\n        update: function (cfg, node) {\r\n            var group = node.getContainer();\r\n            var markerShape = group\r\n                .get('children')\r\n                .find(function (item) { return item.get('type') === 'marker'; });\r\n            var collapsed = node.getModel().collapsed;\r\n            markerShape === null || markerShape === void 0 ? void 0 : markerShape.attr({\r\n                symbol: collapsed ? G6.Marker.expand : G6.Marker.collapse,\r\n            });\r\n        },\r\n    }, 'single-node');\r\n};\r\n// 组织架构图\r\nexport var registerOrganizationCardNode = function () {\r\n    G6.registerNode('organization-card', {\r\n        draw: function (cfg, group) {\r\n            if (cfg === void 0) { cfg = {}; }\r\n            var _a = cfg.value, value = _a === void 0 ? {} : _a, nodeCfg = cfg.nodeCfg, markerCfg = cfg.markerCfg;\r\n            var _b = nodeCfg, style = _b.style, _c = _b.padding, padding = _c === void 0 ? 0 : _c, _d = _b.label, label = _d === void 0 ? {} : _d, customContent = _b.customContent;\r\n            var labelStyle = label.style;\r\n            var paddingArray = getCssPadding(padding);\r\n            var size = ((cfg === null || cfg === void 0 ? void 0 : cfg.size) || [100, 30]);\r\n            if (typeof size === 'number')\r\n                size = [size, size];\r\n            var height = 0; // 统计容器总高度，动态设置，宽度不做调整\r\n            var contentWidth = size[0] - paddingArray[1] - paddingArray[3];\r\n            // card box\r\n            var cardStyle = getStyle(style, cfg, group);\r\n            var shape = group.addShape('rect', {\r\n                attrs: __assign(__assign({ x: 0, y: 0, width: size[0], height: size[1] }, defaultCardStyle), cardStyle),\r\n                name: 'main-box',\r\n                draggable: true,\r\n            });\r\n            if (value) {\r\n                height += paddingArray[0];\r\n                var createRowItems_2 = function (item, contentWidth, startX, index) {\r\n                    if (index === void 0) { index = 0; }\r\n                    var iconWidth = 0;\r\n                    var rowHeight = [];\r\n                    var keys = ['icon', 'text', 'value'];\r\n                    var getXY = function (type, layoutCfg) {\r\n                        var _a = layoutCfg.fontSize, fontSize = _a === void 0 ? 12 : _a;\r\n                        var x = 0;\r\n                        var y = 0;\r\n                        switch (type) {\r\n                            case 'icon':\r\n                                x = startX;\r\n                                y = height;\r\n                                break;\r\n                            case 'text':\r\n                                x = startX + (contentWidth + iconWidth) / 2;\r\n                                y = item.value ? paddingArray[0] : (size[1] - fontSize) / 2;\r\n                                break;\r\n                            case 'value':\r\n                                x = startX + (contentWidth + iconWidth) / 2;\r\n                                y = item.text\r\n                                    ? paddingArray[0] + rowHeight[1] + defaultMargin\r\n                                    : (size[1] - fontSize) / 2;\r\n                                break;\r\n                            default:\r\n                                break;\r\n                        }\r\n                        return { x: x, y: y };\r\n                    };\r\n                    keys.forEach(function (key, keyIndex) {\r\n                        var isIcon = key.startsWith('icon');\r\n                        var shapeStyle = getStyle(labelStyle, cfg, group, key);\r\n                        if (key === 'icon' && item[key]) {\r\n                            iconWidth = shapeStyle.width || 32;\r\n                        }\r\n                        var keyShape = group.addShape(isIcon ? 'image' : 'text', {\r\n                            attrs: __assign(__assign(__assign(__assign({ textBaseline: 'top', textAlign: 'center' }, getXY(key, shapeStyle)), { text: item[key], img: item[key] }), (isIcon ? defaultIconStyle : defaultLabelStyle)), shapeStyle),\r\n                            name: key + \"-\" + index + \"-\" + keyIndex,\r\n                        });\r\n                        rowHeight.push(keyShape.getBBox().height);\r\n                    });\r\n                    return rowHeight;\r\n                };\r\n                var createItems = function (item, index) {\r\n                    var _a;\r\n                    if (index === void 0) { index = 0; }\r\n                    var itemsHeight = [];\r\n                    if (customContent) {\r\n                        itemsHeight.push((_a = customContent(item, group, {\r\n                            startX: paddingArray[3],\r\n                            startY: height,\r\n                            width: contentWidth,\r\n                        })) !== null && _a !== void 0 ? _a : 0);\r\n                    }\r\n                    else {\r\n                        itemsHeight.push.apply(itemsHeight, createRowItems_2(item, contentWidth, paddingArray[3], index));\r\n                    }\r\n                    height += Math.max.apply(Math, itemsHeight);\r\n                };\r\n                createItems(value);\r\n            }\r\n            shape === null || shape === void 0 ? void 0 : shape.attr('height', Math.max(height + paddingArray[2], size[1]));\r\n            // collapse marker\r\n            if (markerCfg) {\r\n                var _e = shape.getBBox(), shapeWidth = _e.width, shapeHeight = _e.height;\r\n                var _f = typeof markerCfg === 'function' ? markerCfg(cfg, group) : markerCfg, show = _f.show, _g = _f.position, position = _g === void 0 ? 'right' : _g, collapsed = _f.collapsed, markerStyle = _f.style;\r\n                createMarker({\r\n                    show: show,\r\n                    position: position,\r\n                    collapsed: collapsed,\r\n                    style: markerStyle,\r\n                }, group, [shapeWidth, shapeHeight]);\r\n                shape.attr('defaultCollapsed', collapsed);\r\n            }\r\n            return shape;\r\n        },\r\n    }, 'single-node');\r\n};\r\n"]},"metadata":{},"sourceType":"module"}