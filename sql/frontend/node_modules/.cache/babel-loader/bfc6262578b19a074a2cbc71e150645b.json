{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nimport G6 from '@antv/g6';\nimport { isNumber } from '@antv/util';\nimport { deepClone, isType } from '../util/utils';\nimport { defaultMinimapCfg, defaultNodeSize, defaultCardStyle } from './constants';\nexport var getGraphSize = function (width, height, container) {\n  var CANVAS_WIDTH;\n  var CANVAS_HEIGHT;\n\n  if (container && container.current) {\n    CANVAS_WIDTH = container.current.offsetWidth;\n    CANVAS_HEIGHT = container.current.offsetHeight || 500;\n  }\n\n  if (!width && !CANVAS_WIDTH || !height && !CANVAS_HEIGHT) {\n    console.warn('请为 Graph 指定 width 与 height！否则将使用默认值 500 * 500');\n    return [500, 500];\n  }\n\n  return [width || CANVAS_WIDTH || 500, height || CANVAS_HEIGHT || 500];\n};\n\nvar EventData =\n/** @class */\nfunction () {\n  function EventData(data) {\n    data && this.setData(data);\n  }\n\n  EventData.prototype.getData = function () {\n    return this.data;\n  };\n\n  EventData.prototype.setData = function (data) {\n    this.data = data;\n  };\n\n  return EventData;\n}(); // 展开&折叠事件\n\n\nexport var bindDefaultEvents = function (graph) {\n  var onClick = function (e) {\n    var item = e.item;\n\n    if (e.target.get('name') === 'collapse-icon') {\n      graph.updateItem(item, {\n        collapsed: !item.getModel().collapsed\n      });\n      graph.layout();\n    }\n  };\n\n  graph.on('node:click', function (e) {\n    onClick(e);\n  });\n  graph.on('node:touchstart', function (e) {\n    onClick(e);\n  });\n};\nexport var renderGraph = function (graph, data) {\n  var originData = deepClone(data);\n  graph.data(originData);\n  graph.set('eventData', new EventData(data));\n  graph.render(); // 关闭局部刷新，各种 bug\n\n  graph.get('canvas').set('localRefresh', false);\n};\nexport var processMinimap = function (cfg, graph) {\n  if (cfg === void 0) {\n    cfg = {};\n  }\n\n  if (!graph || graph.destroyed) return;\n\n  if (cfg.show) {\n    var curMminimapCfg = Object.assign(defaultMinimapCfg, cfg);\n    var minimap = new G6.Minimap(__assign({}, curMminimapCfg));\n    graph.addPlugin(minimap);\n    return minimap;\n  }\n\n  return null;\n};\n\nvar getUuid = function () {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n    var r = Math.random() * 16 | 0,\n        v = c == 'x' ? r : r & 0x3 | 0x8;\n    return v.toString(16);\n  });\n}; // 同一页面存在多 graph 时需要指定 graphId\n\n\nexport var getGraphId = function (graph) {\n  if (graph.current) {\n    return graph.current;\n  }\n\n  graph.current = \"Graph-\" + getUuid();\n  return graph.current;\n};\nexport var getMarkerPosition = function (direction, size) {\n  if (direction === void 0) {\n    direction = 'right';\n  }\n\n  var width = size[0],\n      height = size[1];\n  var x = 0;\n  var y = 0;\n\n  switch (direction) {\n    case 'top':\n      x = width / 2;\n      y = 0;\n      break;\n\n    case 'right':\n      x = width;\n      y = height / 2;\n      break;\n\n    case 'bottom':\n      x = width / 2;\n      y = height;\n      break;\n\n    case 'left':\n      x = 0;\n      y = height / 2;\n      break;\n  }\n\n  return {\n    x: x,\n    y: y\n  };\n};\nexport var bindSourceMapCollapseEvents = function (graph) {\n  var onClick = function (e) {\n    var _a;\n\n    var controlData = graph.get('eventData').getData();\n\n    if (e.target.get('name') === 'collapse-icon') {\n      var item = e.item;\n      var collapsed = item.getModel().collapsed;\n\n      if (!isType(collapsed, 'Boolean')) {\n        // @ts-ignore\n        collapsed = (_a = item._cfg.group.getChildren().find(function (item) {\n          return item.get('name') === 'main-box';\n        })) === null || _a === void 0 ? void 0 : _a.attr('defaultCollapsed');\n      } // @ts-ignore\n\n\n      var marker = e.item._cfg.group.getChildren().find(function (item) {\n        return item.cfg.type === 'marker';\n      });\n\n      var _b = (controlData !== null && controlData !== void 0 ? controlData : {}).edges,\n          fullEdges_1 = _b === void 0 ? [] : _b;\n      var nodeId = item.getModel().id;\n      var targetNodeIds_1 = [];\n      var updateItems_1 = [];\n      var updateIds_1 = [];\n\n      var getLinkedId_1 = function (currentId) {\n        fullEdges_1.forEach(function (edge) {\n          var source = edge.source,\n              target = edge.target;\n\n          if (source === currentId) {\n            targetNodeIds_1.push(target);\n            getLinkedId_1(target);\n          }\n        });\n      };\n\n      getLinkedId_1(nodeId);\n\n      if (!collapsed) {\n        // collapse\n        graph.findAll('node', function (node) {\n          return targetNodeIds_1.includes(node.get('id'));\n        }).forEach(function (node) {\n          return graph.hideItem(node);\n        });\n        controlData.nodes.forEach(function (node) {\n          var _a = node.collapsedLevel,\n              collapsedLevel = _a === void 0 ? 0 : _a,\n              id = node.id;\n\n          if (targetNodeIds_1.includes(id)) {\n            node.collapsedLevel = collapsedLevel + 1;\n          }\n        });\n      } else {\n        // expand\n        graph.findAll('node', function (node) {\n          var collapsedLevel = controlData.nodes.find(function (item) {\n            return item.id === node.get('id');\n          }).collapsedLevel;\n          return targetNodeIds_1.includes(node.get('id')) && (!collapsedLevel || collapsedLevel < 2);\n        }).forEach(function (node) {\n          return graph.showItem(node);\n        });\n        controlData.nodes.forEach(function (node) {\n          var _a = node.collapsedLevel,\n              collapsedLevel = _a === void 0 ? 0 : _a,\n              id = node.id;\n\n          if (targetNodeIds_1.includes(id)) {\n            node.collapsedLevel = collapsedLevel - 1;\n          }\n        });\n      }\n\n      fullEdges_1.forEach(function (edge) {\n        var source = edge.source,\n            target = edge.target;\n\n        if (targetNodeIds_1.includes(target)) {\n          updateIds_1.push(source);\n        }\n      });\n      updateIds_1 = Array.from(new Set(updateIds_1));\n      updateIds_1.forEach(function (id) {\n        updateItems_1.push(graph.find('node', function (node) {\n          return node.get('id') === id;\n        }));\n      });\n      updateItems_1.forEach(function (nodeItem) {\n        graph.updateItem(nodeItem, {\n          collapsed: !nodeItem.getModel().collapsed\n        });\n        graph.refreshItem(nodeItem);\n      });\n    }\n  };\n\n  graph.on('node:click', function (e) {\n    onClick(e);\n  });\n  graph.on('node:touchstart', function (e) {\n    onClick(e);\n  });\n};\n/**\r\n * padding | margin 按 CSS 规则转换\r\n */\n\nexport var getCssPadding = function (padding) {\n  if (typeof padding === 'number') {\n    return [padding, padding, padding, padding];\n  }\n\n  var result = [];\n\n  switch (padding.length) {\n    case 1:\n      result = [padding[0], padding[0], padding[0], padding[0]];\n      break;\n\n    case 2:\n      result = [padding[0], padding[1], padding[0], padding[1]];\n      break;\n\n    case 3:\n      result = [padding[0], padding[1], padding[2], padding[1]];\n      break;\n\n    case 4:\n      result = padding;\n      break;\n\n    default:\n      break;\n  }\n\n  return result;\n}; // 默认箭头样式\n\nexport var getArrowCfg = function (arrowCfg, edge) {\n  if (!arrowCfg) {\n    return;\n  }\n\n  if (typeof arrowCfg === 'object' && (arrowCfg === null || arrowCfg === void 0 ? void 0 : arrowCfg.show) === false) {\n    return;\n  }\n\n  var cfg = typeof arrowCfg === 'function' ? arrowCfg(edge) : arrowCfg;\n  var _a = cfg.type,\n      type = _a === void 0 ? 'vee' : _a,\n      _b = cfg.d,\n      d = _b === void 0 ? 0 : _b,\n      _c = cfg.size,\n      size = _c === void 0 ? 10 : _c;\n  return __assign({\n    path: G6.Arrow[type](size, size, d),\n    fill: '#ccc',\n    d: d\n  }, cfg);\n}; // 交互\n\nexport var bindStateEvents = function (graph, cfg) {\n  var _a = cfg !== null && cfg !== void 0 ? cfg : {},\n      _b = _a.nodeCfg,\n      nodeCfg = _b === void 0 ? {} : _b,\n      _c = _a.edgeCfg,\n      edgeCfg = _c === void 0 ? {} : _c;\n\n  var nodeStateStyles = nodeCfg.nodeStateStyles;\n  var edgeStateStyles = edgeCfg.edgeStateStyles;\n  /**\r\n   * 存储交互状态\r\n   * id: [[endActive, endDefalut], [startActive, startDefalut]]\r\n   */\n\n  var statusCache = {};\n\n  var updateArrowFill = function (item, endArrowFill, stratArrowFill) {\n    graph.updateItem(item, {\n      style: {\n        endArrow: !!endArrowFill && {\n          fill: endArrowFill\n        },\n        startArrow: !!stratArrowFill && {\n          fill: stratArrowFill\n        }\n      }\n    });\n  };\n\n  var setState = function (item, name, status) {\n    var _a, _b, _c;\n\n    status ? item.toFront() : item.toBack();\n\n    var _d = (_a = item.getModel().style) !== null && _a !== void 0 ? _a : {},\n        endArrow = _d.endArrow,\n        startArrow = _d.startArrow;\n\n    if (endArrow || startArrow) {\n      if (!statusCache[item.getID()]) {\n        //@ts-ignore\n        var endArrowFill = (endArrow !== null && endArrow !== void 0 ? endArrow : {}).fill; //@ts-ignore\n\n        var startArrowFill = (startArrow !== null && startArrow !== void 0 ? startArrow : {}).fill;\n        var hoverStatus = (_c = (_b = item.getModel().style) === null || _b === void 0 ? void 0 : _b[name]) === null || _c === void 0 ? void 0 : _c.stroke;\n        statusCache[item.getID()] = [[hoverStatus !== null && hoverStatus !== void 0 ? hoverStatus : endArrowFill, endArrowFill], [hoverStatus !== null && hoverStatus !== void 0 ? hoverStatus : startArrowFill, startArrowFill]];\n      }\n\n      var fill = statusCache[item.getID()];\n      updateArrowFill(item, endArrow && fill[0][status ? 0 : 1], startArrow && fill[1][status ? 0 : 1]);\n    }\n\n    graph.setItemState(item, name, status);\n  };\n\n  var getRelationItems = function (currentItem, name, status, type) {\n    var relationItems = type === 'node' ? graph.findAll('edge', function (edge) {\n      return edge.getSource() === currentItem || edge.getTarget() === currentItem;\n    }) : graph.findAll('node', function (node) {\n      return currentItem.getSource().get('id') === node.get('id') || currentItem.getTarget().get('id') === node.get('id');\n    });\n    var highlightItems = [currentItem].concat(relationItems);\n    highlightItems.forEach(function (item) {\n      setState(item, name, status);\n    });\n  };\n\n  if (nodeStateStyles) {\n    graph.on('node:mouseenter', function (evt) {\n      var item = evt.item;\n      getRelationItems(item, 'hover', true, 'node');\n    });\n    graph.on('node:mouseleave', function (evt) {\n      var item = evt.item;\n      getRelationItems(item, 'hover', false, 'node');\n    });\n  }\n\n  if (edgeStateStyles) {\n    graph.on('edge:mouseenter', function (evt) {\n      var item = evt.item;\n      getRelationItems(item, 'hover', true, 'edge');\n    });\n    graph.on('edge:mouseleave', function (evt) {\n      var item = evt.item;\n      getRelationItems(item, 'hover', false, 'edge');\n    });\n  }\n}; // 统一处理 config，支持回调\n\nexport var getStyle = function (source, cfg, item, current) {\n  if (typeof source === 'function') {\n    return source(cfg, item, current);\n  }\n\n  return source || {};\n}; // 统一处理 config，支持回调\n\nexport var getCommonConfig = function (cfg, item, graph) {\n  if (typeof cfg === 'function') {\n    return cfg(item, graph);\n  }\n\n  return cfg;\n};\nexport var getSize = function (size) {\n  if (Array.isArray(size)) {\n    return size;\n  }\n\n  return size ? [size, size] : defaultNodeSize;\n}; // status bar 的默认宽度\n\nvar DefaultStatusBarWidth = 4;\n/**\r\n * card status 对布局的影响，直接加到 padding 中\r\n */\n\nexport var getStatusBBox = function (cfg) {\n  if (!cfg) {\n    return [0, 0, 0, 0];\n  }\n\n  var _a = cfg.size,\n      size = _a === void 0 ? [] : _a,\n      _b = cfg.position,\n      position = _b === void 0 ? 'left' : _b;\n\n  var _c = getSize(size),\n      width = _c[0],\n      height = _c[1];\n\n  var appendPadding = [];\n\n  switch (position) {\n    case 'top':\n      appendPadding.push(height !== null && height !== void 0 ? height : DefaultStatusBarWidth, 0, 0, 0);\n      break;\n\n    case 'right':\n      appendPadding.push(0, width !== null && width !== void 0 ? width : DefaultStatusBarWidth, 0, 0);\n      break;\n\n    case 'bottom':\n      appendPadding.push(0, 0, height !== null && height !== void 0 ? height : DefaultStatusBarWidth, 0);\n      break;\n\n    case 'left':\n      appendPadding.push(0, 0, 0, width !== null && width !== void 0 ? width : DefaultStatusBarWidth);\n      break;\n  }\n\n  return appendPadding;\n};\nexport var getStatusCfg = function (cfg, cardSize) {\n  var _a = cfg !== null && cfg !== void 0 ? cfg : {},\n      _b = _a.size,\n      size = _b === void 0 ? [] : _b,\n      _c = _a.position,\n      position = _c === void 0 ? 'left' : _c;\n\n  var _d = getSize(size),\n      width = _d[0],\n      height = _d[1];\n\n  var cardWidth = cardSize[0],\n      cardHeight = cardSize[1];\n  var x = 0;\n  var y = 0;\n  var w = 0;\n  var h = 0;\n\n  switch (position) {\n    case 'top':\n      x = 0;\n      y = 0;\n      w = width !== null && width !== void 0 ? width : cardWidth;\n      h = height !== null && height !== void 0 ? height : DefaultStatusBarWidth;\n      break;\n\n    case 'left':\n      x = 0;\n      y = 0;\n      w = width !== null && width !== void 0 ? width : DefaultStatusBarWidth;\n      h = height !== null && height !== void 0 ? height : cardHeight;\n      break;\n\n    case 'right':\n      x = cardWidth - (isNumber(width) ? width : DefaultStatusBarWidth);\n      y = 0;\n      w = width !== null && width !== void 0 ? width : DefaultStatusBarWidth;\n      h = height !== null && height !== void 0 ? height : cardHeight;\n      break;\n\n    case 'bottom':\n      x = 0;\n      y = cardHeight - (isNumber(height) ? height : DefaultStatusBarWidth);\n      w = width !== null && width !== void 0 ? width : cardWidth;\n      h = height !== null && height !== void 0 ? height : DefaultStatusBarWidth;\n      break;\n  }\n\n  return {\n    x: x,\n    y: y,\n    width: w,\n    height: h\n  };\n};\nexport var createMarker = function (cfg, group, size) {\n  var show = cfg.show,\n      position = cfg.position,\n      collapsed = cfg.collapsed,\n      style = cfg.style;\n\n  if (show) {\n    group.addShape('marker', {\n      attrs: __assign(__assign(__assign({}, getMarkerPosition(position, size)), {\n        r: 6,\n        cursor: 'pointer',\n        symbol: collapsed ? G6.Marker.expand : G6.Marker.collapse,\n        stroke: defaultCardStyle.stroke,\n        lineWidth: 1,\n        fill: '#fff'\n      }), style),\n      defaultCollapsed: false,\n      name: 'collapse-icon'\n    });\n  }\n};","map":{"version":3,"sources":["D:/LECONS-KHTN/CSDL Avancé/TH/sqlindex2/sql/frontend/node_modules/@ant-design/charts/es/graphs/utils.js"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","G6","isNumber","deepClone","isType","defaultMinimapCfg","defaultNodeSize","defaultCardStyle","getGraphSize","width","height","container","CANVAS_WIDTH","CANVAS_HEIGHT","current","offsetWidth","offsetHeight","console","warn","EventData","data","setData","getData","bindDefaultEvents","graph","onClick","e","item","target","get","updateItem","collapsed","getModel","layout","on","renderGraph","originData","set","render","processMinimap","cfg","destroyed","show","curMminimapCfg","minimap","Minimap","addPlugin","getUuid","replace","c","r","Math","random","v","toString","getGraphId","getMarkerPosition","direction","size","x","y","bindSourceMapCollapseEvents","_a","controlData","_cfg","group","getChildren","find","attr","marker","type","_b","edges","fullEdges_1","nodeId","id","targetNodeIds_1","updateItems_1","updateIds_1","getLinkedId_1","currentId","forEach","edge","source","push","findAll","node","includes","hideItem","nodes","collapsedLevel","showItem","Array","from","Set","nodeItem","refreshItem","getCssPadding","padding","result","getArrowCfg","arrowCfg","d","_c","path","Arrow","fill","bindStateEvents","nodeCfg","edgeCfg","nodeStateStyles","edgeStateStyles","statusCache","updateArrowFill","endArrowFill","stratArrowFill","style","endArrow","startArrow","setState","name","status","toFront","toBack","_d","getID","startArrowFill","hoverStatus","stroke","setItemState","getRelationItems","currentItem","relationItems","getSource","getTarget","highlightItems","concat","evt","getStyle","getCommonConfig","getSize","isArray","DefaultStatusBarWidth","getStatusBBox","position","appendPadding","getStatusCfg","cardSize","cardWidth","cardHeight","w","h","createMarker","addShape","attrs","cursor","symbol","Marker","expand","collapse","lineWidth","defaultCollapsed"],"mappings":"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","sourcesContent":["var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport G6 from '@antv/g6';\r\nimport { isNumber } from '@antv/util';\r\nimport { deepClone, isType } from '../util/utils';\r\nimport { defaultMinimapCfg, defaultNodeSize, defaultCardStyle } from './constants';\r\nexport var getGraphSize = function (width, height, container) {\r\n    var CANVAS_WIDTH;\r\n    var CANVAS_HEIGHT;\r\n    if (container && container.current) {\r\n        CANVAS_WIDTH = container.current.offsetWidth;\r\n        CANVAS_HEIGHT = container.current.offsetHeight || 500;\r\n    }\r\n    if ((!width && !CANVAS_WIDTH) || (!height && !CANVAS_HEIGHT)) {\r\n        console.warn('请为 Graph 指定 width 与 height！否则将使用默认值 500 * 500');\r\n        return [500, 500];\r\n    }\r\n    return [width || CANVAS_WIDTH || 500, height || CANVAS_HEIGHT || 500];\r\n};\r\nvar EventData = /** @class */ (function () {\r\n    function EventData(data) {\r\n        data && this.setData(data);\r\n    }\r\n    EventData.prototype.getData = function () {\r\n        return this.data;\r\n    };\r\n    EventData.prototype.setData = function (data) {\r\n        this.data = data;\r\n    };\r\n    return EventData;\r\n}());\r\n// 展开&折叠事件\r\nexport var bindDefaultEvents = function (graph) {\r\n    var onClick = function (e) {\r\n        var item = e.item;\r\n        if (e.target.get('name') === 'collapse-icon') {\r\n            graph.updateItem(item, {\r\n                collapsed: !item.getModel().collapsed,\r\n            });\r\n            graph.layout();\r\n        }\r\n    };\r\n    graph.on('node:click', function (e) {\r\n        onClick(e);\r\n    });\r\n    graph.on('node:touchstart', function (e) {\r\n        onClick(e);\r\n    });\r\n};\r\nexport var renderGraph = function (graph, data) {\r\n    var originData = deepClone(data);\r\n    graph.data(originData);\r\n    graph.set('eventData', new EventData(data));\r\n    graph.render();\r\n    // 关闭局部刷新，各种 bug\r\n    graph.get('canvas').set('localRefresh', false);\r\n};\r\nexport var processMinimap = function (cfg, graph) {\r\n    if (cfg === void 0) { cfg = {}; }\r\n    if (!graph || graph.destroyed)\r\n        return;\r\n    if (cfg.show) {\r\n        var curMminimapCfg = Object.assign(defaultMinimapCfg, cfg);\r\n        var minimap = new G6.Minimap(__assign({}, curMminimapCfg));\r\n        graph.addPlugin(minimap);\r\n        return minimap;\r\n    }\r\n    return null;\r\n};\r\nvar getUuid = function () {\r\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\r\n        var r = (Math.random() * 16) | 0, v = c == 'x' ? r : (r & 0x3) | 0x8;\r\n        return v.toString(16);\r\n    });\r\n};\r\n// 同一页面存在多 graph 时需要指定 graphId\r\nexport var getGraphId = function (graph) {\r\n    if (graph.current) {\r\n        return graph.current;\r\n    }\r\n    graph.current = \"Graph-\" + getUuid();\r\n    return graph.current;\r\n};\r\nexport var getMarkerPosition = function (direction, size) {\r\n    if (direction === void 0) { direction = 'right'; }\r\n    var width = size[0], height = size[1];\r\n    var x = 0;\r\n    var y = 0;\r\n    switch (direction) {\r\n        case 'top':\r\n            x = width / 2;\r\n            y = 0;\r\n            break;\r\n        case 'right':\r\n            x = width;\r\n            y = height / 2;\r\n            break;\r\n        case 'bottom':\r\n            x = width / 2;\r\n            y = height;\r\n            break;\r\n        case 'left':\r\n            x = 0;\r\n            y = height / 2;\r\n            break;\r\n    }\r\n    return { x: x, y: y };\r\n};\r\nexport var bindSourceMapCollapseEvents = function (graph) {\r\n    var onClick = function (e) {\r\n        var _a;\r\n        var controlData = graph.get('eventData').getData();\r\n        if (e.target.get('name') === 'collapse-icon') {\r\n            var item = e.item;\r\n            var collapsed = item.getModel().collapsed;\r\n            if (!isType(collapsed, 'Boolean')) {\r\n                // @ts-ignore\r\n                collapsed = (_a = item._cfg.group\r\n                    .getChildren()\r\n                    .find(function (item) { return item.get('name') === 'main-box'; })) === null || _a === void 0 ? void 0 : _a.attr('defaultCollapsed');\r\n            }\r\n            // @ts-ignore\r\n            var marker = e.item._cfg.group.getChildren().find(function (item) { return item.cfg.type === 'marker'; });\r\n            var _b = (controlData !== null && controlData !== void 0 ? controlData : {}).edges, fullEdges_1 = _b === void 0 ? [] : _b;\r\n            var nodeId = item.getModel().id;\r\n            var targetNodeIds_1 = [];\r\n            var updateItems_1 = [];\r\n            var updateIds_1 = [];\r\n            var getLinkedId_1 = function (currentId) {\r\n                fullEdges_1.forEach(function (edge) {\r\n                    var source = edge.source, target = edge.target;\r\n                    if (source === currentId) {\r\n                        targetNodeIds_1.push(target);\r\n                        getLinkedId_1(target);\r\n                    }\r\n                });\r\n            };\r\n            getLinkedId_1(nodeId);\r\n            if (!collapsed) {\r\n                // collapse\r\n                graph\r\n                    .findAll('node', function (node) { return targetNodeIds_1.includes(node.get('id')); })\r\n                    .forEach(function (node) { return graph.hideItem(node); });\r\n                controlData.nodes.forEach(function (node) {\r\n                    var _a = node.collapsedLevel, collapsedLevel = _a === void 0 ? 0 : _a, id = node.id;\r\n                    if (targetNodeIds_1.includes(id)) {\r\n                        node.collapsedLevel = collapsedLevel + 1;\r\n                    }\r\n                });\r\n            }\r\n            else {\r\n                // expand\r\n                graph\r\n                    .findAll('node', function (node) {\r\n                    var collapsedLevel = controlData.nodes.find(function (item) { return item.id === node.get('id'); }).collapsedLevel;\r\n                    return (targetNodeIds_1.includes(node.get('id')) && (!collapsedLevel || collapsedLevel < 2));\r\n                })\r\n                    .forEach(function (node) { return graph.showItem(node); });\r\n                controlData.nodes.forEach(function (node) {\r\n                    var _a = node.collapsedLevel, collapsedLevel = _a === void 0 ? 0 : _a, id = node.id;\r\n                    if (targetNodeIds_1.includes(id)) {\r\n                        node.collapsedLevel = collapsedLevel - 1;\r\n                    }\r\n                });\r\n            }\r\n            fullEdges_1.forEach(function (edge) {\r\n                var source = edge.source, target = edge.target;\r\n                if (targetNodeIds_1.includes(target)) {\r\n                    updateIds_1.push(source);\r\n                }\r\n            });\r\n            updateIds_1 = Array.from(new Set(updateIds_1));\r\n            updateIds_1.forEach(function (id) {\r\n                updateItems_1.push(graph.find('node', function (node) { return node.get('id') === id; }));\r\n            });\r\n            updateItems_1.forEach(function (nodeItem) {\r\n                graph.updateItem(nodeItem, {\r\n                    collapsed: !nodeItem.getModel().collapsed,\r\n                });\r\n                graph.refreshItem(nodeItem);\r\n            });\r\n        }\r\n    };\r\n    graph.on('node:click', function (e) {\r\n        onClick(e);\r\n    });\r\n    graph.on('node:touchstart', function (e) {\r\n        onClick(e);\r\n    });\r\n};\r\n/**\r\n * padding | margin 按 CSS 规则转换\r\n */\r\nexport var getCssPadding = function (padding) {\r\n    if (typeof padding === 'number') {\r\n        return [padding, padding, padding, padding];\r\n    }\r\n    var result = [];\r\n    switch (padding.length) {\r\n        case 1:\r\n            result = [padding[0], padding[0], padding[0], padding[0]];\r\n            break;\r\n        case 2:\r\n            result = [padding[0], padding[1], padding[0], padding[1]];\r\n            break;\r\n        case 3:\r\n            result = [padding[0], padding[1], padding[2], padding[1]];\r\n            break;\r\n        case 4:\r\n            result = padding;\r\n            break;\r\n        default:\r\n            break;\r\n    }\r\n    return result;\r\n};\r\n// 默认箭头样式\r\nexport var getArrowCfg = function (arrowCfg, edge) {\r\n    if (!arrowCfg) {\r\n        return;\r\n    }\r\n    if (typeof arrowCfg === 'object' && (arrowCfg === null || arrowCfg === void 0 ? void 0 : arrowCfg.show) === false) {\r\n        return;\r\n    }\r\n    var cfg = typeof arrowCfg === 'function' ? arrowCfg(edge) : arrowCfg;\r\n    var _a = cfg.type, type = _a === void 0 ? 'vee' : _a, _b = cfg.d, d = _b === void 0 ? 0 : _b, _c = cfg.size, size = _c === void 0 ? 10 : _c;\r\n    return __assign({ path: G6.Arrow[type](size, size, d), fill: '#ccc', d: d }, cfg);\r\n};\r\n// 交互\r\nexport var bindStateEvents = function (graph, cfg) {\r\n    var _a = cfg !== null && cfg !== void 0 ? cfg : {}, _b = _a.nodeCfg, nodeCfg = _b === void 0 ? {} : _b, _c = _a.edgeCfg, edgeCfg = _c === void 0 ? {} : _c;\r\n    var nodeStateStyles = nodeCfg.nodeStateStyles;\r\n    var edgeStateStyles = edgeCfg.edgeStateStyles;\r\n    /**\r\n     * 存储交互状态\r\n     * id: [[endActive, endDefalut], [startActive, startDefalut]]\r\n     */\r\n    var statusCache = {};\r\n    var updateArrowFill = function (item, endArrowFill, stratArrowFill) {\r\n        graph.updateItem(item, {\r\n            style: {\r\n                endArrow: !!endArrowFill && {\r\n                    fill: endArrowFill,\r\n                },\r\n                startArrow: !!stratArrowFill && {\r\n                    fill: stratArrowFill,\r\n                },\r\n            },\r\n        });\r\n    };\r\n    var setState = function (item, name, status) {\r\n        var _a, _b, _c;\r\n        status ? item.toFront() : item.toBack();\r\n        var _d = (_a = item.getModel().style) !== null && _a !== void 0 ? _a : {}, endArrow = _d.endArrow, startArrow = _d.startArrow;\r\n        if (endArrow || startArrow) {\r\n            if (!statusCache[item.getID()]) {\r\n                //@ts-ignore\r\n                var endArrowFill = (endArrow !== null && endArrow !== void 0 ? endArrow : {}).fill;\r\n                //@ts-ignore\r\n                var startArrowFill = (startArrow !== null && startArrow !== void 0 ? startArrow : {}).fill;\r\n                var hoverStatus = (_c = (_b = item.getModel().style) === null || _b === void 0 ? void 0 : _b[name]) === null || _c === void 0 ? void 0 : _c.stroke;\r\n                statusCache[item.getID()] = [\r\n                    [hoverStatus !== null && hoverStatus !== void 0 ? hoverStatus : endArrowFill, endArrowFill],\r\n                    [hoverStatus !== null && hoverStatus !== void 0 ? hoverStatus : startArrowFill, startArrowFill],\r\n                ];\r\n            }\r\n            var fill = statusCache[item.getID()];\r\n            updateArrowFill(item, endArrow && fill[0][status ? 0 : 1], startArrow && fill[1][status ? 0 : 1]);\r\n        }\r\n        graph.setItemState(item, name, status);\r\n    };\r\n    var getRelationItems = function (currentItem, name, status, type) {\r\n        var relationItems = type === 'node'\r\n            ? graph.findAll('edge', function (edge) { return edge.getSource() === currentItem || edge.getTarget() === currentItem; })\r\n            : graph.findAll('node', function (node) {\r\n                return currentItem.getSource().get('id') === node.get('id') ||\r\n                    currentItem.getTarget().get('id') === node.get('id');\r\n            });\r\n        var highlightItems = [currentItem].concat(relationItems);\r\n        highlightItems.forEach(function (item) {\r\n            setState(item, name, status);\r\n        });\r\n    };\r\n    if (nodeStateStyles) {\r\n        graph.on('node:mouseenter', function (evt) {\r\n            var item = evt.item;\r\n            getRelationItems(item, 'hover', true, 'node');\r\n        });\r\n        graph.on('node:mouseleave', function (evt) {\r\n            var item = evt.item;\r\n            getRelationItems(item, 'hover', false, 'node');\r\n        });\r\n    }\r\n    if (edgeStateStyles) {\r\n        graph.on('edge:mouseenter', function (evt) {\r\n            var item = evt.item;\r\n            getRelationItems(item, 'hover', true, 'edge');\r\n        });\r\n        graph.on('edge:mouseleave', function (evt) {\r\n            var item = evt.item;\r\n            getRelationItems(item, 'hover', false, 'edge');\r\n        });\r\n    }\r\n};\r\n// 统一处理 config，支持回调\r\nexport var getStyle = function (source, cfg, item, current) {\r\n    if (typeof source === 'function') {\r\n        return source(cfg, item, current);\r\n    }\r\n    return source || {};\r\n};\r\n// 统一处理 config，支持回调\r\nexport var getCommonConfig = function (cfg, item, graph) {\r\n    if (typeof cfg === 'function') {\r\n        return cfg(item, graph);\r\n    }\r\n    return cfg;\r\n};\r\nexport var getSize = function (size) {\r\n    if (Array.isArray(size)) {\r\n        return size;\r\n    }\r\n    return size ? [size, size] : defaultNodeSize;\r\n};\r\n// status bar 的默认宽度\r\nvar DefaultStatusBarWidth = 4;\r\n/**\r\n * card status 对布局的影响，直接加到 padding 中\r\n */\r\nexport var getStatusBBox = function (cfg) {\r\n    if (!cfg) {\r\n        return [0, 0, 0, 0];\r\n    }\r\n    var _a = cfg.size, size = _a === void 0 ? [] : _a, _b = cfg.position, position = _b === void 0 ? 'left' : _b;\r\n    var _c = getSize(size), width = _c[0], height = _c[1];\r\n    var appendPadding = [];\r\n    switch (position) {\r\n        case 'top':\r\n            appendPadding.push(height !== null && height !== void 0 ? height : DefaultStatusBarWidth, 0, 0, 0);\r\n            break;\r\n        case 'right':\r\n            appendPadding.push(0, width !== null && width !== void 0 ? width : DefaultStatusBarWidth, 0, 0);\r\n            break;\r\n        case 'bottom':\r\n            appendPadding.push(0, 0, height !== null && height !== void 0 ? height : DefaultStatusBarWidth, 0);\r\n            break;\r\n        case 'left':\r\n            appendPadding.push(0, 0, 0, width !== null && width !== void 0 ? width : DefaultStatusBarWidth);\r\n            break;\r\n    }\r\n    return appendPadding;\r\n};\r\nexport var getStatusCfg = function (cfg, cardSize) {\r\n    var _a = cfg !== null && cfg !== void 0 ? cfg : {}, _b = _a.size, size = _b === void 0 ? [] : _b, _c = _a.position, position = _c === void 0 ? 'left' : _c;\r\n    var _d = getSize(size), width = _d[0], height = _d[1];\r\n    var cardWidth = cardSize[0], cardHeight = cardSize[1];\r\n    var x = 0;\r\n    var y = 0;\r\n    var w = 0;\r\n    var h = 0;\r\n    switch (position) {\r\n        case 'top':\r\n            x = 0;\r\n            y = 0;\r\n            w = width !== null && width !== void 0 ? width : cardWidth;\r\n            h = height !== null && height !== void 0 ? height : DefaultStatusBarWidth;\r\n            break;\r\n        case 'left':\r\n            x = 0;\r\n            y = 0;\r\n            w = width !== null && width !== void 0 ? width : DefaultStatusBarWidth;\r\n            h = height !== null && height !== void 0 ? height : cardHeight;\r\n            break;\r\n        case 'right':\r\n            x = cardWidth - (isNumber(width) ? width : DefaultStatusBarWidth);\r\n            y = 0;\r\n            w = width !== null && width !== void 0 ? width : DefaultStatusBarWidth;\r\n            h = height !== null && height !== void 0 ? height : cardHeight;\r\n            break;\r\n        case 'bottom':\r\n            x = 0;\r\n            y = cardHeight - (isNumber(height) ? height : DefaultStatusBarWidth);\r\n            w = width !== null && width !== void 0 ? width : cardWidth;\r\n            h = height !== null && height !== void 0 ? height : DefaultStatusBarWidth;\r\n            break;\r\n    }\r\n    return {\r\n        x: x,\r\n        y: y,\r\n        width: w,\r\n        height: h,\r\n    };\r\n};\r\nexport var createMarker = function (cfg, group, size) {\r\n    var show = cfg.show, position = cfg.position, collapsed = cfg.collapsed, style = cfg.style;\r\n    if (show) {\r\n        group.addShape('marker', {\r\n            attrs: __assign(__assign(__assign({}, getMarkerPosition(position, size)), { r: 6, cursor: 'pointer', symbol: collapsed ? G6.Marker.expand : G6.Marker.collapse, stroke: defaultCardStyle.stroke, lineWidth: 1, fill: '#fff' }), style),\r\n            defaultCollapsed: false,\r\n            name: 'collapse-icon',\r\n        });\r\n    }\r\n};\r\n"]},"metadata":{},"sourceType":"module"}