{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nimport G6 from '@antv/g6';\nimport { defaultMargin, defaultLabelStyle, defaultCardStyle } from '../constants';\nimport { getStyle, getCssPadding, getStatusBBox, getStatusCfg, createMarker } from '../utils'; // 通用指标卡\n\nexport var registerIndicatorCardNode = function () {\n  var defaultTitleLabelStyle = {\n    fill: '#fff',\n    fontSize: 12\n  };\n  var defaultTitleRectStyle = {\n    fill: '#40a9ff',\n    radius: [2, 2, 0, 0]\n  };\n  var defaultIconStyle = {\n    width: 12,\n    height: 12\n  };\n  G6.registerNode('indicator-card', {\n    // @ts-ignore\n    draw: function (cfg, group) {\n      if (cfg === void 0) {\n        cfg = {};\n      }\n\n      var _a = cfg.value,\n          value = _a === void 0 ? {} : _a,\n          nodeCfg = cfg.nodeCfg,\n          markerCfg = cfg.markerCfg;\n      var _b = nodeCfg,\n          titleCfg = _b.title,\n          itemsCfg = _b.items,\n          _c = _b.label,\n          label = _c === void 0 ? {} : _c,\n          style = _b.style,\n          _d = _b.padding,\n          padding = _d === void 0 ? 0 : _d,\n          badge = _b.badge,\n          customContent = _b.customContent;\n      var appendPadding = getStatusBBox(badge);\n      var labelStyle = label.style;\n      var cardPadding = getCssPadding(padding);\n      var paddingArray = cardPadding.map(function (item, index) {\n        return item + appendPadding[index];\n      });\n\n      var _e = titleCfg !== null && titleCfg !== void 0 ? titleCfg : {},\n          titleStyle = _e.style,\n          titleContainerStyle = _e.containerStyle;\n\n      var _f = itemsCfg !== null && itemsCfg !== void 0 ? itemsCfg : {},\n          itemStyle = _f.style,\n          itemContainerStyle = _f.containerStyle,\n          layout = _f.layout,\n          _g = _f.itemSpacing,\n          itemSpacing = _g === void 0 ? 4 : _g,\n          sort = _f.sort,\n          _h = _f.padding,\n          itemPadding = _h === void 0 ? [6, 0, 0] : _h;\n\n      var itemPaddingArray = getCssPadding(itemPadding);\n      var _j = value,\n          title = _j.title,\n          items = _j.items;\n      var size = (cfg === null || cfg === void 0 ? void 0 : cfg.size) || [100, 30];\n      if (typeof size === 'number') size = [size, size];\n      var height = 0; // 统计容器总高度，动态设置\n\n      var shapeWidth = size[0];\n      var contentWidth = shapeWidth - paddingArray[1] - paddingArray[3]; // card box\n\n      var cardStyle = getStyle(style, cfg, group);\n      var shape = group.addShape('rect', {\n        attrs: __assign(__assign({\n          x: 0,\n          y: 0,\n          width: size[0],\n          height: size[1]\n        }, defaultCardStyle), cardStyle),\n        name: 'main-box',\n        draggable: true\n      }); // node title\n\n      var titleTextShape, itemShape, titleShape;\n\n      if (title) {\n        // title rect\n        titleShape = group.addShape('rect', {\n          attrs: __assign(__assign({\n            x: 0,\n            y: 0,\n            width: size[0],\n            height: 0\n          }, defaultTitleRectStyle), getStyle(titleContainerStyle, cfg, group)),\n          name: 'title-rect',\n          draggable: true\n        });\n        titleTextShape = group.addShape('text', {\n          attrs: __assign(__assign({\n            x: paddingArray[3],\n            y: paddingArray[0],\n            textBaseline: 'top',\n            text: title\n          }, defaultTitleLabelStyle), getStyle(titleStyle, cfg, group)),\n          name: 'title'\n        });\n        var titleHeight = (titleTextShape ? titleTextShape.getBBox() : {\n          height: size[1] / 2\n        }).height;\n        titleShape === null || titleShape === void 0 ? void 0 : titleShape.attr('height', titleHeight + paddingArray[0] + paddingArray[2]);\n        height += titleShape.getBBox().height;\n      }\n\n      if (items) {\n        itemShape = group.addShape('rect', {\n          attrs: __assign({\n            x: paddingArray[3],\n            y: height,\n            width: contentWidth,\n            height: 0\n          }, getStyle(itemContainerStyle, cfg, group)),\n          name: 'item-box'\n        });\n        height += itemPaddingArray[0];\n        var itemContentWidth_1 = contentWidth - itemPaddingArray[1] - itemPaddingArray[3];\n        var isArray_1 = Array.isArray(items);\n\n        var createRowItems_1 = function (item, contentWidth, startX, index) {\n          if (index === void 0) {\n            index = 0;\n          }\n\n          var rowHeight = [];\n          var valueShapeWidth = 0;\n          var keys = sort ? Object.keys(item) : ['text', 'value', 'icon'];\n          keys.forEach(function (key, keyIndex) {\n            var x;\n            var isIcon = key.startsWith('icon'); // sort 直接均分，简单化\n\n            if (sort || layout === 'flex') {\n              x = keyIndex * contentWidth / keys.length;\n            } else if (layout === 'follow') {\n              x = valueShapeWidth;\n            } else {\n              // layout === 'bundled'\n              // 直接均分，icon 紧随 value\n              x = key === 'text' ? 0 : contentWidth / 2;\n              x += isIcon ? valueShapeWidth : 0;\n            }\n\n            var keyShape = group.addShape(isIcon ? 'image' : 'text', {\n              attrs: __assign(__assign({\n                textBaseline: 'top',\n                x: startX + x,\n                y: height,\n                text: item[key],\n                img: item[key]\n              }, isIcon ? defaultIconStyle : defaultLabelStyle), getStyle(itemStyle || labelStyle, cfg, group, key)),\n              name: key + \"-\" + index + \"-\" + keyIndex\n            });\n\n            if (key === 'value' || layout === 'follow') {\n              valueShapeWidth += keyShape.getBBox().width;\n              valueShapeWidth += layout === 'follow' ? itemSpacing : 0;\n            }\n\n            rowHeight.push(keyShape.getBBox().height);\n          });\n          return rowHeight;\n        };\n\n        var createItems_1 = function (item, index) {\n          var _a;\n\n          if (index === void 0) {\n            index = 0;\n          }\n\n          var itemsHeight = [];\n\n          if (customContent) {\n            itemsHeight.push((_a = customContent(item, group, {\n              startX: paddingArray[3] + itemPaddingArray[3],\n              startY: height,\n              width: itemContentWidth_1\n            })) !== null && _a !== void 0 ? _a : 0);\n          } else {\n            itemsHeight.push.apply(itemsHeight, createRowItems_1(item, itemContentWidth_1, paddingArray[3] + itemPaddingArray[3], index));\n          }\n\n          height += Math.max.apply(Math, itemsHeight);\n\n          if (isArray_1 && index !== items.length - 1) {\n            height += defaultMargin;\n          }\n        };\n\n        if (Array.isArray(items)) {\n          items.forEach(function (item, index) {\n            createItems_1(item, index);\n          });\n        } else {\n          createItems_1(items);\n        }\n      }\n\n      itemShape === null || itemShape === void 0 ? void 0 : itemShape.attr('height', Math.max(height - (titleShape === null || titleShape === void 0 ? void 0 : titleShape.getBBox().height) + itemPaddingArray[2], size[1]));\n      var shapeHeight = items ? (titleShape === null || titleShape === void 0 ? void 0 : titleShape.getBBox().height) + (itemShape === null || itemShape === void 0 ? void 0 : itemShape.getBBox().height) + paddingArray[2] : (titleShape === null || titleShape === void 0 ? void 0 : titleShape.getBBox().height) + (itemShape === null || itemShape === void 0 ? void 0 : itemShape.getBBox().height);\n      shape === null || shape === void 0 ? void 0 : shape.attr('height', shapeHeight);\n\n      if (badge) {\n        var statusConfig = getStatusCfg(badge, [size[0], shapeHeight]);\n        group.addShape('rect', {\n          attrs: __assign(__assign({\n            fill: '#40a9ff'\n          }, statusConfig), getStyle(badge.style, cfg, group)),\n          name: 'status-rect'\n        });\n      } // collapse marker\n\n\n      if (markerCfg) {\n        var _k = shape.getBBox(),\n            shapeWidth_1 = _k.width,\n            shapeHeight_1 = _k.height;\n\n        var _l = typeof markerCfg === 'function' ? markerCfg(cfg, group) : markerCfg,\n            show = _l.show,\n            _m = _l.position,\n            position = _m === void 0 ? 'right' : _m,\n            collapsed = _l.collapsed,\n            markerStyle = _l.style;\n\n        createMarker({\n          show: show,\n          position: position,\n          collapsed: collapsed,\n          style: markerStyle\n        }, group, [shapeWidth_1, shapeHeight_1]);\n        shape.attr('defaultCollapsed', collapsed);\n      }\n\n      return shape;\n    },\n\n    /**\r\n     * 更新节点，包含文本\r\n     * @override\r\n     * @param  {Object} cfg 节点的配置项\r\n     * @param  {Node} node 节点\r\n     */\n    update: function (cfg, node) {\n      var group = node.getContainer();\n      var markerShape = group.get('children').find(function (item) {\n        return item.get('type') === 'marker';\n      });\n      var collapsed = node.getModel().collapsed;\n      markerShape === null || markerShape === void 0 ? void 0 : markerShape.attr({\n        symbol: collapsed ? G6.Marker.expand : G6.Marker.collapse\n      });\n    }\n  }, 'single-node');\n};","map":{"version":3,"sources":["D:/Code/sqlindex2/sql/frontend/node_modules/@ant-design/charts/es/graphs/flowAnalysisGraph/customItem.js"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","G6","defaultMargin","defaultLabelStyle","defaultCardStyle","getStyle","getCssPadding","getStatusBBox","getStatusCfg","createMarker","registerIndicatorCardNode","defaultTitleLabelStyle","fill","fontSize","defaultTitleRectStyle","radius","defaultIconStyle","width","height","registerNode","draw","cfg","group","_a","value","nodeCfg","markerCfg","_b","titleCfg","title","itemsCfg","items","_c","label","style","_d","padding","badge","customContent","appendPadding","labelStyle","cardPadding","paddingArray","map","item","index","_e","titleStyle","titleContainerStyle","containerStyle","_f","itemStyle","itemContainerStyle","layout","_g","itemSpacing","sort","_h","itemPadding","itemPaddingArray","_j","size","shapeWidth","contentWidth","cardStyle","shape","addShape","attrs","x","y","name","draggable","titleTextShape","itemShape","titleShape","textBaseline","text","titleHeight","getBBox","attr","itemContentWidth_1","isArray_1","Array","isArray","createRowItems_1","startX","rowHeight","valueShapeWidth","keys","forEach","key","keyIndex","isIcon","startsWith","keyShape","img","push","createItems_1","itemsHeight","startY","Math","max","shapeHeight","statusConfig","_k","shapeWidth_1","shapeHeight_1","_l","show","_m","position","collapsed","markerStyle","update","node","getContainer","markerShape","get","find","getModel","symbol","Marker","expand","collapse"],"mappings":"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","sourcesContent":["var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport G6 from '@antv/g6';\r\nimport { defaultMargin, defaultLabelStyle, defaultCardStyle } from '../constants';\r\nimport { getStyle, getCssPadding, getStatusBBox, getStatusCfg, createMarker } from '../utils';\r\n// 通用指标卡\r\nexport var registerIndicatorCardNode = function () {\r\n    var defaultTitleLabelStyle = {\r\n        fill: '#fff',\r\n        fontSize: 12,\r\n    };\r\n    var defaultTitleRectStyle = {\r\n        fill: '#40a9ff',\r\n        radius: [2, 2, 0, 0],\r\n    };\r\n    var defaultIconStyle = {\r\n        width: 12,\r\n        height: 12,\r\n    };\r\n    G6.registerNode('indicator-card', {\r\n        // @ts-ignore\r\n        draw: function (cfg, group) {\r\n            if (cfg === void 0) { cfg = {}; }\r\n            var _a = cfg.value, value = _a === void 0 ? {} : _a, nodeCfg = cfg.nodeCfg, markerCfg = cfg.markerCfg;\r\n            var _b = nodeCfg, titleCfg = _b.title, itemsCfg = _b.items, _c = _b.label, label = _c === void 0 ? {} : _c, style = _b.style, _d = _b.padding, padding = _d === void 0 ? 0 : _d, badge = _b.badge, customContent = _b.customContent;\r\n            var appendPadding = getStatusBBox(badge);\r\n            var labelStyle = label.style;\r\n            var cardPadding = getCssPadding(padding);\r\n            var paddingArray = cardPadding.map(function (item, index) { return item + appendPadding[index]; });\r\n            var _e = titleCfg !== null && titleCfg !== void 0 ? titleCfg : {}, titleStyle = _e.style, titleContainerStyle = _e.containerStyle;\r\n            var _f = itemsCfg !== null && itemsCfg !== void 0 ? itemsCfg : {}, itemStyle = _f.style, itemContainerStyle = _f.containerStyle, layout = _f.layout, _g = _f.itemSpacing, itemSpacing = _g === void 0 ? 4 : _g, sort = _f.sort, _h = _f.padding, itemPadding = _h === void 0 ? [6, 0, 0] : _h;\r\n            var itemPaddingArray = getCssPadding(itemPadding);\r\n            var _j = value, title = _j.title, items = _j.items;\r\n            var size = (cfg === null || cfg === void 0 ? void 0 : cfg.size) || [100, 30];\r\n            if (typeof size === 'number')\r\n                size = [size, size];\r\n            var height = 0; // 统计容器总高度，动态设置\r\n            var shapeWidth = size[0];\r\n            var contentWidth = shapeWidth - paddingArray[1] - paddingArray[3];\r\n            // card box\r\n            var cardStyle = getStyle(style, cfg, group);\r\n            var shape = group.addShape('rect', {\r\n                attrs: __assign(__assign({ x: 0, y: 0, width: size[0], height: size[1] }, defaultCardStyle), cardStyle),\r\n                name: 'main-box',\r\n                draggable: true,\r\n            });\r\n            // node title\r\n            var titleTextShape, itemShape, titleShape;\r\n            if (title) {\r\n                // title rect\r\n                titleShape = group.addShape('rect', {\r\n                    attrs: __assign(__assign({ x: 0, y: 0, width: size[0], height: 0 }, defaultTitleRectStyle), getStyle(titleContainerStyle, cfg, group)),\r\n                    name: 'title-rect',\r\n                    draggable: true,\r\n                });\r\n                titleTextShape = group.addShape('text', {\r\n                    attrs: __assign(__assign({ x: paddingArray[3], y: paddingArray[0], textBaseline: 'top', text: title }, defaultTitleLabelStyle), getStyle(titleStyle, cfg, group)),\r\n                    name: 'title',\r\n                });\r\n                var titleHeight = (titleTextShape\r\n                    ? titleTextShape.getBBox()\r\n                    : { height: size[1] / 2 }).height;\r\n                titleShape === null || titleShape === void 0 ? void 0 : titleShape.attr('height', titleHeight + paddingArray[0] + paddingArray[2]);\r\n                height += titleShape.getBBox().height;\r\n            }\r\n            if (items) {\r\n                itemShape = group.addShape('rect', {\r\n                    attrs: __assign({ x: paddingArray[3], y: height, width: contentWidth, height: 0 }, getStyle(itemContainerStyle, cfg, group)),\r\n                    name: 'item-box',\r\n                });\r\n                height += itemPaddingArray[0];\r\n                var itemContentWidth_1 = contentWidth - itemPaddingArray[1] - itemPaddingArray[3];\r\n                var isArray_1 = Array.isArray(items);\r\n                var createRowItems_1 = function (item, contentWidth, startX, index) {\r\n                    if (index === void 0) { index = 0; }\r\n                    var rowHeight = [];\r\n                    var valueShapeWidth = 0;\r\n                    var keys = sort ? Object.keys(item) : ['text', 'value', 'icon'];\r\n                    keys.forEach(function (key, keyIndex) {\r\n                        var x;\r\n                        var isIcon = key.startsWith('icon');\r\n                        // sort 直接均分，简单化\r\n                        if (sort || layout === 'flex') {\r\n                            x = (keyIndex * contentWidth) / keys.length;\r\n                        }\r\n                        else if (layout === 'follow') {\r\n                            x = valueShapeWidth;\r\n                        }\r\n                        else {\r\n                            // layout === 'bundled'\r\n                            // 直接均分，icon 紧随 value\r\n                            x = key === 'text' ? 0 : contentWidth / 2;\r\n                            x += isIcon ? valueShapeWidth : 0;\r\n                        }\r\n                        var keyShape = group.addShape(isIcon ? 'image' : 'text', {\r\n                            attrs: __assign(__assign({ textBaseline: 'top', x: startX + x, y: height, text: item[key], img: item[key] }, (isIcon ? defaultIconStyle : defaultLabelStyle)), getStyle(itemStyle || labelStyle, cfg, group, key)),\r\n                            name: key + \"-\" + index + \"-\" + keyIndex,\r\n                        });\r\n                        if (key === 'value' || layout === 'follow') {\r\n                            valueShapeWidth += keyShape.getBBox().width;\r\n                            valueShapeWidth += layout === 'follow' ? itemSpacing : 0;\r\n                        }\r\n                        rowHeight.push(keyShape.getBBox().height);\r\n                    });\r\n                    return rowHeight;\r\n                };\r\n                var createItems_1 = function (item, index) {\r\n                    var _a;\r\n                    if (index === void 0) { index = 0; }\r\n                    var itemsHeight = [];\r\n                    if (customContent) {\r\n                        itemsHeight.push((_a = customContent(item, group, {\r\n                            startX: paddingArray[3] + itemPaddingArray[3],\r\n                            startY: height,\r\n                            width: itemContentWidth_1,\r\n                        })) !== null && _a !== void 0 ? _a : 0);\r\n                    }\r\n                    else {\r\n                        itemsHeight.push.apply(itemsHeight, createRowItems_1(item, itemContentWidth_1, paddingArray[3] + itemPaddingArray[3], index));\r\n                    }\r\n                    height += Math.max.apply(Math, itemsHeight);\r\n                    if (isArray_1 && index !== items.length - 1) {\r\n                        height += defaultMargin;\r\n                    }\r\n                };\r\n                if (Array.isArray(items)) {\r\n                    items.forEach(function (item, index) {\r\n                        createItems_1(item, index);\r\n                    });\r\n                }\r\n                else {\r\n                    createItems_1(items);\r\n                }\r\n            }\r\n            itemShape === null || itemShape === void 0 ? void 0 : itemShape.attr('height', Math.max(height - (titleShape === null || titleShape === void 0 ? void 0 : titleShape.getBBox().height) + itemPaddingArray[2], size[1]));\r\n            var shapeHeight = items\r\n                ? (titleShape === null || titleShape === void 0 ? void 0 : titleShape.getBBox().height) + (itemShape === null || itemShape === void 0 ? void 0 : itemShape.getBBox().height) + paddingArray[2]\r\n                : (titleShape === null || titleShape === void 0 ? void 0 : titleShape.getBBox().height) + (itemShape === null || itemShape === void 0 ? void 0 : itemShape.getBBox().height);\r\n            shape === null || shape === void 0 ? void 0 : shape.attr('height', shapeHeight);\r\n            if (badge) {\r\n                var statusConfig = getStatusCfg(badge, [size[0], shapeHeight]);\r\n                group.addShape('rect', {\r\n                    attrs: __assign(__assign({ fill: '#40a9ff' }, statusConfig), getStyle(badge.style, cfg, group)),\r\n                    name: 'status-rect',\r\n                });\r\n            }\r\n            // collapse marker\r\n            if (markerCfg) {\r\n                var _k = shape.getBBox(), shapeWidth_1 = _k.width, shapeHeight_1 = _k.height;\r\n                var _l = typeof markerCfg === 'function' ? markerCfg(cfg, group) : markerCfg, show = _l.show, _m = _l.position, position = _m === void 0 ? 'right' : _m, collapsed = _l.collapsed, markerStyle = _l.style;\r\n                createMarker({\r\n                    show: show,\r\n                    position: position,\r\n                    collapsed: collapsed,\r\n                    style: markerStyle,\r\n                }, group, [shapeWidth_1, shapeHeight_1]);\r\n                shape.attr('defaultCollapsed', collapsed);\r\n            }\r\n            return shape;\r\n        },\r\n        /**\r\n         * 更新节点，包含文本\r\n         * @override\r\n         * @param  {Object} cfg 节点的配置项\r\n         * @param  {Node} node 节点\r\n         */\r\n        update: function (cfg, node) {\r\n            var group = node.getContainer();\r\n            var markerShape = group\r\n                .get('children')\r\n                .find(function (item) { return item.get('type') === 'marker'; });\r\n            var collapsed = node.getModel().collapsed;\r\n            markerShape === null || markerShape === void 0 ? void 0 : markerShape.attr({\r\n                symbol: collapsed ? G6.Marker.expand : G6.Marker.collapse,\r\n            });\r\n        },\r\n    }, 'single-node');\r\n};\r\n"]},"metadata":{},"sourceType":"module"}