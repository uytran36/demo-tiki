{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nimport React, { useEffect } from 'react';\nimport G6 from '@antv/g6';\nimport ChartLoading from '../../util/createLoading';\nimport { ErrorBoundary } from '../../base';\nimport useGraph from '../../hooks/useGraph';\nimport useProps from '../../hooks/useProps';\nimport { defaultStateStyles } from '../constants';\nimport { getGraphSize, processMinimap, getGraphId, renderGraph, getArrowCfg, getCommonConfig, bindStateEvents } from '../utils';\nimport { registerOrganizationCardNode } from './customItem';\nregisterOrganizationCardNode();\nvar defaultNodeStyle = {\n  fill: '#91d5ff',\n  stroke: '#40a9ff',\n  radius: 2\n};\nvar defaultLayout = {\n  type: 'compactBox',\n  direction: 'TB',\n  getId: function getId(d) {\n    return d.id;\n  },\n  getHeight: function getHeight() {\n    return 16;\n  },\n  getWidth: function getWidth() {\n    return 16;\n  },\n  getVGap: function getVGap() {\n    return 40;\n  },\n  getHGap: function getHGap() {\n    return 70;\n  }\n};\nvar defaultProps = {\n  nodeCfg: {\n    type: 'organization-card',\n    size: [100, 44],\n    style: defaultNodeStyle,\n    padding: 6,\n    anchorPoints: [[0.5, 0], [0.5, 1]],\n    nodeStateStyles: defaultStateStyles,\n    label: {\n      style: function (cfg, group, type) {\n        var styles = {\n          icon: {\n            width: 32,\n            height: 32\n          },\n          value: {\n            fill: '#fff'\n          },\n          text: {\n            fill: '#000'\n          }\n        };\n        return type ? styles[type] : {};\n      }\n    }\n  },\n  edgeCfg: {\n    type: 'polyline',\n    endArrow: {\n      type: 'triangle',\n      fill: '#91d5ff'\n    },\n    edgeStateStyles: defaultStateStyles,\n    style: {\n      stroke: '#91d5ff'\n    }\n  },\n  behaviors: ['zoom-canvas', 'drag-canvas'],\n  layout: defaultLayout,\n  animate: true,\n  markerPosition: 'right',\n  autoFit: true,\n  fitCenter: true,\n  style: {\n    height: 'inherit'\n  }\n};\nvar graphs = {};\n\nvar OrganizationGraph = function (props) {\n  var uProps = useProps(props, defaultProps).uProps;\n  var data = uProps.data,\n      className = uProps.className,\n      style = uProps.style,\n      width = uProps.width,\n      height = uProps.height,\n      animate = uProps.animate,\n      behaviors = uProps.behaviors,\n      nodeCfg = uProps.nodeCfg,\n      layout = uProps.layout,\n      minimapCfg = uProps.minimapCfg,\n      edgeCfg = uProps.edgeCfg,\n      markerCfg = uProps.markerCfg,\n      autoFit = uProps.autoFit,\n      fitCenter = uProps.fitCenter,\n      onReady = uProps.onReady,\n      loading = uProps.loading,\n      loadingTemplate = uProps.loadingTemplate,\n      errorTemplate = uProps.errorTemplate;\n\n  var _a = nodeCfg !== null && nodeCfg !== void 0 ? nodeCfg : {},\n      nodeType = _a.type,\n      nodeSize = _a.size,\n      nodeAnchorPoints = _a.anchorPoints,\n      nodeStateStyles = _a.nodeStateStyles;\n\n  var _b = edgeCfg !== null && edgeCfg !== void 0 ? edgeCfg : {},\n      edgeType = _b.type,\n      edgeStyle = _b.style,\n      startArrowCfg = _b.startArrow,\n      endArrowCfg = _b.endArrow,\n      labelCfg = _b.label,\n      edgeStateStyles = _b.edgeStateStyles;\n\n  var container = React.useRef(null);\n  var graph = React.useRef(null);\n  var graphId = getGraphId(graph);\n  useGraph(graphs[graphId], uProps, container);\n  useEffect(function () {\n    var graphSize = getGraphSize(width, height, container);\n    var graph = graphs[graphId];\n\n    if (!graph) {\n      graph = new G6.TreeGraph({\n        container: container.current,\n        width: graphSize[0],\n        height: graphSize[1],\n        animate: animate,\n        modes: {\n          default: behaviors\n        },\n        defaultNode: {\n          type: nodeType,\n          size: nodeSize,\n          anchorPoints: nodeAnchorPoints,\n          nodeCfg: nodeCfg\n        },\n        defaultEdge: {\n          type: edgeType\n        },\n        nodeStateStyles: nodeStateStyles,\n        edgeStateStyles: edgeStateStyles,\n        layout: layout,\n        fitView: autoFit,\n        fitCenter: fitCenter\n      });\n      graphs[graphId] = graph;\n    } // defaultNode 默认只能绑定 plainObject，针对 Function 类型需要通过该模式绑定\n\n\n    graph.node(function (node) {\n      node.markerCfg = markerCfg;\n      return {};\n    });\n    graph.edge(function (edge) {\n      var startArrow = getArrowCfg(startArrowCfg, edge);\n      var endArrow = getArrowCfg(endArrowCfg, edge);\n\n      var _a = labelCfg !== null && labelCfg !== void 0 ? labelCfg : {},\n          style = _a.style,\n          content = _a.content;\n\n      return {\n        label: getCommonConfig(content, edge, graph),\n        labelCfg: {\n          style: getCommonConfig(style, edge, graph)\n        },\n        style: __assign({\n          stroke: '#ccc',\n          startArrow: startArrow,\n          endArrow: endArrow\n        }, typeof edgeStyle === 'function' ? edgeStyle(edge, graph) : edgeStyle)\n      };\n    });\n    processMinimap(minimapCfg, graph);\n    bindStateEvents(graph, uProps);\n    renderGraph(graph, data);\n\n    if (onReady) {\n      onReady(graph);\n    }\n\n    return function () {\n      if (graphs[graphId]) {\n        graphs[graphId].destroy();\n        delete graphs[graphId];\n      }\n    };\n  }, []);\n  return React.createElement(ErrorBoundary, {\n    errorTemplate: errorTemplate\n  }, loading && React.createElement(ChartLoading, {\n    loadingTemplate: loadingTemplate\n  }), React.createElement(\"div\", {\n    className: className,\n    style: style,\n    ref: container\n  }));\n};\n\nexport default OrganizationGraph;","map":{"version":3,"sources":["E:/sqlindex2/sql/frontend/node_modules/@ant-design/charts/es/graphs/organizationGraph/index.js"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","React","useEffect","G6","ChartLoading","ErrorBoundary","useGraph","useProps","defaultStateStyles","getGraphSize","processMinimap","getGraphId","renderGraph","getArrowCfg","getCommonConfig","bindStateEvents","registerOrganizationCardNode","defaultNodeStyle","fill","stroke","radius","defaultLayout","type","direction","getId","d","id","getHeight","getWidth","getVGap","getHGap","defaultProps","nodeCfg","size","style","padding","anchorPoints","nodeStateStyles","label","cfg","group","styles","icon","width","height","value","text","edgeCfg","endArrow","edgeStateStyles","behaviors","layout","animate","markerPosition","autoFit","fitCenter","graphs","OrganizationGraph","props","uProps","data","className","minimapCfg","markerCfg","onReady","loading","loadingTemplate","errorTemplate","_a","nodeType","nodeSize","nodeAnchorPoints","_b","edgeType","edgeStyle","startArrowCfg","startArrow","endArrowCfg","labelCfg","container","useRef","graph","graphId","graphSize","TreeGraph","current","modes","default","defaultNode","defaultEdge","fitView","node","edge","content","destroy","createElement","ref"],"mappings":"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","sourcesContent":["var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nimport React, { useEffect } from 'react';\r\nimport G6 from '@antv/g6';\r\nimport ChartLoading from '../../util/createLoading';\r\nimport { ErrorBoundary } from '../../base';\r\nimport useGraph from '../../hooks/useGraph';\r\nimport useProps from '../../hooks/useProps';\r\nimport { defaultStateStyles } from '../constants';\r\nimport { getGraphSize, processMinimap, getGraphId, renderGraph, getArrowCfg, getCommonConfig, bindStateEvents, } from '../utils';\r\nimport { registerOrganizationCardNode } from './customItem';\r\nregisterOrganizationCardNode();\r\nvar defaultNodeStyle = {\r\n    fill: '#91d5ff',\r\n    stroke: '#40a9ff',\r\n    radius: 2,\r\n};\r\nvar defaultLayout = {\r\n    type: 'compactBox',\r\n    direction: 'TB',\r\n    getId: function getId(d) {\r\n        return d.id;\r\n    },\r\n    getHeight: function getHeight() {\r\n        return 16;\r\n    },\r\n    getWidth: function getWidth() {\r\n        return 16;\r\n    },\r\n    getVGap: function getVGap() {\r\n        return 40;\r\n    },\r\n    getHGap: function getHGap() {\r\n        return 70;\r\n    },\r\n};\r\nvar defaultProps = {\r\n    nodeCfg: {\r\n        type: 'organization-card',\r\n        size: [100, 44],\r\n        style: defaultNodeStyle,\r\n        padding: 6,\r\n        anchorPoints: [\r\n            [0.5, 0],\r\n            [0.5, 1],\r\n        ],\r\n        nodeStateStyles: defaultStateStyles,\r\n        label: {\r\n            style: function (cfg, group, type) {\r\n                var styles = {\r\n                    icon: {\r\n                        width: 32,\r\n                        height: 32,\r\n                    },\r\n                    value: {\r\n                        fill: '#fff',\r\n                    },\r\n                    text: {\r\n                        fill: '#000',\r\n                    },\r\n                };\r\n                return type ? styles[type] : {};\r\n            },\r\n        },\r\n    },\r\n    edgeCfg: {\r\n        type: 'polyline',\r\n        endArrow: {\r\n            type: 'triangle',\r\n            fill: '#91d5ff',\r\n        },\r\n        edgeStateStyles: defaultStateStyles,\r\n        style: {\r\n            stroke: '#91d5ff',\r\n        },\r\n    },\r\n    behaviors: ['zoom-canvas', 'drag-canvas'],\r\n    layout: defaultLayout,\r\n    animate: true,\r\n    markerPosition: 'right',\r\n    autoFit: true,\r\n    fitCenter: true,\r\n    style: {\r\n        height: 'inherit',\r\n    },\r\n};\r\nvar graphs = {};\r\nvar OrganizationGraph = function (props) {\r\n    var uProps = useProps(props, defaultProps).uProps;\r\n    var data = uProps.data, className = uProps.className, style = uProps.style, width = uProps.width, height = uProps.height, animate = uProps.animate, behaviors = uProps.behaviors, nodeCfg = uProps.nodeCfg, layout = uProps.layout, minimapCfg = uProps.minimapCfg, edgeCfg = uProps.edgeCfg, markerCfg = uProps.markerCfg, autoFit = uProps.autoFit, fitCenter = uProps.fitCenter, onReady = uProps.onReady, loading = uProps.loading, loadingTemplate = uProps.loadingTemplate, errorTemplate = uProps.errorTemplate;\r\n    var _a = nodeCfg !== null && nodeCfg !== void 0 ? nodeCfg : {}, nodeType = _a.type, nodeSize = _a.size, nodeAnchorPoints = _a.anchorPoints, nodeStateStyles = _a.nodeStateStyles;\r\n    var _b = edgeCfg !== null && edgeCfg !== void 0 ? edgeCfg : {}, edgeType = _b.type, edgeStyle = _b.style, startArrowCfg = _b.startArrow, endArrowCfg = _b.endArrow, labelCfg = _b.label, edgeStateStyles = _b.edgeStateStyles;\r\n    var container = React.useRef(null);\r\n    var graph = React.useRef(null);\r\n    var graphId = getGraphId(graph);\r\n    useGraph(graphs[graphId], uProps, container);\r\n    useEffect(function () {\r\n        var graphSize = getGraphSize(width, height, container);\r\n        var graph = graphs[graphId];\r\n        if (!graph) {\r\n            graph = new G6.TreeGraph({\r\n                container: container.current,\r\n                width: graphSize[0],\r\n                height: graphSize[1],\r\n                animate: animate,\r\n                modes: {\r\n                    default: behaviors,\r\n                },\r\n                defaultNode: {\r\n                    type: nodeType,\r\n                    size: nodeSize,\r\n                    anchorPoints: nodeAnchorPoints,\r\n                    nodeCfg: nodeCfg,\r\n                },\r\n                defaultEdge: {\r\n                    type: edgeType,\r\n                },\r\n                nodeStateStyles: nodeStateStyles,\r\n                edgeStateStyles: edgeStateStyles,\r\n                layout: layout,\r\n                fitView: autoFit,\r\n                fitCenter: fitCenter,\r\n            });\r\n            graphs[graphId] = graph;\r\n        }\r\n        // defaultNode 默认只能绑定 plainObject，针对 Function 类型需要通过该模式绑定\r\n        graph.node(function (node) {\r\n            node.markerCfg = markerCfg;\r\n            return {};\r\n        });\r\n        graph.edge(function (edge) {\r\n            var startArrow = getArrowCfg(startArrowCfg, edge);\r\n            var endArrow = getArrowCfg(endArrowCfg, edge);\r\n            var _a = labelCfg !== null && labelCfg !== void 0 ? labelCfg : {}, style = _a.style, content = _a.content;\r\n            return {\r\n                label: getCommonConfig(content, edge, graph),\r\n                labelCfg: {\r\n                    style: getCommonConfig(style, edge, graph),\r\n                },\r\n                style: __assign({ stroke: '#ccc', startArrow: startArrow, endArrow: endArrow }, (typeof edgeStyle === 'function' ? edgeStyle(edge, graph) : edgeStyle)),\r\n            };\r\n        });\r\n        processMinimap(minimapCfg, graph);\r\n        bindStateEvents(graph, uProps);\r\n        renderGraph(graph, data);\r\n        if (onReady) {\r\n            onReady(graph);\r\n        }\r\n        return function () {\r\n            if (graphs[graphId]) {\r\n                graphs[graphId].destroy();\r\n                delete graphs[graphId];\r\n            }\r\n        };\r\n    }, []);\r\n    return (React.createElement(ErrorBoundary, { errorTemplate: errorTemplate },\r\n        loading && React.createElement(ChartLoading, { loadingTemplate: loadingTemplate }),\r\n        React.createElement(\"div\", { className: className, style: style, ref: container })));\r\n};\r\nexport default OrganizationGraph;\r\n"]},"metadata":{},"sourceType":"module"}