{"ast":null,"code":"import { isNil, each, isString } from './util';\nimport { getOffScreenContext } from './offscreen';\n/**\r\n * 获取文本的高度\r\n * @param text 文本\r\n * @param fontSize 字体大小\r\n * @param lineHeight 行高，可以为空\r\n */\n\nexport function getTextHeight(text, fontSize, lineHeight) {\n  var lineCount = 1;\n\n  if (isString(text)) {\n    lineCount = text.split('\\n').length;\n  }\n\n  if (lineCount > 1) {\n    var spaceingY = getLineSpaceing(fontSize, lineHeight);\n    return fontSize * lineCount + spaceingY * (lineCount - 1);\n  }\n\n  return fontSize;\n}\n/**\r\n * 获取行间距如果文本多行，需要获取文本间距\r\n * @param fontSize 字体大小\r\n * @param lineHeight 行高\r\n */\n\nexport function getLineSpaceing(fontSize, lineHeight) {\n  return lineHeight ? lineHeight - fontSize : fontSize * 0.14;\n}\n/**\r\n * 字体宽度\r\n * @param text 文本\r\n * @param font 字体\r\n */\n\nexport function getTextWidth(text, font) {\n  var context = getOffScreenContext(); // 获取离屏的 ctx 进行计算\n\n  var width = 0; // null 或者 undefined 时，宽度为 0\n\n  if (isNil(text) || text === '') {\n    return width;\n  }\n\n  context.save();\n  context.font = font;\n\n  if (isString(text) && text.includes('\\n')) {\n    var textArr = text.split('\\n');\n    each(textArr, function (subText) {\n      var measureWidth = context.measureText(subText).width;\n\n      if (width < measureWidth) {\n        width = measureWidth;\n      }\n    });\n  } else {\n    width = context.measureText(text).width;\n  }\n\n  context.restore();\n  return width;\n}\nexport function assembleFont(attrs) {\n  var fontSize = attrs.fontSize,\n      fontFamily = attrs.fontFamily,\n      fontWeight = attrs.fontWeight,\n      fontStyle = attrs.fontStyle,\n      fontVariant = attrs.fontVariant;\n  return [fontStyle, fontVariant, fontWeight, fontSize + \"px\", fontFamily].join(' ').trim();\n}","map":{"version":3,"sources":["../../src/util/text.ts"],"names":[],"mappings":"AAAA,SAAS,KAAT,EAAgB,IAAhB,EAAsB,QAAtB,QAAsC,QAAtC;AACA,SAAS,mBAAT,QAAoC,aAApC;AAGA;;;;;AAKG;;AACH,OAAM,SAAU,aAAV,CAAwB,IAAxB,EAAsC,QAAtC,EAAwD,UAAxD,EAA2E;AAC/E,MAAI,SAAS,GAAG,CAAhB;;AACA,MAAI,QAAQ,CAAC,IAAD,CAAZ,EAAoB;AAClB,IAAA,SAAS,GAAG,IAAI,CAAC,KAAL,CAAW,IAAX,EAAiB,MAA7B;AACD;;AACD,MAAI,SAAS,GAAG,CAAhB,EAAmB;AACjB,QAAM,SAAS,GAAG,eAAe,CAAC,QAAD,EAAW,UAAX,CAAjC;AACA,WAAO,QAAQ,GAAG,SAAX,GAAuB,SAAS,IAAI,SAAS,GAAG,CAAhB,CAAvC;AACD;;AACD,SAAO,QAAP;AACD;AAED;;;;AAIG;;AACH,OAAM,SAAU,eAAV,CAA0B,QAA1B,EAA4C,UAA5C,EAA+D;AACnE,SAAO,UAAU,GAAG,UAAU,GAAG,QAAhB,GAA2B,QAAQ,GAAG,IAAvD;AACD;AAED;;;;AAIG;;AACH,OAAM,SAAU,YAAV,CAAuB,IAAvB,EAAqC,IAArC,EAAiD;AACrD,MAAM,OAAO,GAAG,mBAAmB,EAAnC,CADqD,CACd;;AACvC,MAAI,KAAK,GAAG,CAAZ,CAFqD,CAGrD;;AACA,MAAI,KAAK,CAAC,IAAD,CAAL,IAAe,IAAI,KAAK,EAA5B,EAAgC;AAC9B,WAAO,KAAP;AACD;;AACD,EAAA,OAAO,CAAC,IAAR;AACA,EAAA,OAAO,CAAC,IAAR,GAAe,IAAf;;AACA,MAAI,QAAQ,CAAC,IAAD,CAAR,IAAkB,IAAI,CAAC,QAAL,CAAc,IAAd,CAAtB,EAA2C;AACzC,QAAM,OAAO,GAAG,IAAI,CAAC,KAAL,CAAW,IAAX,CAAhB;AACA,IAAA,IAAI,CAAC,OAAD,EAAU,UAAC,OAAD,EAAQ;AACpB,UAAM,YAAY,GAAG,OAAO,CAAC,WAAR,CAAoB,OAApB,EAA6B,KAAlD;;AACA,UAAI,KAAK,GAAG,YAAZ,EAA0B;AACxB,QAAA,KAAK,GAAG,YAAR;AACD;AACF,KALG,CAAJ;AAMD,GARD,MAQO;AACL,IAAA,KAAK,GAAG,OAAO,CAAC,WAAR,CAAoB,IAApB,EAA0B,KAAlC;AACD;;AACD,EAAA,OAAO,CAAC,OAAR;AACA,SAAO,KAAP;AACD;AAED,OAAM,SAAU,YAAV,CAAuB,KAAvB,EAAwC;AACpC,MAAA,QAAQ,GAAqD,KAAK,CAA1D,QAAR;AAAA,MAAU,UAAU,GAAyC,KAAK,CAA9C,UAApB;AAAA,MAAsB,UAAU,GAA6B,KAAK,CAAlC,UAAhC;AAAA,MAAkC,SAAS,GAAkB,KAAK,CAAvB,SAA3C;AAAA,MAA6C,WAAW,GAAK,KAAK,CAAV,WAAxD;AACR,SAAO,CAAC,SAAD,EAAY,WAAZ,EAAyB,UAAzB,EAAwC,QAAQ,GAAA,IAAhD,EAAsD,UAAtD,EAAkE,IAAlE,CAAuE,GAAvE,EAA4E,IAA5E,EAAP;AACD","sourceRoot":"","sourcesContent":["import { isNil, each, isString } from './util';\r\nimport { getOffScreenContext } from './offscreen';\r\n/**\r\n * 获取文本的高度\r\n * @param text 文本\r\n * @param fontSize 字体大小\r\n * @param lineHeight 行高，可以为空\r\n */\r\nexport function getTextHeight(text, fontSize, lineHeight) {\r\n    var lineCount = 1;\r\n    if (isString(text)) {\r\n        lineCount = text.split('\\n').length;\r\n    }\r\n    if (lineCount > 1) {\r\n        var spaceingY = getLineSpaceing(fontSize, lineHeight);\r\n        return fontSize * lineCount + spaceingY * (lineCount - 1);\r\n    }\r\n    return fontSize;\r\n}\r\n/**\r\n * 获取行间距如果文本多行，需要获取文本间距\r\n * @param fontSize 字体大小\r\n * @param lineHeight 行高\r\n */\r\nexport function getLineSpaceing(fontSize, lineHeight) {\r\n    return lineHeight ? lineHeight - fontSize : fontSize * 0.14;\r\n}\r\n/**\r\n * 字体宽度\r\n * @param text 文本\r\n * @param font 字体\r\n */\r\nexport function getTextWidth(text, font) {\r\n    var context = getOffScreenContext(); // 获取离屏的 ctx 进行计算\r\n    var width = 0;\r\n    // null 或者 undefined 时，宽度为 0\r\n    if (isNil(text) || text === '') {\r\n        return width;\r\n    }\r\n    context.save();\r\n    context.font = font;\r\n    if (isString(text) && text.includes('\\n')) {\r\n        var textArr = text.split('\\n');\r\n        each(textArr, function (subText) {\r\n            var measureWidth = context.measureText(subText).width;\r\n            if (width < measureWidth) {\r\n                width = measureWidth;\r\n            }\r\n        });\r\n    }\r\n    else {\r\n        width = context.measureText(text).width;\r\n    }\r\n    context.restore();\r\n    return width;\r\n}\r\nexport function assembleFont(attrs) {\r\n    var fontSize = attrs.fontSize, fontFamily = attrs.fontFamily, fontWeight = attrs.fontWeight, fontStyle = attrs.fontStyle, fontVariant = attrs.fontVariant;\r\n    return [fontStyle, fontVariant, fontWeight, fontSize + \"px\", fontFamily].join(' ').trim();\r\n}\r\n//# sourceMappingURL=text.js.map"]},"metadata":{},"sourceType":"module"}