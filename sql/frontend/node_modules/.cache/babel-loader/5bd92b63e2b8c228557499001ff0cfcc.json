{"ast":null,"code":"import { __spreadArray } from \"tslib\";\nimport { isString } from '@antv/util';\nimport { traverseTree } from './graphic';\n/**\r\n * 验证关系图或树图数据的合法性，必须符合以下规则才会渲染图：\r\n * 1. 必须传入数据\r\n * 2. 节点的 ID 必须为字符串，暂不支持数字类型，如果支持数字类型，会出现类似 123 与 '123' 是否相等的问题\r\n * 3. 边的 source 和 target 值必须在节点 ID 中存在\r\n * @param data 关系图或树图数据\r\n * @return boolean 全部验证通过返回 true，否则返回 false\r\n */\n\nexport var dataValidation = function dataValidation(data) {\n  // 1. 必须传入数据\n  if (!data) {\n    console.error('G6 Error Tips: the data must be defined');\n    return false;\n  } // 2. 节点的 ID 必须为字符串或数字类型\n\n\n  var nodes = data.nodes,\n      edges = data.edges,\n      _a = data.combos,\n      combos = _a === void 0 ? [] : _a;\n\n  if (!nodes && !edges) {\n    var validated_1 = true; // 不存在 nodes 和 edges，则说明是 TreeGraphData，按 TreeGraphData 规则验证\n\n    traverseTree(data, function (param) {\n      if (!isString(param.id)) {\n        validated_1 = false;\n        return false;\n      }\n\n      return true;\n    });\n    return validated_1;\n  }\n\n  var nonNode = (nodes || []).find(function (node) {\n    return !isString(node.id);\n  });\n\n  if (nonNode) {\n    console.warn(\"G6 Warning Tips: missing 'id' property, or %c\" + nonNode.id + \"%c is not a string.\", 'font-size: 20px; color: red;', '');\n    return false;\n  } // 3. 边的 source 和 target 必须存在于节点 或 Combo中\n\n\n  var nodeIds = (nodes || []).map(function (node) {\n    return node.id;\n  });\n  var comboIds = combos.map(function (combo) {\n    return combo.id;\n  });\n\n  var ids = __spreadArray(__spreadArray([], nodeIds), comboIds);\n\n  var nonEdges = (edges || []).find(function (edge) {\n    return !ids.includes(edge.source) || !ids.includes(edge.target);\n  });\n\n  if (nonEdges) {\n    console.warn(\"G6 Warning Tips: The source %c\" + nonEdges.source + \"%c or the target %c\" + nonEdges.target + \"%c of the edge do not exist in the nodes or combos.\", 'font-size: 20px; color: red;', '', 'font-size: 20px; color: red;', '');\n    return false;\n  }\n\n  return true;\n};\n/**\r\n * 验证添加节点、边或从combo时的数据\r\n * @param type 节点、边或从combo\r\n * @param data 添加的单条数据\r\n * @return boolean 全部验证通过返回 true，否则返回 false\r\n */\n\nexport var singleDataValidation = function singleDataValidation(type, data) {\n  if (type === 'node' || type === 'combo') {\n    // 必须有 id 字段，且id必须为字符串类型\n    if (data.id && !isString(data.id)) {\n      console.warn(\"G6 Warning Tips: missing 'id' property, or the 'id' %c\" + data.id + \"%c is not a string.\", 'font-size: 20px; color: red;', '');\n      return false;\n    }\n  } else if (type === 'edge') {\n    // 必须有 source 和 target 字段\n    if (!data.source || !data.target) {\n      console.warn(\"G6 Warning Tips: missing 'source' or 'target' for the edge.\");\n      return false;\n    }\n  }\n\n  return true;\n};","map":{"version":3,"sources":["D:/Code/sqlindex2/sql/frontend/node_modules/@antv/g6-core/es/util/validation.js"],"names":["__spreadArray","isString","traverseTree","dataValidation","data","console","error","nodes","edges","_a","combos","validated_1","param","id","nonNode","find","node","warn","nodeIds","map","comboIds","combo","ids","nonEdges","edge","includes","source","target","singleDataValidation","type"],"mappings":"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","sourcesContent":["import { __spreadArray } from \"tslib\";\r\nimport { isString } from '@antv/util';\r\nimport { traverseTree } from './graphic';\r\n/**\r\n * 验证关系图或树图数据的合法性，必须符合以下规则才会渲染图：\r\n * 1. 必须传入数据\r\n * 2. 节点的 ID 必须为字符串，暂不支持数字类型，如果支持数字类型，会出现类似 123 与 '123' 是否相等的问题\r\n * 3. 边的 source 和 target 值必须在节点 ID 中存在\r\n * @param data 关系图或树图数据\r\n * @return boolean 全部验证通过返回 true，否则返回 false\r\n */\r\n\r\nexport var dataValidation = function dataValidation(data) {\r\n  // 1. 必须传入数据\r\n  if (!data) {\r\n    console.error('G6 Error Tips: the data must be defined');\r\n    return false;\r\n  } // 2. 节点的 ID 必须为字符串或数字类型\r\n\r\n\r\n  var nodes = data.nodes,\r\n      edges = data.edges,\r\n      _a = data.combos,\r\n      combos = _a === void 0 ? [] : _a;\r\n\r\n  if (!nodes && !edges) {\r\n    var validated_1 = true; // 不存在 nodes 和 edges，则说明是 TreeGraphData，按 TreeGraphData 规则验证\r\n\r\n    traverseTree(data, function (param) {\r\n      if (!isString(param.id)) {\r\n        validated_1 = false;\r\n        return false;\r\n      }\r\n\r\n      return true;\r\n    });\r\n    return validated_1;\r\n  }\r\n\r\n  var nonNode = (nodes || []).find(function (node) {\r\n    return !isString(node.id);\r\n  });\r\n\r\n  if (nonNode) {\r\n    console.warn(\"G6 Warning Tips: missing 'id' property, or %c\" + nonNode.id + \"%c is not a string.\", 'font-size: 20px; color: red;', '');\r\n    return false;\r\n  } // 3. 边的 source 和 target 必须存在于节点 或 Combo中\r\n\r\n\r\n  var nodeIds = (nodes || []).map(function (node) {\r\n    return node.id;\r\n  });\r\n  var comboIds = combos.map(function (combo) {\r\n    return combo.id;\r\n  });\r\n\r\n  var ids = __spreadArray(__spreadArray([], nodeIds), comboIds);\r\n\r\n  var nonEdges = (edges || []).find(function (edge) {\r\n    return !ids.includes(edge.source) || !ids.includes(edge.target);\r\n  });\r\n\r\n  if (nonEdges) {\r\n    console.warn(\"G6 Warning Tips: The source %c\" + nonEdges.source + \"%c or the target %c\" + nonEdges.target + \"%c of the edge do not exist in the nodes or combos.\", 'font-size: 20px; color: red;', '', 'font-size: 20px; color: red;', '');\r\n    return false;\r\n  }\r\n\r\n  return true;\r\n};\r\n/**\r\n * 验证添加节点、边或从combo时的数据\r\n * @param type 节点、边或从combo\r\n * @param data 添加的单条数据\r\n * @return boolean 全部验证通过返回 true，否则返回 false\r\n */\r\n\r\nexport var singleDataValidation = function singleDataValidation(type, data) {\r\n  if (type === 'node' || type === 'combo') {\r\n    // 必须有 id 字段，且id必须为字符串类型\r\n    if (data.id && !isString(data.id)) {\r\n      console.warn(\"G6 Warning Tips: missing 'id' property, or the 'id' %c\" + data.id + \"%c is not a string.\", 'font-size: 20px; color: red;', '');\r\n      return false;\r\n    }\r\n  } else if (type === 'edge') {\r\n    // 必须有 source 和 target 字段\r\n    if (!data.source || !data.target) {\r\n      console.warn(\"G6 Warning Tips: missing 'source' or 'target' for the edge.\");\r\n      return false;\r\n    }\r\n  }\r\n\r\n  return true;\r\n};"]},"metadata":{},"sourceType":"module"}