{"ast":null,"code":"import { __assign, __rest } from \"tslib\";\nimport { registerNode, BaseGlobal as Global } from '@antv/g6-core';\nimport { mix } from '@antv/util'; // 五角星shape\n\nregisterNode('star', {\n  // 自定义节点时的配置\n  options: {\n    size: 60,\n    style: {\n      stroke: Global.defaultNode.style.stroke,\n      fill: Global.defaultNode.style.fill,\n      lineWidth: Global.defaultNode.style.lineWidth\n    },\n    labelCfg: {\n      style: {\n        fill: Global.nodeLabel.style.fill,\n        fontSize: Global.nodeLabel.style.fontSize\n      }\n    },\n    // 节点上左右上下四个方向上的链接circle配置\n    linkPoints: {\n      top: false,\n      right: false,\n      bottom: false,\n      left: false,\n      // circle的大小\n      size: Global.defaultNode.linkPoints.size,\n      lineWidth: Global.defaultNode.linkPoints.lineWidth,\n      fill: Global.defaultNode.linkPoints.fill,\n      stroke: Global.defaultNode.linkPoints.stroke\n    },\n    // 节点中icon配置\n    icon: {\n      // 是否显示icon，值为 false 则不渲染icon\n      show: false,\n      // icon的地址，字符串类型\n      img: 'https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg',\n      width: 20,\n      height: 20\n    },\n    stateStyles: __assign({}, Global.nodeStateStyles)\n  },\n  shapeType: 'star',\n  // 文本位置\n  labelPosition: 'center',\n  drawShape: function drawShape(cfg, group) {\n    var _a = this.getOptions(cfg).icon,\n        icon = _a === void 0 ? {} : _a;\n    var style = this.getShapeStyle(cfg);\n    var keyShape = group.addShape('path', {\n      attrs: style,\n      className: this.type + \"-keyShape\",\n      name: this.type + \"-keyShape\",\n      draggable: true\n    });\n    var w = icon.width,\n        h = icon.height,\n        show = icon.show,\n        text = icon.text;\n\n    if (show) {\n      if (text) {\n        group.addShape('text', {\n          attrs: __assign({\n            x: 0,\n            y: 0,\n            fontSize: 12,\n            fill: '#000',\n            stroke: '#000',\n            textBaseline: 'middle',\n            textAlign: 'center'\n          }, icon),\n          className: this.type + \"-icon\",\n          name: this.type + \"-icon\",\n          draggable: true\n        });\n      } else {\n        group.addShape('image', {\n          attrs: __assign({\n            x: -w / 2,\n            y: -h / 2\n          }, icon),\n          className: this.type + \"-icon\",\n          name: this.type + \"-icon\",\n          draggable: true\n        });\n      }\n    }\n\n    this.drawLinkPoints(cfg, group);\n    return keyShape;\n  },\n\n  /**\r\n   * 绘制节点上的LinkPoints\r\n   * @param {Object} cfg data数据配置项\r\n   * @param {Group} group Group实例\r\n   */\n  drawLinkPoints: function drawLinkPoints(cfg, group) {\n    var _a = this.getOptions(cfg).linkPoints,\n        linkPoints = _a === void 0 ? {} : _a;\n\n    var top = linkPoints.top,\n        left = linkPoints.left,\n        right = linkPoints.right,\n        leftBottom = linkPoints.leftBottom,\n        rightBottom = linkPoints.rightBottom,\n        markSize = linkPoints.size,\n        markR = linkPoints.r,\n        markStyle = __rest(linkPoints, [\"top\", \"left\", \"right\", \"leftBottom\", \"rightBottom\", \"size\", \"r\"]);\n\n    var size = this.getSize(cfg);\n    var outerR = size[0];\n\n    if (right) {\n      // right circle\n      // up down left right 四个方向的坐标均不相同\n      var x1 = Math.cos((18 + 72 * 0) / 180 * Math.PI) * outerR;\n      var y1 = Math.sin((18 + 72 * 0) / 180 * Math.PI) * outerR;\n      group.addShape('circle', {\n        attrs: __assign(__assign({}, markStyle), {\n          x: x1,\n          y: -y1,\n          r: markSize / 2 || markR || 5\n        }),\n        className: 'link-point-right',\n        name: 'link-point-right'\n      });\n    }\n\n    if (top) {\n      // up down left right 四个方向的坐标均不相同\n      var x1 = Math.cos((18 + 72 * 1) / 180 * Math.PI) * outerR;\n      var y1 = Math.sin((18 + 72 * 1) / 180 * Math.PI) * outerR; // top circle\n\n      group.addShape('circle', {\n        attrs: __assign(__assign({}, markStyle), {\n          x: x1,\n          y: -y1,\n          r: markSize / 2 || markR || 5\n        }),\n        className: 'link-point-top',\n        name: 'link-point-top'\n      });\n    }\n\n    if (left) {\n      // up down left right 四个方向的坐标均不相同\n      var x1 = Math.cos((18 + 72 * 2) / 180 * Math.PI) * outerR;\n      var y1 = Math.sin((18 + 72 * 2) / 180 * Math.PI) * outerR; // left circle\n\n      group.addShape('circle', {\n        attrs: __assign(__assign({}, markStyle), {\n          x: x1,\n          y: -y1,\n          r: markSize / 2 || markR || 5\n        }),\n        className: 'link-point-left',\n        name: 'link-point-left'\n      });\n    }\n\n    if (leftBottom) {\n      // up down left right 四个方向的坐标均不相同\n      var x1 = Math.cos((18 + 72 * 3) / 180 * Math.PI) * outerR;\n      var y1 = Math.sin((18 + 72 * 3) / 180 * Math.PI) * outerR; // left bottom circle\n\n      group.addShape('circle', {\n        attrs: __assign(__assign({}, markStyle), {\n          x: x1,\n          y: -y1,\n          r: markSize / 2 || markR || 5\n        }),\n        className: 'link-point-left-bottom',\n        name: 'link-point-left-bottom'\n      });\n    }\n\n    if (rightBottom) {\n      // up down left right 四个方向的坐标均不相同\n      var x1 = Math.cos((18 + 72 * 4) / 180 * Math.PI) * outerR;\n      var y1 = Math.sin((18 + 72 * 4) / 180 * Math.PI) * outerR; // left bottom circle\n\n      group.addShape('circle', {\n        attrs: __assign(__assign({}, markStyle), {\n          x: x1,\n          y: -y1,\n          r: markSize / 2 || markR || 5\n        }),\n        className: 'link-point-right-bottom',\n        name: 'link-point-right-bottom'\n      });\n    }\n  },\n  getPath: function getPath(cfg) {\n    var size = this.getSize(cfg);\n    var outerR = size[0];\n    var defaultInnerR = outerR * 3 / 8;\n    var innerR = cfg.innerR || defaultInnerR;\n    var path = [];\n\n    for (var i = 0; i < 5; i++) {\n      var x1 = Math.cos((18 + 72 * i) / 180 * Math.PI) * outerR;\n      var y1 = Math.sin((18 + 72 * i) / 180 * Math.PI) * outerR;\n      var x2 = Math.cos((54 + 72 * i) / 180 * Math.PI) * innerR;\n      var y2 = Math.sin((54 + 72 * i) / 180 * Math.PI) * innerR;\n\n      if (i === 0) {\n        path.push(['M', x1, -y1]);\n      } else {\n        path.push(['L', x1, -y1]);\n      }\n\n      path.push(['L', x2, -y2]);\n    }\n\n    path.push(['Z']);\n    return path;\n  },\n\n  /**\r\n   * 获取节点的样式，供基于该节点自定义时使用\r\n   * @param {Object} cfg 节点数据模型\r\n   * @return {Object} 节点的样式\r\n   */\n  getShapeStyle: function getShapeStyle(cfg) {\n    var defaultStyle = this.getOptions(cfg).style;\n    var strokeStyle = {\n      stroke: cfg.color\n    }; // 如果设置了color，则覆盖原来默认的 stroke 属性。但 cfg 中但 stroke 属性优先级更高\n\n    var style = mix({}, defaultStyle, strokeStyle);\n    var path = this.getPath(cfg);\n\n    var styles = __assign({\n      path: path\n    }, style);\n\n    return styles;\n  },\n  update: function update(cfg, item) {\n    var group = item.getContainer(); // 这里不传 cfg 参数是因为 cfg.style 需要最后覆盖样式\n\n    var defaultStyle = this.getOptions({}).style;\n    var path = this.getPath(cfg); // 下面这些属性需要覆盖默认样式与目前样式，但若在 cfg 中有指定则应该被 cfg 的相应配置覆盖。\n\n    var strokeStyle = {\n      stroke: cfg.color,\n      path: path\n    }; // 与 getShapeStyle 不同在于，update 时需要获取到当前的 style 进行融合。即新传入的配置项中没有涉及的属性，保留当前的配置。\n\n    var keyShape = item.get('keyShape');\n    var style = mix({}, defaultStyle, keyShape.attr(), strokeStyle);\n    style = mix(style, cfg.style);\n    this.updateShape(cfg, item, style, true);\n    this.updateLinkPoints(cfg, group);\n  },\n\n  /**\r\n   * 更新linkPoints\r\n   * @param {Object} cfg 节点数据配置项\r\n   * @param {Group} group Item所在的group\r\n   */\n  updateLinkPoints: function updateLinkPoints(cfg, group) {\n    var defaultLinkPoints = this.getOptions({}).linkPoints;\n    var markLeft = group.find(function (element) {\n      return element.get('className') === 'link-point-left';\n    });\n    var markRight = group.find(function (element) {\n      return element.get('className') === 'link-point-right';\n    });\n    var markTop = group.find(function (element) {\n      return element.get('className') === 'link-point-top';\n    });\n    var markLeftBottom = group.find(function (element) {\n      return element.get('className') === 'link-point-left-bottom';\n    });\n    var markRightBottom = group.find(function (element) {\n      return element.get('className') === 'link-point-right-bottom';\n    });\n    var currentLinkPoints = defaultLinkPoints;\n    var existLinkPoint = markLeft || markRight || markTop || markLeftBottom || markRightBottom;\n\n    if (existLinkPoint) {\n      currentLinkPoints = existLinkPoint.attr();\n    }\n\n    var linkPoints = mix({}, currentLinkPoints, cfg.linkPoints);\n    var markFill = linkPoints.fill,\n        markStroke = linkPoints.stroke,\n        borderWidth = linkPoints.lineWidth;\n    var markSize = linkPoints.size / 2;\n    if (!markSize) markSize = linkPoints.r;\n\n    var _a = cfg.linkPoints ? cfg.linkPoints : {\n      left: undefined,\n      right: undefined,\n      top: undefined,\n      leftBottom: undefined,\n      rightBottom: undefined\n    },\n        left = _a.left,\n        right = _a.right,\n        top = _a.top,\n        leftBottom = _a.leftBottom,\n        rightBottom = _a.rightBottom;\n\n    var size = this.getSize(cfg);\n    var outerR = size[0];\n    var styles = {\n      r: markSize,\n      fill: markFill,\n      stroke: markStroke,\n      lineWidth: borderWidth\n    };\n    var x = Math.cos((18 + 72 * 0) / 180 * Math.PI) * outerR;\n    var y = Math.sin((18 + 72 * 0) / 180 * Math.PI) * outerR;\n\n    if (markRight) {\n      if (!right && right !== undefined) {\n        markRight.remove();\n      } else {\n        markRight.attr(__assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }));\n      }\n    } else if (right) {\n      group.addShape('circle', {\n        attrs: __assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }),\n        className: 'link-point-right',\n        name: 'link-point-right',\n        isAnchorPoint: true\n      });\n    }\n\n    x = Math.cos((18 + 72 * 1) / 180 * Math.PI) * outerR;\n    y = Math.sin((18 + 72 * 1) / 180 * Math.PI) * outerR;\n\n    if (markTop) {\n      if (!top && top !== undefined) {\n        markTop.remove();\n      } else {\n        markTop.attr(__assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }));\n      }\n    } else if (top) {\n      group.addShape('circle', {\n        attrs: __assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }),\n        className: 'link-point-top',\n        name: 'link-point-top',\n        isAnchorPoint: true\n      });\n    }\n\n    x = Math.cos((18 + 72 * 2) / 180 * Math.PI) * outerR;\n    y = Math.sin((18 + 72 * 2) / 180 * Math.PI) * outerR;\n\n    if (markLeft) {\n      if (!left && left !== undefined) {\n        markLeft.remove();\n      } else {\n        markLeft.attr(__assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }));\n      }\n    } else if (left) {\n      group.addShape('circle', {\n        attrs: __assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }),\n        className: 'link-point-left',\n        name: 'link-point-left',\n        isAnchorPoint: true\n      });\n    }\n\n    x = Math.cos((18 + 72 * 3) / 180 * Math.PI) * outerR;\n    y = Math.sin((18 + 72 * 3) / 180 * Math.PI) * outerR;\n\n    if (markLeftBottom) {\n      if (!leftBottom && leftBottom !== undefined) {\n        markLeftBottom.remove();\n      } else {\n        markLeftBottom.attr(__assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }));\n      }\n    } else if (leftBottom) {\n      group.addShape('circle', {\n        attrs: __assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }),\n        className: 'link-point-left-bottom',\n        name: 'link-point-left-bottom',\n        isAnchorPoint: true\n      });\n    }\n\n    x = Math.cos((18 + 72 * 4) / 180 * Math.PI) * outerR;\n    y = Math.sin((18 + 72 * 4) / 180 * Math.PI) * outerR;\n\n    if (markRightBottom) {\n      if (!rightBottom && rightBottom !== undefined) {\n        markLeftBottom.remove();\n      } else {\n        markRightBottom.attr(__assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }));\n      }\n    } else if (rightBottom) {\n      group.addShape('circle', {\n        attrs: __assign(__assign({}, styles), {\n          x: x,\n          y: -y\n        }),\n        className: 'link-point-right-bottom',\n        name: 'link-point-right-bottom',\n        isAnchorPoint: true\n      });\n    }\n  }\n}, 'single-node');","map":{"version":3,"sources":["E:/sqlindex2/sql/frontend/node_modules/@antv/g6-element/es/nodes/star.js"],"names":["__assign","__rest","registerNode","BaseGlobal","Global","mix","options","size","style","stroke","defaultNode","fill","lineWidth","labelCfg","nodeLabel","fontSize","linkPoints","top","right","bottom","left","icon","show","img","width","height","stateStyles","nodeStateStyles","shapeType","labelPosition","drawShape","cfg","group","_a","getOptions","getShapeStyle","keyShape","addShape","attrs","className","type","name","draggable","w","h","text","x","y","textBaseline","textAlign","drawLinkPoints","leftBottom","rightBottom","markSize","markR","r","markStyle","getSize","outerR","x1","Math","cos","PI","y1","sin","getPath","defaultInnerR","innerR","path","i","x2","y2","push","defaultStyle","strokeStyle","color","styles","update","item","getContainer","get","attr","updateShape","updateLinkPoints","defaultLinkPoints","markLeft","find","element","markRight","markTop","markLeftBottom","markRightBottom","currentLinkPoints","existLinkPoint","markFill","markStroke","borderWidth","undefined","remove","isAnchorPoint"],"mappings":"AAAA,SAASA,QAAT,EAAmBC,MAAnB,QAAiC,OAAjC;AACA,SAASC,YAAT,EAAuBC,UAAU,IAAIC,MAArC,QAAmD,eAAnD;AACA,SAASC,GAAT,QAAoB,YAApB,C,CAAkC;;AAElCH,YAAY,CAAC,MAAD,EAAS;AACnB;AACAI,EAAAA,OAAO,EAAE;AACPC,IAAAA,IAAI,EAAE,EADC;AAEPC,IAAAA,KAAK,EAAE;AACLC,MAAAA,MAAM,EAAEL,MAAM,CAACM,WAAP,CAAmBF,KAAnB,CAAyBC,MAD5B;AAELE,MAAAA,IAAI,EAAEP,MAAM,CAACM,WAAP,CAAmBF,KAAnB,CAAyBG,IAF1B;AAGLC,MAAAA,SAAS,EAAER,MAAM,CAACM,WAAP,CAAmBF,KAAnB,CAAyBI;AAH/B,KAFA;AAOPC,IAAAA,QAAQ,EAAE;AACRL,MAAAA,KAAK,EAAE;AACLG,QAAAA,IAAI,EAAEP,MAAM,CAACU,SAAP,CAAiBN,KAAjB,CAAuBG,IADxB;AAELI,QAAAA,QAAQ,EAAEX,MAAM,CAACU,SAAP,CAAiBN,KAAjB,CAAuBO;AAF5B;AADC,KAPH;AAaP;AACAC,IAAAA,UAAU,EAAE;AACVC,MAAAA,GAAG,EAAE,KADK;AAEVC,MAAAA,KAAK,EAAE,KAFG;AAGVC,MAAAA,MAAM,EAAE,KAHE;AAIVC,MAAAA,IAAI,EAAE,KAJI;AAKV;AACAb,MAAAA,IAAI,EAAEH,MAAM,CAACM,WAAP,CAAmBM,UAAnB,CAA8BT,IAN1B;AAOVK,MAAAA,SAAS,EAAER,MAAM,CAACM,WAAP,CAAmBM,UAAnB,CAA8BJ,SAP/B;AAQVD,MAAAA,IAAI,EAAEP,MAAM,CAACM,WAAP,CAAmBM,UAAnB,CAA8BL,IAR1B;AASVF,MAAAA,MAAM,EAAEL,MAAM,CAACM,WAAP,CAAmBM,UAAnB,CAA8BP;AAT5B,KAdL;AAyBP;AACAY,IAAAA,IAAI,EAAE;AACJ;AACAC,MAAAA,IAAI,EAAE,KAFF;AAGJ;AACAC,MAAAA,GAAG,EAAE,oFAJD;AAKJC,MAAAA,KAAK,EAAE,EALH;AAMJC,MAAAA,MAAM,EAAE;AANJ,KA1BC;AAkCPC,IAAAA,WAAW,EAAE1B,QAAQ,CAAC,EAAD,EAAKI,MAAM,CAACuB,eAAZ;AAlCd,GAFU;AAsCnBC,EAAAA,SAAS,EAAE,MAtCQ;AAuCnB;AACAC,EAAAA,aAAa,EAAE,QAxCI;AAyCnBC,EAAAA,SAAS,EAAE,SAASA,SAAT,CAAmBC,GAAnB,EAAwBC,KAAxB,EAA+B;AACxC,QAAIC,EAAE,GAAG,KAAKC,UAAL,CAAgBH,GAAhB,EAAqBV,IAA9B;AAAA,QACIA,IAAI,GAAGY,EAAE,KAAK,KAAK,CAAZ,GAAgB,EAAhB,GAAqBA,EADhC;AAEA,QAAIzB,KAAK,GAAG,KAAK2B,aAAL,CAAmBJ,GAAnB,CAAZ;AACA,QAAIK,QAAQ,GAAGJ,KAAK,CAACK,QAAN,CAAe,MAAf,EAAuB;AACpCC,MAAAA,KAAK,EAAE9B,KAD6B;AAEpC+B,MAAAA,SAAS,EAAE,KAAKC,IAAL,GAAY,WAFa;AAGpCC,MAAAA,IAAI,EAAE,KAAKD,IAAL,GAAY,WAHkB;AAIpCE,MAAAA,SAAS,EAAE;AAJyB,KAAvB,CAAf;AAMA,QAAIC,CAAC,GAAGtB,IAAI,CAACG,KAAb;AAAA,QACIoB,CAAC,GAAGvB,IAAI,CAACI,MADb;AAAA,QAEIH,IAAI,GAAGD,IAAI,CAACC,IAFhB;AAAA,QAGIuB,IAAI,GAAGxB,IAAI,CAACwB,IAHhB;;AAKA,QAAIvB,IAAJ,EAAU;AACR,UAAIuB,IAAJ,EAAU;AACRb,QAAAA,KAAK,CAACK,QAAN,CAAe,MAAf,EAAuB;AACrBC,UAAAA,KAAK,EAAEtC,QAAQ,CAAC;AACd8C,YAAAA,CAAC,EAAE,CADW;AAEdC,YAAAA,CAAC,EAAE,CAFW;AAGdhC,YAAAA,QAAQ,EAAE,EAHI;AAIdJ,YAAAA,IAAI,EAAE,MAJQ;AAKdF,YAAAA,MAAM,EAAE,MALM;AAMduC,YAAAA,YAAY,EAAE,QANA;AAOdC,YAAAA,SAAS,EAAE;AAPG,WAAD,EAQZ5B,IARY,CADM;AAUrBkB,UAAAA,SAAS,EAAE,KAAKC,IAAL,GAAY,OAVF;AAWrBC,UAAAA,IAAI,EAAE,KAAKD,IAAL,GAAY,OAXG;AAYrBE,UAAAA,SAAS,EAAE;AAZU,SAAvB;AAcD,OAfD,MAeO;AACLV,QAAAA,KAAK,CAACK,QAAN,CAAe,OAAf,EAAwB;AACtBC,UAAAA,KAAK,EAAEtC,QAAQ,CAAC;AACd8C,YAAAA,CAAC,EAAE,CAACH,CAAD,GAAK,CADM;AAEdI,YAAAA,CAAC,EAAE,CAACH,CAAD,GAAK;AAFM,WAAD,EAGZvB,IAHY,CADO;AAKtBkB,UAAAA,SAAS,EAAE,KAAKC,IAAL,GAAY,OALD;AAMtBC,UAAAA,IAAI,EAAE,KAAKD,IAAL,GAAY,OANI;AAOtBE,UAAAA,SAAS,EAAE;AAPW,SAAxB;AASD;AACF;;AAED,SAAKQ,cAAL,CAAoBnB,GAApB,EAAyBC,KAAzB;AACA,WAAOI,QAAP;AACD,GAvFkB;;AAyFnB;AACF;AACA;AACA;AACA;AACEc,EAAAA,cAAc,EAAE,SAASA,cAAT,CAAwBnB,GAAxB,EAA6BC,KAA7B,EAAoC;AAClD,QAAIC,EAAE,GAAG,KAAKC,UAAL,CAAgBH,GAAhB,EAAqBf,UAA9B;AAAA,QACIA,UAAU,GAAGiB,EAAE,KAAK,KAAK,CAAZ,GAAgB,EAAhB,GAAqBA,EADtC;;AAGA,QAAIhB,GAAG,GAAGD,UAAU,CAACC,GAArB;AAAA,QACIG,IAAI,GAAGJ,UAAU,CAACI,IADtB;AAAA,QAEIF,KAAK,GAAGF,UAAU,CAACE,KAFvB;AAAA,QAGIiC,UAAU,GAAGnC,UAAU,CAACmC,UAH5B;AAAA,QAIIC,WAAW,GAAGpC,UAAU,CAACoC,WAJ7B;AAAA,QAKIC,QAAQ,GAAGrC,UAAU,CAACT,IAL1B;AAAA,QAMI+C,KAAK,GAAGtC,UAAU,CAACuC,CANvB;AAAA,QAOIC,SAAS,GAAGvD,MAAM,CAACe,UAAD,EAAa,CAAC,KAAD,EAAQ,MAAR,EAAgB,OAAhB,EAAyB,YAAzB,EAAuC,aAAvC,EAAsD,MAAtD,EAA8D,GAA9D,CAAb,CAPtB;;AASA,QAAIT,IAAI,GAAG,KAAKkD,OAAL,CAAa1B,GAAb,CAAX;AACA,QAAI2B,MAAM,GAAGnD,IAAI,CAAC,CAAD,CAAjB;;AAEA,QAAIW,KAAJ,EAAW;AACT;AACA;AACA,UAAIyC,EAAE,GAAGC,IAAI,CAACC,GAAL,CAAS,CAAC,KAAK,KAAK,CAAX,IAAgB,GAAhB,GAAsBD,IAAI,CAACE,EAApC,IAA0CJ,MAAnD;AACA,UAAIK,EAAE,GAAGH,IAAI,CAACI,GAAL,CAAS,CAAC,KAAK,KAAK,CAAX,IAAgB,GAAhB,GAAsBJ,IAAI,CAACE,EAApC,IAA0CJ,MAAnD;AACA1B,MAAAA,KAAK,CAACK,QAAN,CAAe,QAAf,EAAyB;AACvBC,QAAAA,KAAK,EAAEtC,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKwD,SAAL,CAAT,EAA0B;AACvCV,UAAAA,CAAC,EAAEa,EADoC;AAEvCZ,UAAAA,CAAC,EAAE,CAACgB,EAFmC;AAGvCR,UAAAA,CAAC,EAAEF,QAAQ,GAAG,CAAX,IAAgBC,KAAhB,IAAyB;AAHW,SAA1B,CADQ;AAMvBf,QAAAA,SAAS,EAAE,kBANY;AAOvBE,QAAAA,IAAI,EAAE;AAPiB,OAAzB;AASD;;AAED,QAAIxB,GAAJ,EAAS;AACP;AACA,UAAI0C,EAAE,GAAGC,IAAI,CAACC,GAAL,CAAS,CAAC,KAAK,KAAK,CAAX,IAAgB,GAAhB,GAAsBD,IAAI,CAACE,EAApC,IAA0CJ,MAAnD;AACA,UAAIK,EAAE,GAAGH,IAAI,CAACI,GAAL,CAAS,CAAC,KAAK,KAAK,CAAX,IAAgB,GAAhB,GAAsBJ,IAAI,CAACE,EAApC,IAA0CJ,MAAnD,CAHO,CAGoD;;AAE3D1B,MAAAA,KAAK,CAACK,QAAN,CAAe,QAAf,EAAyB;AACvBC,QAAAA,KAAK,EAAEtC,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKwD,SAAL,CAAT,EAA0B;AACvCV,UAAAA,CAAC,EAAEa,EADoC;AAEvCZ,UAAAA,CAAC,EAAE,CAACgB,EAFmC;AAGvCR,UAAAA,CAAC,EAAEF,QAAQ,GAAG,CAAX,IAAgBC,KAAhB,IAAyB;AAHW,SAA1B,CADQ;AAMvBf,QAAAA,SAAS,EAAE,gBANY;AAOvBE,QAAAA,IAAI,EAAE;AAPiB,OAAzB;AASD;;AAED,QAAIrB,IAAJ,EAAU;AACR;AACA,UAAIuC,EAAE,GAAGC,IAAI,CAACC,GAAL,CAAS,CAAC,KAAK,KAAK,CAAX,IAAgB,GAAhB,GAAsBD,IAAI,CAACE,EAApC,IAA0CJ,MAAnD;AACA,UAAIK,EAAE,GAAGH,IAAI,CAACI,GAAL,CAAS,CAAC,KAAK,KAAK,CAAX,IAAgB,GAAhB,GAAsBJ,IAAI,CAACE,EAApC,IAA0CJ,MAAnD,CAHQ,CAGmD;;AAE3D1B,MAAAA,KAAK,CAACK,QAAN,CAAe,QAAf,EAAyB;AACvBC,QAAAA,KAAK,EAAEtC,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKwD,SAAL,CAAT,EAA0B;AACvCV,UAAAA,CAAC,EAAEa,EADoC;AAEvCZ,UAAAA,CAAC,EAAE,CAACgB,EAFmC;AAGvCR,UAAAA,CAAC,EAAEF,QAAQ,GAAG,CAAX,IAAgBC,KAAhB,IAAyB;AAHW,SAA1B,CADQ;AAMvBf,QAAAA,SAAS,EAAE,iBANY;AAOvBE,QAAAA,IAAI,EAAE;AAPiB,OAAzB;AASD;;AAED,QAAIU,UAAJ,EAAgB;AACd;AACA,UAAIQ,EAAE,GAAGC,IAAI,CAACC,GAAL,CAAS,CAAC,KAAK,KAAK,CAAX,IAAgB,GAAhB,GAAsBD,IAAI,CAACE,EAApC,IAA0CJ,MAAnD;AACA,UAAIK,EAAE,GAAGH,IAAI,CAACI,GAAL,CAAS,CAAC,KAAK,KAAK,CAAX,IAAgB,GAAhB,GAAsBJ,IAAI,CAACE,EAApC,IAA0CJ,MAAnD,CAHc,CAG6C;;AAE3D1B,MAAAA,KAAK,CAACK,QAAN,CAAe,QAAf,EAAyB;AACvBC,QAAAA,KAAK,EAAEtC,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKwD,SAAL,CAAT,EAA0B;AACvCV,UAAAA,CAAC,EAAEa,EADoC;AAEvCZ,UAAAA,CAAC,EAAE,CAACgB,EAFmC;AAGvCR,UAAAA,CAAC,EAAEF,QAAQ,GAAG,CAAX,IAAgBC,KAAhB,IAAyB;AAHW,SAA1B,CADQ;AAMvBf,QAAAA,SAAS,EAAE,wBANY;AAOvBE,QAAAA,IAAI,EAAE;AAPiB,OAAzB;AASD;;AAED,QAAIW,WAAJ,EAAiB;AACf;AACA,UAAIO,EAAE,GAAGC,IAAI,CAACC,GAAL,CAAS,CAAC,KAAK,KAAK,CAAX,IAAgB,GAAhB,GAAsBD,IAAI,CAACE,EAApC,IAA0CJ,MAAnD;AACA,UAAIK,EAAE,GAAGH,IAAI,CAACI,GAAL,CAAS,CAAC,KAAK,KAAK,CAAX,IAAgB,GAAhB,GAAsBJ,IAAI,CAACE,EAApC,IAA0CJ,MAAnD,CAHe,CAG4C;;AAE3D1B,MAAAA,KAAK,CAACK,QAAN,CAAe,QAAf,EAAyB;AACvBC,QAAAA,KAAK,EAAEtC,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAKwD,SAAL,CAAT,EAA0B;AACvCV,UAAAA,CAAC,EAAEa,EADoC;AAEvCZ,UAAAA,CAAC,EAAE,CAACgB,EAFmC;AAGvCR,UAAAA,CAAC,EAAEF,QAAQ,GAAG,CAAX,IAAgBC,KAAhB,IAAyB;AAHW,SAA1B,CADQ;AAMvBf,QAAAA,SAAS,EAAE,yBANY;AAOvBE,QAAAA,IAAI,EAAE;AAPiB,OAAzB;AASD;AACF,GA7LkB;AA8LnBwB,EAAAA,OAAO,EAAE,SAASA,OAAT,CAAiBlC,GAAjB,EAAsB;AAC7B,QAAIxB,IAAI,GAAG,KAAKkD,OAAL,CAAa1B,GAAb,CAAX;AACA,QAAI2B,MAAM,GAAGnD,IAAI,CAAC,CAAD,CAAjB;AACA,QAAI2D,aAAa,GAAGR,MAAM,GAAG,CAAT,GAAa,CAAjC;AACA,QAAIS,MAAM,GAAGpC,GAAG,CAACoC,MAAJ,IAAcD,aAA3B;AACA,QAAIE,IAAI,GAAG,EAAX;;AAEA,SAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,CAApB,EAAuBA,CAAC,EAAxB,EAA4B;AAC1B,UAAIV,EAAE,GAAGC,IAAI,CAACC,GAAL,CAAS,CAAC,KAAK,KAAKQ,CAAX,IAAgB,GAAhB,GAAsBT,IAAI,CAACE,EAApC,IAA0CJ,MAAnD;AACA,UAAIK,EAAE,GAAGH,IAAI,CAACI,GAAL,CAAS,CAAC,KAAK,KAAKK,CAAX,IAAgB,GAAhB,GAAsBT,IAAI,CAACE,EAApC,IAA0CJ,MAAnD;AACA,UAAIY,EAAE,GAAGV,IAAI,CAACC,GAAL,CAAS,CAAC,KAAK,KAAKQ,CAAX,IAAgB,GAAhB,GAAsBT,IAAI,CAACE,EAApC,IAA0CK,MAAnD;AACA,UAAII,EAAE,GAAGX,IAAI,CAACI,GAAL,CAAS,CAAC,KAAK,KAAKK,CAAX,IAAgB,GAAhB,GAAsBT,IAAI,CAACE,EAApC,IAA0CK,MAAnD;;AAEA,UAAIE,CAAC,KAAK,CAAV,EAAa;AACXD,QAAAA,IAAI,CAACI,IAAL,CAAU,CAAC,GAAD,EAAMb,EAAN,EAAU,CAACI,EAAX,CAAV;AACD,OAFD,MAEO;AACLK,QAAAA,IAAI,CAACI,IAAL,CAAU,CAAC,GAAD,EAAMb,EAAN,EAAU,CAACI,EAAX,CAAV;AACD;;AAEDK,MAAAA,IAAI,CAACI,IAAL,CAAU,CAAC,GAAD,EAAMF,EAAN,EAAU,CAACC,EAAX,CAAV;AACD;;AAEDH,IAAAA,IAAI,CAACI,IAAL,CAAU,CAAC,GAAD,CAAV;AACA,WAAOJ,IAAP;AACD,GAtNkB;;AAwNnB;AACF;AACA;AACA;AACA;AACEjC,EAAAA,aAAa,EAAE,SAASA,aAAT,CAAuBJ,GAAvB,EAA4B;AACzC,QAAI0C,YAAY,GAAG,KAAKvC,UAAL,CAAgBH,GAAhB,EAAqBvB,KAAxC;AACA,QAAIkE,WAAW,GAAG;AAChBjE,MAAAA,MAAM,EAAEsB,GAAG,CAAC4C;AADI,KAAlB,CAFyC,CAItC;;AAEH,QAAInE,KAAK,GAAGH,GAAG,CAAC,EAAD,EAAKoE,YAAL,EAAmBC,WAAnB,CAAf;AACA,QAAIN,IAAI,GAAG,KAAKH,OAAL,CAAalC,GAAb,CAAX;;AAEA,QAAI6C,MAAM,GAAG5E,QAAQ,CAAC;AACpBoE,MAAAA,IAAI,EAAEA;AADc,KAAD,EAElB5D,KAFkB,CAArB;;AAIA,WAAOoE,MAAP;AACD,GA3OkB;AA4OnBC,EAAAA,MAAM,EAAE,SAASA,MAAT,CAAgB9C,GAAhB,EAAqB+C,IAArB,EAA2B;AACjC,QAAI9C,KAAK,GAAG8C,IAAI,CAACC,YAAL,EAAZ,CADiC,CACA;;AAEjC,QAAIN,YAAY,GAAG,KAAKvC,UAAL,CAAgB,EAAhB,EAAoB1B,KAAvC;AACA,QAAI4D,IAAI,GAAG,KAAKH,OAAL,CAAalC,GAAb,CAAX,CAJiC,CAIH;;AAE9B,QAAI2C,WAAW,GAAG;AAChBjE,MAAAA,MAAM,EAAEsB,GAAG,CAAC4C,KADI;AAEhBP,MAAAA,IAAI,EAAEA;AAFU,KAAlB,CANiC,CAS9B;;AAEH,QAAIhC,QAAQ,GAAG0C,IAAI,CAACE,GAAL,CAAS,UAAT,CAAf;AACA,QAAIxE,KAAK,GAAGH,GAAG,CAAC,EAAD,EAAKoE,YAAL,EAAmBrC,QAAQ,CAAC6C,IAAT,EAAnB,EAAoCP,WAApC,CAAf;AACAlE,IAAAA,KAAK,GAAGH,GAAG,CAACG,KAAD,EAAQuB,GAAG,CAACvB,KAAZ,CAAX;AACA,SAAK0E,WAAL,CAAiBnD,GAAjB,EAAsB+C,IAAtB,EAA4BtE,KAA5B,EAAmC,IAAnC;AACA,SAAK2E,gBAAL,CAAsBpD,GAAtB,EAA2BC,KAA3B;AACD,GA5PkB;;AA8PnB;AACF;AACA;AACA;AACA;AACEmD,EAAAA,gBAAgB,EAAE,SAASA,gBAAT,CAA0BpD,GAA1B,EAA+BC,KAA/B,EAAsC;AACtD,QAAIoD,iBAAiB,GAAG,KAAKlD,UAAL,CAAgB,EAAhB,EAAoBlB,UAA5C;AACA,QAAIqE,QAAQ,GAAGrD,KAAK,CAACsD,IAAN,CAAW,UAAUC,OAAV,EAAmB;AAC3C,aAAOA,OAAO,CAACP,GAAR,CAAY,WAAZ,MAA6B,iBAApC;AACD,KAFc,CAAf;AAGA,QAAIQ,SAAS,GAAGxD,KAAK,CAACsD,IAAN,CAAW,UAAUC,OAAV,EAAmB;AAC5C,aAAOA,OAAO,CAACP,GAAR,CAAY,WAAZ,MAA6B,kBAApC;AACD,KAFe,CAAhB;AAGA,QAAIS,OAAO,GAAGzD,KAAK,CAACsD,IAAN,CAAW,UAAUC,OAAV,EAAmB;AAC1C,aAAOA,OAAO,CAACP,GAAR,CAAY,WAAZ,MAA6B,gBAApC;AACD,KAFa,CAAd;AAGA,QAAIU,cAAc,GAAG1D,KAAK,CAACsD,IAAN,CAAW,UAAUC,OAAV,EAAmB;AACjD,aAAOA,OAAO,CAACP,GAAR,CAAY,WAAZ,MAA6B,wBAApC;AACD,KAFoB,CAArB;AAGA,QAAIW,eAAe,GAAG3D,KAAK,CAACsD,IAAN,CAAW,UAAUC,OAAV,EAAmB;AAClD,aAAOA,OAAO,CAACP,GAAR,CAAY,WAAZ,MAA6B,yBAApC;AACD,KAFqB,CAAtB;AAGA,QAAIY,iBAAiB,GAAGR,iBAAxB;AACA,QAAIS,cAAc,GAAGR,QAAQ,IAAIG,SAAZ,IAAyBC,OAAzB,IAAoCC,cAApC,IAAsDC,eAA3E;;AAEA,QAAIE,cAAJ,EAAoB;AAClBD,MAAAA,iBAAiB,GAAGC,cAAc,CAACZ,IAAf,EAApB;AACD;;AAED,QAAIjE,UAAU,GAAGX,GAAG,CAAC,EAAD,EAAKuF,iBAAL,EAAwB7D,GAAG,CAACf,UAA5B,CAApB;AACA,QAAI8E,QAAQ,GAAG9E,UAAU,CAACL,IAA1B;AAAA,QACIoF,UAAU,GAAG/E,UAAU,CAACP,MAD5B;AAAA,QAEIuF,WAAW,GAAGhF,UAAU,CAACJ,SAF7B;AAGA,QAAIyC,QAAQ,GAAGrC,UAAU,CAACT,IAAX,GAAkB,CAAjC;AACA,QAAI,CAAC8C,QAAL,EAAeA,QAAQ,GAAGrC,UAAU,CAACuC,CAAtB;;AAEf,QAAItB,EAAE,GAAGF,GAAG,CAACf,UAAJ,GAAiBe,GAAG,CAACf,UAArB,GAAkC;AACzCI,MAAAA,IAAI,EAAE6E,SADmC;AAEzC/E,MAAAA,KAAK,EAAE+E,SAFkC;AAGzChF,MAAAA,GAAG,EAAEgF,SAHoC;AAIzC9C,MAAAA,UAAU,EAAE8C,SAJ6B;AAKzC7C,MAAAA,WAAW,EAAE6C;AAL4B,KAA3C;AAAA,QAOI7E,IAAI,GAAGa,EAAE,CAACb,IAPd;AAAA,QAQIF,KAAK,GAAGe,EAAE,CAACf,KARf;AAAA,QASID,GAAG,GAAGgB,EAAE,CAAChB,GATb;AAAA,QAUIkC,UAAU,GAAGlB,EAAE,CAACkB,UAVpB;AAAA,QAWIC,WAAW,GAAGnB,EAAE,CAACmB,WAXrB;;AAaA,QAAI7C,IAAI,GAAG,KAAKkD,OAAL,CAAa1B,GAAb,CAAX;AACA,QAAI2B,MAAM,GAAGnD,IAAI,CAAC,CAAD,CAAjB;AACA,QAAIqE,MAAM,GAAG;AACXrB,MAAAA,CAAC,EAAEF,QADQ;AAEX1C,MAAAA,IAAI,EAAEmF,QAFK;AAGXrF,MAAAA,MAAM,EAAEsF,UAHG;AAIXnF,MAAAA,SAAS,EAAEoF;AAJA,KAAb;AAMA,QAAIlD,CAAC,GAAGc,IAAI,CAACC,GAAL,CAAS,CAAC,KAAK,KAAK,CAAX,IAAgB,GAAhB,GAAsBD,IAAI,CAACE,EAApC,IAA0CJ,MAAlD;AACA,QAAIX,CAAC,GAAGa,IAAI,CAACI,GAAL,CAAS,CAAC,KAAK,KAAK,CAAX,IAAgB,GAAhB,GAAsBJ,IAAI,CAACE,EAApC,IAA0CJ,MAAlD;;AAEA,QAAI8B,SAAJ,EAAe;AACb,UAAI,CAACtE,KAAD,IAAUA,KAAK,KAAK+E,SAAxB,EAAmC;AACjCT,QAAAA,SAAS,CAACU,MAAV;AACD,OAFD,MAEO;AACLV,QAAAA,SAAS,CAACP,IAAV,CAAejF,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAK4E,MAAL,CAAT,EAAuB;AAC5C9B,UAAAA,CAAC,EAAEA,CADyC;AAE5CC,UAAAA,CAAC,EAAE,CAACA;AAFwC,SAAvB,CAAvB;AAID;AACF,KATD,MASO,IAAI7B,KAAJ,EAAW;AAChBc,MAAAA,KAAK,CAACK,QAAN,CAAe,QAAf,EAAyB;AACvBC,QAAAA,KAAK,EAAEtC,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAK4E,MAAL,CAAT,EAAuB;AACpC9B,UAAAA,CAAC,EAAEA,CADiC;AAEpCC,UAAAA,CAAC,EAAE,CAACA;AAFgC,SAAvB,CADQ;AAKvBR,QAAAA,SAAS,EAAE,kBALY;AAMvBE,QAAAA,IAAI,EAAE,kBANiB;AAOvB0D,QAAAA,aAAa,EAAE;AAPQ,OAAzB;AASD;;AAEDrD,IAAAA,CAAC,GAAGc,IAAI,CAACC,GAAL,CAAS,CAAC,KAAK,KAAK,CAAX,IAAgB,GAAhB,GAAsBD,IAAI,CAACE,EAApC,IAA0CJ,MAA9C;AACAX,IAAAA,CAAC,GAAGa,IAAI,CAACI,GAAL,CAAS,CAAC,KAAK,KAAK,CAAX,IAAgB,GAAhB,GAAsBJ,IAAI,CAACE,EAApC,IAA0CJ,MAA9C;;AAEA,QAAI+B,OAAJ,EAAa;AACX,UAAI,CAACxE,GAAD,IAAQA,GAAG,KAAKgF,SAApB,EAA+B;AAC7BR,QAAAA,OAAO,CAACS,MAAR;AACD,OAFD,MAEO;AACLT,QAAAA,OAAO,CAACR,IAAR,CAAajF,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAK4E,MAAL,CAAT,EAAuB;AAC1C9B,UAAAA,CAAC,EAAEA,CADuC;AAE1CC,UAAAA,CAAC,EAAE,CAACA;AAFsC,SAAvB,CAArB;AAID;AACF,KATD,MASO,IAAI9B,GAAJ,EAAS;AACde,MAAAA,KAAK,CAACK,QAAN,CAAe,QAAf,EAAyB;AACvBC,QAAAA,KAAK,EAAEtC,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAK4E,MAAL,CAAT,EAAuB;AACpC9B,UAAAA,CAAC,EAAEA,CADiC;AAEpCC,UAAAA,CAAC,EAAE,CAACA;AAFgC,SAAvB,CADQ;AAKvBR,QAAAA,SAAS,EAAE,gBALY;AAMvBE,QAAAA,IAAI,EAAE,gBANiB;AAOvB0D,QAAAA,aAAa,EAAE;AAPQ,OAAzB;AASD;;AAEDrD,IAAAA,CAAC,GAAGc,IAAI,CAACC,GAAL,CAAS,CAAC,KAAK,KAAK,CAAX,IAAgB,GAAhB,GAAsBD,IAAI,CAACE,EAApC,IAA0CJ,MAA9C;AACAX,IAAAA,CAAC,GAAGa,IAAI,CAACI,GAAL,CAAS,CAAC,KAAK,KAAK,CAAX,IAAgB,GAAhB,GAAsBJ,IAAI,CAACE,EAApC,IAA0CJ,MAA9C;;AAEA,QAAI2B,QAAJ,EAAc;AACZ,UAAI,CAACjE,IAAD,IAASA,IAAI,KAAK6E,SAAtB,EAAiC;AAC/BZ,QAAAA,QAAQ,CAACa,MAAT;AACD,OAFD,MAEO;AACLb,QAAAA,QAAQ,CAACJ,IAAT,CAAcjF,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAK4E,MAAL,CAAT,EAAuB;AAC3C9B,UAAAA,CAAC,EAAEA,CADwC;AAE3CC,UAAAA,CAAC,EAAE,CAACA;AAFuC,SAAvB,CAAtB;AAID;AACF,KATD,MASO,IAAI3B,IAAJ,EAAU;AACfY,MAAAA,KAAK,CAACK,QAAN,CAAe,QAAf,EAAyB;AACvBC,QAAAA,KAAK,EAAEtC,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAK4E,MAAL,CAAT,EAAuB;AACpC9B,UAAAA,CAAC,EAAEA,CADiC;AAEpCC,UAAAA,CAAC,EAAE,CAACA;AAFgC,SAAvB,CADQ;AAKvBR,QAAAA,SAAS,EAAE,iBALY;AAMvBE,QAAAA,IAAI,EAAE,iBANiB;AAOvB0D,QAAAA,aAAa,EAAE;AAPQ,OAAzB;AASD;;AAEDrD,IAAAA,CAAC,GAAGc,IAAI,CAACC,GAAL,CAAS,CAAC,KAAK,KAAK,CAAX,IAAgB,GAAhB,GAAsBD,IAAI,CAACE,EAApC,IAA0CJ,MAA9C;AACAX,IAAAA,CAAC,GAAGa,IAAI,CAACI,GAAL,CAAS,CAAC,KAAK,KAAK,CAAX,IAAgB,GAAhB,GAAsBJ,IAAI,CAACE,EAApC,IAA0CJ,MAA9C;;AAEA,QAAIgC,cAAJ,EAAoB;AAClB,UAAI,CAACvC,UAAD,IAAeA,UAAU,KAAK8C,SAAlC,EAA6C;AAC3CP,QAAAA,cAAc,CAACQ,MAAf;AACD,OAFD,MAEO;AACLR,QAAAA,cAAc,CAACT,IAAf,CAAoBjF,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAK4E,MAAL,CAAT,EAAuB;AACjD9B,UAAAA,CAAC,EAAEA,CAD8C;AAEjDC,UAAAA,CAAC,EAAE,CAACA;AAF6C,SAAvB,CAA5B;AAID;AACF,KATD,MASO,IAAII,UAAJ,EAAgB;AACrBnB,MAAAA,KAAK,CAACK,QAAN,CAAe,QAAf,EAAyB;AACvBC,QAAAA,KAAK,EAAEtC,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAK4E,MAAL,CAAT,EAAuB;AACpC9B,UAAAA,CAAC,EAAEA,CADiC;AAEpCC,UAAAA,CAAC,EAAE,CAACA;AAFgC,SAAvB,CADQ;AAKvBR,QAAAA,SAAS,EAAE,wBALY;AAMvBE,QAAAA,IAAI,EAAE,wBANiB;AAOvB0D,QAAAA,aAAa,EAAE;AAPQ,OAAzB;AASD;;AAEDrD,IAAAA,CAAC,GAAGc,IAAI,CAACC,GAAL,CAAS,CAAC,KAAK,KAAK,CAAX,IAAgB,GAAhB,GAAsBD,IAAI,CAACE,EAApC,IAA0CJ,MAA9C;AACAX,IAAAA,CAAC,GAAGa,IAAI,CAACI,GAAL,CAAS,CAAC,KAAK,KAAK,CAAX,IAAgB,GAAhB,GAAsBJ,IAAI,CAACE,EAApC,IAA0CJ,MAA9C;;AAEA,QAAIiC,eAAJ,EAAqB;AACnB,UAAI,CAACvC,WAAD,IAAgBA,WAAW,KAAK6C,SAApC,EAA+C;AAC7CP,QAAAA,cAAc,CAACQ,MAAf;AACD,OAFD,MAEO;AACLP,QAAAA,eAAe,CAACV,IAAhB,CAAqBjF,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAK4E,MAAL,CAAT,EAAuB;AAClD9B,UAAAA,CAAC,EAAEA,CAD+C;AAElDC,UAAAA,CAAC,EAAE,CAACA;AAF8C,SAAvB,CAA7B;AAID;AACF,KATD,MASO,IAAIK,WAAJ,EAAiB;AACtBpB,MAAAA,KAAK,CAACK,QAAN,CAAe,QAAf,EAAyB;AACvBC,QAAAA,KAAK,EAAEtC,QAAQ,CAACA,QAAQ,CAAC,EAAD,EAAK4E,MAAL,CAAT,EAAuB;AACpC9B,UAAAA,CAAC,EAAEA,CADiC;AAEpCC,UAAAA,CAAC,EAAE,CAACA;AAFgC,SAAvB,CADQ;AAKvBR,QAAAA,SAAS,EAAE,yBALY;AAMvBE,QAAAA,IAAI,EAAE,yBANiB;AAOvB0D,QAAAA,aAAa,EAAE;AAPQ,OAAzB;AASD;AACF;AA9akB,CAAT,EA+aT,aA/aS,CAAZ","sourcesContent":["import { __assign, __rest } from \"tslib\";\r\nimport { registerNode, BaseGlobal as Global } from '@antv/g6-core';\r\nimport { mix } from '@antv/util'; // 五角星shape\r\n\r\nregisterNode('star', {\r\n  // 自定义节点时的配置\r\n  options: {\r\n    size: 60,\r\n    style: {\r\n      stroke: Global.defaultNode.style.stroke,\r\n      fill: Global.defaultNode.style.fill,\r\n      lineWidth: Global.defaultNode.style.lineWidth\r\n    },\r\n    labelCfg: {\r\n      style: {\r\n        fill: Global.nodeLabel.style.fill,\r\n        fontSize: Global.nodeLabel.style.fontSize\r\n      }\r\n    },\r\n    // 节点上左右上下四个方向上的链接circle配置\r\n    linkPoints: {\r\n      top: false,\r\n      right: false,\r\n      bottom: false,\r\n      left: false,\r\n      // circle的大小\r\n      size: Global.defaultNode.linkPoints.size,\r\n      lineWidth: Global.defaultNode.linkPoints.lineWidth,\r\n      fill: Global.defaultNode.linkPoints.fill,\r\n      stroke: Global.defaultNode.linkPoints.stroke\r\n    },\r\n    // 节点中icon配置\r\n    icon: {\r\n      // 是否显示icon，值为 false 则不渲染icon\r\n      show: false,\r\n      // icon的地址，字符串类型\r\n      img: 'https://gw.alipayobjects.com/zos/bmw-prod/5d015065-8505-4e7a-baec-976f81e3c41d.svg',\r\n      width: 20,\r\n      height: 20\r\n    },\r\n    stateStyles: __assign({}, Global.nodeStateStyles)\r\n  },\r\n  shapeType: 'star',\r\n  // 文本位置\r\n  labelPosition: 'center',\r\n  drawShape: function drawShape(cfg, group) {\r\n    var _a = this.getOptions(cfg).icon,\r\n        icon = _a === void 0 ? {} : _a;\r\n    var style = this.getShapeStyle(cfg);\r\n    var keyShape = group.addShape('path', {\r\n      attrs: style,\r\n      className: this.type + \"-keyShape\",\r\n      name: this.type + \"-keyShape\",\r\n      draggable: true\r\n    });\r\n    var w = icon.width,\r\n        h = icon.height,\r\n        show = icon.show,\r\n        text = icon.text;\r\n\r\n    if (show) {\r\n      if (text) {\r\n        group.addShape('text', {\r\n          attrs: __assign({\r\n            x: 0,\r\n            y: 0,\r\n            fontSize: 12,\r\n            fill: '#000',\r\n            stroke: '#000',\r\n            textBaseline: 'middle',\r\n            textAlign: 'center'\r\n          }, icon),\r\n          className: this.type + \"-icon\",\r\n          name: this.type + \"-icon\",\r\n          draggable: true\r\n        });\r\n      } else {\r\n        group.addShape('image', {\r\n          attrs: __assign({\r\n            x: -w / 2,\r\n            y: -h / 2\r\n          }, icon),\r\n          className: this.type + \"-icon\",\r\n          name: this.type + \"-icon\",\r\n          draggable: true\r\n        });\r\n      }\r\n    }\r\n\r\n    this.drawLinkPoints(cfg, group);\r\n    return keyShape;\r\n  },\r\n\r\n  /**\r\n   * 绘制节点上的LinkPoints\r\n   * @param {Object} cfg data数据配置项\r\n   * @param {Group} group Group实例\r\n   */\r\n  drawLinkPoints: function drawLinkPoints(cfg, group) {\r\n    var _a = this.getOptions(cfg).linkPoints,\r\n        linkPoints = _a === void 0 ? {} : _a;\r\n\r\n    var top = linkPoints.top,\r\n        left = linkPoints.left,\r\n        right = linkPoints.right,\r\n        leftBottom = linkPoints.leftBottom,\r\n        rightBottom = linkPoints.rightBottom,\r\n        markSize = linkPoints.size,\r\n        markR = linkPoints.r,\r\n        markStyle = __rest(linkPoints, [\"top\", \"left\", \"right\", \"leftBottom\", \"rightBottom\", \"size\", \"r\"]);\r\n\r\n    var size = this.getSize(cfg);\r\n    var outerR = size[0];\r\n\r\n    if (right) {\r\n      // right circle\r\n      // up down left right 四个方向的坐标均不相同\r\n      var x1 = Math.cos((18 + 72 * 0) / 180 * Math.PI) * outerR;\r\n      var y1 = Math.sin((18 + 72 * 0) / 180 * Math.PI) * outerR;\r\n      group.addShape('circle', {\r\n        attrs: __assign(__assign({}, markStyle), {\r\n          x: x1,\r\n          y: -y1,\r\n          r: markSize / 2 || markR || 5\r\n        }),\r\n        className: 'link-point-right',\r\n        name: 'link-point-right'\r\n      });\r\n    }\r\n\r\n    if (top) {\r\n      // up down left right 四个方向的坐标均不相同\r\n      var x1 = Math.cos((18 + 72 * 1) / 180 * Math.PI) * outerR;\r\n      var y1 = Math.sin((18 + 72 * 1) / 180 * Math.PI) * outerR; // top circle\r\n\r\n      group.addShape('circle', {\r\n        attrs: __assign(__assign({}, markStyle), {\r\n          x: x1,\r\n          y: -y1,\r\n          r: markSize / 2 || markR || 5\r\n        }),\r\n        className: 'link-point-top',\r\n        name: 'link-point-top'\r\n      });\r\n    }\r\n\r\n    if (left) {\r\n      // up down left right 四个方向的坐标均不相同\r\n      var x1 = Math.cos((18 + 72 * 2) / 180 * Math.PI) * outerR;\r\n      var y1 = Math.sin((18 + 72 * 2) / 180 * Math.PI) * outerR; // left circle\r\n\r\n      group.addShape('circle', {\r\n        attrs: __assign(__assign({}, markStyle), {\r\n          x: x1,\r\n          y: -y1,\r\n          r: markSize / 2 || markR || 5\r\n        }),\r\n        className: 'link-point-left',\r\n        name: 'link-point-left'\r\n      });\r\n    }\r\n\r\n    if (leftBottom) {\r\n      // up down left right 四个方向的坐标均不相同\r\n      var x1 = Math.cos((18 + 72 * 3) / 180 * Math.PI) * outerR;\r\n      var y1 = Math.sin((18 + 72 * 3) / 180 * Math.PI) * outerR; // left bottom circle\r\n\r\n      group.addShape('circle', {\r\n        attrs: __assign(__assign({}, markStyle), {\r\n          x: x1,\r\n          y: -y1,\r\n          r: markSize / 2 || markR || 5\r\n        }),\r\n        className: 'link-point-left-bottom',\r\n        name: 'link-point-left-bottom'\r\n      });\r\n    }\r\n\r\n    if (rightBottom) {\r\n      // up down left right 四个方向的坐标均不相同\r\n      var x1 = Math.cos((18 + 72 * 4) / 180 * Math.PI) * outerR;\r\n      var y1 = Math.sin((18 + 72 * 4) / 180 * Math.PI) * outerR; // left bottom circle\r\n\r\n      group.addShape('circle', {\r\n        attrs: __assign(__assign({}, markStyle), {\r\n          x: x1,\r\n          y: -y1,\r\n          r: markSize / 2 || markR || 5\r\n        }),\r\n        className: 'link-point-right-bottom',\r\n        name: 'link-point-right-bottom'\r\n      });\r\n    }\r\n  },\r\n  getPath: function getPath(cfg) {\r\n    var size = this.getSize(cfg);\r\n    var outerR = size[0];\r\n    var defaultInnerR = outerR * 3 / 8;\r\n    var innerR = cfg.innerR || defaultInnerR;\r\n    var path = [];\r\n\r\n    for (var i = 0; i < 5; i++) {\r\n      var x1 = Math.cos((18 + 72 * i) / 180 * Math.PI) * outerR;\r\n      var y1 = Math.sin((18 + 72 * i) / 180 * Math.PI) * outerR;\r\n      var x2 = Math.cos((54 + 72 * i) / 180 * Math.PI) * innerR;\r\n      var y2 = Math.sin((54 + 72 * i) / 180 * Math.PI) * innerR;\r\n\r\n      if (i === 0) {\r\n        path.push(['M', x1, -y1]);\r\n      } else {\r\n        path.push(['L', x1, -y1]);\r\n      }\r\n\r\n      path.push(['L', x2, -y2]);\r\n    }\r\n\r\n    path.push(['Z']);\r\n    return path;\r\n  },\r\n\r\n  /**\r\n   * 获取节点的样式，供基于该节点自定义时使用\r\n   * @param {Object} cfg 节点数据模型\r\n   * @return {Object} 节点的样式\r\n   */\r\n  getShapeStyle: function getShapeStyle(cfg) {\r\n    var defaultStyle = this.getOptions(cfg).style;\r\n    var strokeStyle = {\r\n      stroke: cfg.color\r\n    }; // 如果设置了color，则覆盖原来默认的 stroke 属性。但 cfg 中但 stroke 属性优先级更高\r\n\r\n    var style = mix({}, defaultStyle, strokeStyle);\r\n    var path = this.getPath(cfg);\r\n\r\n    var styles = __assign({\r\n      path: path\r\n    }, style);\r\n\r\n    return styles;\r\n  },\r\n  update: function update(cfg, item) {\r\n    var group = item.getContainer(); // 这里不传 cfg 参数是因为 cfg.style 需要最后覆盖样式\r\n\r\n    var defaultStyle = this.getOptions({}).style;\r\n    var path = this.getPath(cfg); // 下面这些属性需要覆盖默认样式与目前样式，但若在 cfg 中有指定则应该被 cfg 的相应配置覆盖。\r\n\r\n    var strokeStyle = {\r\n      stroke: cfg.color,\r\n      path: path\r\n    }; // 与 getShapeStyle 不同在于，update 时需要获取到当前的 style 进行融合。即新传入的配置项中没有涉及的属性，保留当前的配置。\r\n\r\n    var keyShape = item.get('keyShape');\r\n    var style = mix({}, defaultStyle, keyShape.attr(), strokeStyle);\r\n    style = mix(style, cfg.style);\r\n    this.updateShape(cfg, item, style, true);\r\n    this.updateLinkPoints(cfg, group);\r\n  },\r\n\r\n  /**\r\n   * 更新linkPoints\r\n   * @param {Object} cfg 节点数据配置项\r\n   * @param {Group} group Item所在的group\r\n   */\r\n  updateLinkPoints: function updateLinkPoints(cfg, group) {\r\n    var defaultLinkPoints = this.getOptions({}).linkPoints;\r\n    var markLeft = group.find(function (element) {\r\n      return element.get('className') === 'link-point-left';\r\n    });\r\n    var markRight = group.find(function (element) {\r\n      return element.get('className') === 'link-point-right';\r\n    });\r\n    var markTop = group.find(function (element) {\r\n      return element.get('className') === 'link-point-top';\r\n    });\r\n    var markLeftBottom = group.find(function (element) {\r\n      return element.get('className') === 'link-point-left-bottom';\r\n    });\r\n    var markRightBottom = group.find(function (element) {\r\n      return element.get('className') === 'link-point-right-bottom';\r\n    });\r\n    var currentLinkPoints = defaultLinkPoints;\r\n    var existLinkPoint = markLeft || markRight || markTop || markLeftBottom || markRightBottom;\r\n\r\n    if (existLinkPoint) {\r\n      currentLinkPoints = existLinkPoint.attr();\r\n    }\r\n\r\n    var linkPoints = mix({}, currentLinkPoints, cfg.linkPoints);\r\n    var markFill = linkPoints.fill,\r\n        markStroke = linkPoints.stroke,\r\n        borderWidth = linkPoints.lineWidth;\r\n    var markSize = linkPoints.size / 2;\r\n    if (!markSize) markSize = linkPoints.r;\r\n\r\n    var _a = cfg.linkPoints ? cfg.linkPoints : {\r\n      left: undefined,\r\n      right: undefined,\r\n      top: undefined,\r\n      leftBottom: undefined,\r\n      rightBottom: undefined\r\n    },\r\n        left = _a.left,\r\n        right = _a.right,\r\n        top = _a.top,\r\n        leftBottom = _a.leftBottom,\r\n        rightBottom = _a.rightBottom;\r\n\r\n    var size = this.getSize(cfg);\r\n    var outerR = size[0];\r\n    var styles = {\r\n      r: markSize,\r\n      fill: markFill,\r\n      stroke: markStroke,\r\n      lineWidth: borderWidth\r\n    };\r\n    var x = Math.cos((18 + 72 * 0) / 180 * Math.PI) * outerR;\r\n    var y = Math.sin((18 + 72 * 0) / 180 * Math.PI) * outerR;\r\n\r\n    if (markRight) {\r\n      if (!right && right !== undefined) {\r\n        markRight.remove();\r\n      } else {\r\n        markRight.attr(__assign(__assign({}, styles), {\r\n          x: x,\r\n          y: -y\r\n        }));\r\n      }\r\n    } else if (right) {\r\n      group.addShape('circle', {\r\n        attrs: __assign(__assign({}, styles), {\r\n          x: x,\r\n          y: -y\r\n        }),\r\n        className: 'link-point-right',\r\n        name: 'link-point-right',\r\n        isAnchorPoint: true\r\n      });\r\n    }\r\n\r\n    x = Math.cos((18 + 72 * 1) / 180 * Math.PI) * outerR;\r\n    y = Math.sin((18 + 72 * 1) / 180 * Math.PI) * outerR;\r\n\r\n    if (markTop) {\r\n      if (!top && top !== undefined) {\r\n        markTop.remove();\r\n      } else {\r\n        markTop.attr(__assign(__assign({}, styles), {\r\n          x: x,\r\n          y: -y\r\n        }));\r\n      }\r\n    } else if (top) {\r\n      group.addShape('circle', {\r\n        attrs: __assign(__assign({}, styles), {\r\n          x: x,\r\n          y: -y\r\n        }),\r\n        className: 'link-point-top',\r\n        name: 'link-point-top',\r\n        isAnchorPoint: true\r\n      });\r\n    }\r\n\r\n    x = Math.cos((18 + 72 * 2) / 180 * Math.PI) * outerR;\r\n    y = Math.sin((18 + 72 * 2) / 180 * Math.PI) * outerR;\r\n\r\n    if (markLeft) {\r\n      if (!left && left !== undefined) {\r\n        markLeft.remove();\r\n      } else {\r\n        markLeft.attr(__assign(__assign({}, styles), {\r\n          x: x,\r\n          y: -y\r\n        }));\r\n      }\r\n    } else if (left) {\r\n      group.addShape('circle', {\r\n        attrs: __assign(__assign({}, styles), {\r\n          x: x,\r\n          y: -y\r\n        }),\r\n        className: 'link-point-left',\r\n        name: 'link-point-left',\r\n        isAnchorPoint: true\r\n      });\r\n    }\r\n\r\n    x = Math.cos((18 + 72 * 3) / 180 * Math.PI) * outerR;\r\n    y = Math.sin((18 + 72 * 3) / 180 * Math.PI) * outerR;\r\n\r\n    if (markLeftBottom) {\r\n      if (!leftBottom && leftBottom !== undefined) {\r\n        markLeftBottom.remove();\r\n      } else {\r\n        markLeftBottom.attr(__assign(__assign({}, styles), {\r\n          x: x,\r\n          y: -y\r\n        }));\r\n      }\r\n    } else if (leftBottom) {\r\n      group.addShape('circle', {\r\n        attrs: __assign(__assign({}, styles), {\r\n          x: x,\r\n          y: -y\r\n        }),\r\n        className: 'link-point-left-bottom',\r\n        name: 'link-point-left-bottom',\r\n        isAnchorPoint: true\r\n      });\r\n    }\r\n\r\n    x = Math.cos((18 + 72 * 4) / 180 * Math.PI) * outerR;\r\n    y = Math.sin((18 + 72 * 4) / 180 * Math.PI) * outerR;\r\n\r\n    if (markRightBottom) {\r\n      if (!rightBottom && rightBottom !== undefined) {\r\n        markLeftBottom.remove();\r\n      } else {\r\n        markRightBottom.attr(__assign(__assign({}, styles), {\r\n          x: x,\r\n          y: -y\r\n        }));\r\n      }\r\n    } else if (rightBottom) {\r\n      group.addShape('circle', {\r\n        attrs: __assign(__assign({}, styles), {\r\n          x: x,\r\n          y: -y\r\n        }),\r\n        className: 'link-point-right-bottom',\r\n        name: 'link-point-right-bottom',\r\n        isAnchorPoint: true\r\n      });\r\n    }\r\n  }\r\n}, 'single-node');"]},"metadata":{},"sourceType":"module"}