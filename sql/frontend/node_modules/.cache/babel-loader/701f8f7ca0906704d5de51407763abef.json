{"ast":null,"code":"var DEFAULT_TRIGGER = 'click';\nvar ALLOW_EVENTS = ['click', 'dblclick'];\nexport default {\n  getDefaultCfg: function getDefaultCfg() {\n    return {\n      /**\r\n       * 发生收缩/扩展变化时的回调\r\n       */\n      trigger: DEFAULT_TRIGGER,\n      onChange: function onChange() {}\n    };\n  },\n  getEvents: function getEvents() {\n    var _a;\n\n    var trigger; // 检测输入是否合法\n\n    if (ALLOW_EVENTS.includes(this.trigger)) {\n      trigger = this.trigger;\n    } else {\n      trigger = DEFAULT_TRIGGER; // eslint-disable-next-line no-console\n\n      console.warn(\"Behavior collapse-expand 的 trigger 参数不合法，请输入 'click' 或 'dblclick'\");\n    }\n\n    return _a = {}, _a[\"node:\" + trigger] = 'onNodeClick', // 支持移动端事件\n    _a.touchstart = 'onNodeClick', _a;\n  },\n  onNodeClick: function onNodeClick(e) {\n    var item = e.item;\n    if (!item) return; // 如果节点进行过更新，model 会进行 merge，直接改 model 就不能改布局，所以需要去改源数据\n\n    var sourceData = this.graph.findDataById(item.get('id'));\n\n    if (!sourceData) {\n      return;\n    }\n\n    var children = sourceData.children; // 叶子节点的收缩和展开没有意义\n\n    if (!children || children.length === 0) {\n      return;\n    }\n\n    var collapsed = !sourceData.collapsed;\n\n    if (!this.shouldBegin(e, collapsed)) {\n      return;\n    }\n\n    sourceData.collapsed = collapsed;\n    item.getModel().collapsed = collapsed;\n    this.graph.emit('itemcollapsed', {\n      item: e.item,\n      collapsed: collapsed\n    });\n\n    if (!this.shouldUpdate(e, collapsed)) {\n      return;\n    }\n\n    this.onChange(item, collapsed);\n    this.graph.layout();\n  }\n};","map":{"version":3,"sources":["D:/Code/sqlindex2/sql/frontend/node_modules/@antv/g6-pc/es/behavior/collapse-expand.js"],"names":["DEFAULT_TRIGGER","ALLOW_EVENTS","getDefaultCfg","trigger","onChange","getEvents","_a","includes","console","warn","touchstart","onNodeClick","e","item","sourceData","graph","findDataById","get","children","length","collapsed","shouldBegin","getModel","emit","shouldUpdate","layout"],"mappings":"AAAA,IAAIA,eAAe,GAAG,OAAtB;AACA,IAAIC,YAAY,GAAG,CAAC,OAAD,EAAU,UAAV,CAAnB;AACA,eAAe;AACbC,EAAAA,aAAa,EAAE,SAASA,aAAT,GAAyB;AACtC,WAAO;AACL;AACN;AACA;AACMC,MAAAA,OAAO,EAAEH,eAJJ;AAKLI,MAAAA,QAAQ,EAAE,SAASA,QAAT,GAAoB,CAAE;AAL3B,KAAP;AAOD,GATY;AAUbC,EAAAA,SAAS,EAAE,SAASA,SAAT,GAAqB;AAC9B,QAAIC,EAAJ;;AAEA,QAAIH,OAAJ,CAH8B,CAGjB;;AAEb,QAAIF,YAAY,CAACM,QAAb,CAAsB,KAAKJ,OAA3B,CAAJ,EAAyC;AACvCA,MAAAA,OAAO,GAAG,KAAKA,OAAf;AACD,KAFD,MAEO;AACLA,MAAAA,OAAO,GAAGH,eAAV,CADK,CACsB;;AAE3BQ,MAAAA,OAAO,CAACC,IAAR,CAAa,mEAAb;AACD;;AAED,WAAOH,EAAE,GAAG,EAAL,EAASA,EAAE,CAAC,UAAUH,OAAX,CAAF,GAAwB,aAAjC,EAAgD;AACvDG,IAAAA,EAAE,CAACI,UAAH,GAAgB,aADT,EACwBJ,EAD/B;AAED,GAzBY;AA0BbK,EAAAA,WAAW,EAAE,SAASA,WAAT,CAAqBC,CAArB,EAAwB;AACnC,QAAIC,IAAI,GAAGD,CAAC,CAACC,IAAb;AACA,QAAI,CAACA,IAAL,EAAW,OAFwB,CAEhB;;AAEnB,QAAIC,UAAU,GAAG,KAAKC,KAAL,CAAWC,YAAX,CAAwBH,IAAI,CAACI,GAAL,CAAS,IAAT,CAAxB,CAAjB;;AAEA,QAAI,CAACH,UAAL,EAAiB;AACf;AACD;;AAED,QAAII,QAAQ,GAAGJ,UAAU,CAACI,QAA1B,CAVmC,CAUC;;AAEpC,QAAI,CAACA,QAAD,IAAaA,QAAQ,CAACC,MAAT,KAAoB,CAArC,EAAwC;AACtC;AACD;;AAED,QAAIC,SAAS,GAAG,CAACN,UAAU,CAACM,SAA5B;;AAEA,QAAI,CAAC,KAAKC,WAAL,CAAiBT,CAAjB,EAAoBQ,SAApB,CAAL,EAAqC;AACnC;AACD;;AAEDN,IAAAA,UAAU,CAACM,SAAX,GAAuBA,SAAvB;AACAP,IAAAA,IAAI,CAACS,QAAL,GAAgBF,SAAhB,GAA4BA,SAA5B;AACA,SAAKL,KAAL,CAAWQ,IAAX,CAAgB,eAAhB,EAAiC;AAC/BV,MAAAA,IAAI,EAAED,CAAC,CAACC,IADuB;AAE/BO,MAAAA,SAAS,EAAEA;AAFoB,KAAjC;;AAKA,QAAI,CAAC,KAAKI,YAAL,CAAkBZ,CAAlB,EAAqBQ,SAArB,CAAL,EAAsC;AACpC;AACD;;AAED,SAAKhB,QAAL,CAAcS,IAAd,EAAoBO,SAApB;AACA,SAAKL,KAAL,CAAWU,MAAX;AACD;AA7DY,CAAf","sourcesContent":["var DEFAULT_TRIGGER = 'click';\r\nvar ALLOW_EVENTS = ['click', 'dblclick'];\r\nexport default {\r\n  getDefaultCfg: function getDefaultCfg() {\r\n    return {\r\n      /**\r\n       * 发生收缩/扩展变化时的回调\r\n       */\r\n      trigger: DEFAULT_TRIGGER,\r\n      onChange: function onChange() {}\r\n    };\r\n  },\r\n  getEvents: function getEvents() {\r\n    var _a;\r\n\r\n    var trigger; // 检测输入是否合法\r\n\r\n    if (ALLOW_EVENTS.includes(this.trigger)) {\r\n      trigger = this.trigger;\r\n    } else {\r\n      trigger = DEFAULT_TRIGGER; // eslint-disable-next-line no-console\r\n\r\n      console.warn(\"Behavior collapse-expand 的 trigger 参数不合法，请输入 'click' 或 'dblclick'\");\r\n    }\r\n\r\n    return _a = {}, _a[\"node:\" + trigger] = 'onNodeClick', // 支持移动端事件\r\n    _a.touchstart = 'onNodeClick', _a;\r\n  },\r\n  onNodeClick: function onNodeClick(e) {\r\n    var item = e.item;\r\n    if (!item) return; // 如果节点进行过更新，model 会进行 merge，直接改 model 就不能改布局，所以需要去改源数据\r\n\r\n    var sourceData = this.graph.findDataById(item.get('id'));\r\n\r\n    if (!sourceData) {\r\n      return;\r\n    }\r\n\r\n    var children = sourceData.children; // 叶子节点的收缩和展开没有意义\r\n\r\n    if (!children || children.length === 0) {\r\n      return;\r\n    }\r\n\r\n    var collapsed = !sourceData.collapsed;\r\n\r\n    if (!this.shouldBegin(e, collapsed)) {\r\n      return;\r\n    }\r\n\r\n    sourceData.collapsed = collapsed;\r\n    item.getModel().collapsed = collapsed;\r\n    this.graph.emit('itemcollapsed', {\r\n      item: e.item,\r\n      collapsed: collapsed\r\n    });\r\n\r\n    if (!this.shouldUpdate(e, collapsed)) {\r\n      return;\r\n    }\r\n\r\n    this.onChange(item, collapsed);\r\n    this.graph.layout();\r\n  }\r\n};"]},"metadata":{},"sourceType":"module"}