{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nimport React, { useEffect } from 'react';\nimport G6 from '@antv/g6';\nimport { ErrorBoundary } from '../../base';\nimport useGraph from '../../hooks/useGraph';\nimport useProps from '../../hooks/useProps';\nimport ChartLoading from '../../util/createLoading';\nimport { getGraphSize, getGraphId, bindSourceMapCollapseEvents, processMinimap, renderGraph, getCommonConfig, getArrowCfg, bindStateEvents } from '../utils';\nimport { defaultFlowGraphAnchorPoints, defaultNodeSize, defaultStateStyles, defaultNodeStyle } from '../constants';\nimport { registerFundFlowItems } from './customItem';\nvar graphs = {};\nregisterFundFlowItems();\nvar defaultLayout = {\n  type: 'dagre',\n  rankdir: 'LR',\n  nodesep: 30,\n  ranksep: 50\n};\nvar defaultProps = {\n  nodeCfg: {\n    type: 'fund-card',\n    size: defaultNodeSize,\n    style: defaultNodeStyle,\n    anchorPoints: defaultFlowGraphAnchorPoints,\n    nodeStateStyles: defaultStateStyles,\n    padding: 6\n  },\n  edgeCfg: {\n    type: 'fund-polyline',\n    edgeStateStyles: defaultStateStyles,\n    style: {\n      stroke: '#40a9ff'\n    },\n    endArrow: {\n      fill: '#40a9ff'\n    }\n  },\n  behaviors: ['zoom-canvas', 'drag-canvas'],\n  layout: defaultLayout,\n  animate: true,\n  autoFit: true,\n  fitCenter: true,\n  style: {\n    height: 'inherit'\n  }\n};\n\nvar getEdgeStateStyles = function (edgeStateStyles) {\n  if (!edgeStateStyles) {\n    return;\n  }\n\n  var _a = edgeStateStyles.hover,\n      hover = _a === void 0 ? {} : _a;\n  var endArrow = hover.endArrow,\n      startArrow = hover.startArrow;\n\n  if (!endArrow && !startArrow) {\n    return edgeStateStyles;\n  }\n\n  return {\n    hover: __assign(__assign({}, hover), {\n      endArrow: endArrow ? getArrowCfg(endArrow) : false,\n      startArrow: startArrow ? getArrowCfg(startArrow) : false\n    })\n  };\n};\n\nvar FundFlowGraph = function (props) {\n  var uProps = useProps(props, defaultProps).uProps;\n  var data = uProps.data,\n      className = uProps.className,\n      style = uProps.style,\n      width = uProps.width,\n      height = uProps.height,\n      nodeCfg = uProps.nodeCfg,\n      edgeCfg = uProps.edgeCfg,\n      behaviors = uProps.behaviors,\n      layout = uProps.layout,\n      animate = uProps.animate,\n      minimapCfg = uProps.minimapCfg,\n      autoFit = uProps.autoFit,\n      fitCenter = uProps.fitCenter,\n      markerCfg = uProps.markerCfg,\n      onReady = uProps.onReady,\n      loading = uProps.loading,\n      loadingTemplate = uProps.loadingTemplate,\n      errorTemplate = uProps.errorTemplate;\n\n  var _a = nodeCfg !== null && nodeCfg !== void 0 ? nodeCfg : {},\n      nodeType = _a.type,\n      nodeSize = _a.size,\n      nodeAnchorPoints = _a.anchorPoints,\n      nodeStateStyles = _a.nodeStateStyles,\n      nodeStyle = _a.style,\n      nodeLabelCfg = _a.label;\n\n  var _b = edgeCfg !== null && edgeCfg !== void 0 ? edgeCfg : {},\n      edgeType = _b.type,\n      edgeStyle = _b.style,\n      startArrowCfg = _b.startArrow,\n      endArrowCfg = _b.endArrow,\n      labelCfg = _b.label,\n      edgeStateStyles = _b.edgeStateStyles;\n\n  var container = React.useRef(null);\n  var graph = React.useRef(null);\n  var graphId = getGraphId(graph);\n  useGraph(graphs[graphId], uProps, container);\n  useEffect(function () {\n    var graphSize = getGraphSize(width, height, container);\n    var graph = graphs[graphId];\n\n    if (!graph) {\n      graph = new G6.Graph({\n        container: container.current,\n        width: graphSize[0],\n        height: graphSize[1],\n        animate: animate,\n        modes: {\n          default: behaviors\n        },\n        defaultNode: {\n          type: nodeType,\n          size: nodeSize,\n          anchorPoints: nodeAnchorPoints,\n          nodeCfg: nodeCfg\n        },\n        defaultEdge: {\n          type: edgeType,\n          edgeCfg: edgeCfg\n        },\n        nodeStateStyles: nodeStateStyles,\n        edgeStateStyles: getEdgeStateStyles(edgeStateStyles),\n        layout: layout,\n        fitView: autoFit,\n        fitCenter: fitCenter\n      });\n      graphs[graphId] = graph;\n    } // defaultNode 默认只能绑定 plainObject，针对 Function 类型需要通过该模式绑定\n\n\n    graph.node(function (node) {\n      var _a;\n\n      if (node.type === 'fund-card') {\n        node.markerCfg = markerCfg;\n        return {};\n      }\n\n      var style = (nodeLabelCfg !== null && nodeLabelCfg !== void 0 ? nodeLabelCfg : {}).style;\n      return {\n        label: (_a = node.value) === null || _a === void 0 ? void 0 : _a.text,\n        labelCfg: {\n          style: getCommonConfig(style, node, graph)\n        },\n        style: __assign({\n          stroke: '#ccc'\n        }, typeof nodeStyle === 'function' ? nodeStyle(node, graph) : nodeStyle)\n      };\n    });\n\n    if (edgeType !== 'fund-polyline') {\n      graph.edge(function (edge) {\n        var startArrow = getArrowCfg(startArrowCfg, edge);\n        var endArrow = getArrowCfg(endArrowCfg, edge);\n        var style = (labelCfg !== null && labelCfg !== void 0 ? labelCfg : {}).style;\n        var value = edge.value;\n        return {\n          label: typeof value === 'object' ? value === null || value === void 0 ? void 0 : value.text : value,\n          labelCfg: {\n            style: getCommonConfig(style, edge, graph)\n          },\n          style: __assign({\n            stroke: '#ccc',\n            startArrow: startArrow,\n            endArrow: endArrow\n          }, typeof edgeStyle === 'function' ? edgeStyle(edge, graph) : edgeStyle)\n        };\n      });\n    }\n\n    processMinimap(minimapCfg, graph);\n    bindStateEvents(graph, uProps);\n\n    if (markerCfg) {\n      bindSourceMapCollapseEvents(graph);\n    }\n\n    renderGraph(graph, data);\n\n    if (onReady) {\n      onReady(graph);\n    }\n\n    return function () {\n      if (graphs[graphId]) {\n        graphs[graphId].destroy();\n        delete graphs[graphId];\n      }\n    };\n  }, []);\n  return React.createElement(ErrorBoundary, {\n    errorTemplate: errorTemplate\n  }, loading && React.createElement(ChartLoading, {\n    loadingTemplate: loadingTemplate\n  }), React.createElement(\"div\", {\n    className: className,\n    style: style,\n    ref: container\n  }));\n};\n\nexport default FundFlowGraph;","map":{"version":3,"sources":["D:/SQL/sqlindex2/sql/frontend/node_modules/@ant-design/charts/es/graphs/fundFlowGraph/index.js"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","React","useEffect","G6","ErrorBoundary","useGraph","useProps","ChartLoading","getGraphSize","getGraphId","bindSourceMapCollapseEvents","processMinimap","renderGraph","getCommonConfig","getArrowCfg","bindStateEvents","defaultFlowGraphAnchorPoints","defaultNodeSize","defaultStateStyles","defaultNodeStyle","registerFundFlowItems","graphs","defaultLayout","type","rankdir","nodesep","ranksep","defaultProps","nodeCfg","size","style","anchorPoints","nodeStateStyles","padding","edgeCfg","edgeStateStyles","stroke","endArrow","fill","behaviors","layout","animate","autoFit","fitCenter","height","getEdgeStateStyles","_a","hover","startArrow","FundFlowGraph","props","uProps","data","className","width","minimapCfg","markerCfg","onReady","loading","loadingTemplate","errorTemplate","nodeType","nodeSize","nodeAnchorPoints","nodeStyle","nodeLabelCfg","label","_b","edgeType","edgeStyle","startArrowCfg","endArrowCfg","labelCfg","container","useRef","graph","graphId","graphSize","Graph","current","modes","default","defaultNode","defaultEdge","fitView","node","value","text","edge","destroy","createElement","ref"],"mappings":"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","sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport React, { useEffect } from 'react';\nimport G6 from '@antv/g6';\nimport { ErrorBoundary } from '../../base';\nimport useGraph from '../../hooks/useGraph';\nimport useProps from '../../hooks/useProps';\nimport ChartLoading from '../../util/createLoading';\nimport { getGraphSize, getGraphId, bindSourceMapCollapseEvents, processMinimap, renderGraph, getCommonConfig, getArrowCfg, bindStateEvents, } from '../utils';\nimport { defaultFlowGraphAnchorPoints, defaultNodeSize, defaultStateStyles, defaultNodeStyle, } from '../constants';\nimport { registerFundFlowItems } from './customItem';\nvar graphs = {};\nregisterFundFlowItems();\nvar defaultLayout = {\n    type: 'dagre',\n    rankdir: 'LR',\n    nodesep: 30,\n    ranksep: 50,\n};\nvar defaultProps = {\n    nodeCfg: {\n        type: 'fund-card',\n        size: defaultNodeSize,\n        style: defaultNodeStyle,\n        anchorPoints: defaultFlowGraphAnchorPoints,\n        nodeStateStyles: defaultStateStyles,\n        padding: 6,\n    },\n    edgeCfg: {\n        type: 'fund-polyline',\n        edgeStateStyles: defaultStateStyles,\n        style: {\n            stroke: '#40a9ff',\n        },\n        endArrow: {\n            fill: '#40a9ff',\n        },\n    },\n    behaviors: ['zoom-canvas', 'drag-canvas'],\n    layout: defaultLayout,\n    animate: true,\n    autoFit: true,\n    fitCenter: true,\n    style: {\n        height: 'inherit',\n    },\n};\nvar getEdgeStateStyles = function (edgeStateStyles) {\n    if (!edgeStateStyles) {\n        return;\n    }\n    var _a = edgeStateStyles.hover, hover = _a === void 0 ? {} : _a;\n    var endArrow = hover.endArrow, startArrow = hover.startArrow;\n    if (!endArrow && !startArrow) {\n        return edgeStateStyles;\n    }\n    return {\n        hover: __assign(__assign({}, hover), { endArrow: endArrow ? getArrowCfg(endArrow) : false, startArrow: startArrow ? getArrowCfg(startArrow) : false }),\n    };\n};\nvar FundFlowGraph = function (props) {\n    var uProps = useProps(props, defaultProps).uProps;\n    var data = uProps.data, className = uProps.className, style = uProps.style, width = uProps.width, height = uProps.height, nodeCfg = uProps.nodeCfg, edgeCfg = uProps.edgeCfg, behaviors = uProps.behaviors, layout = uProps.layout, animate = uProps.animate, minimapCfg = uProps.minimapCfg, autoFit = uProps.autoFit, fitCenter = uProps.fitCenter, markerCfg = uProps.markerCfg, onReady = uProps.onReady, loading = uProps.loading, loadingTemplate = uProps.loadingTemplate, errorTemplate = uProps.errorTemplate;\n    var _a = nodeCfg !== null && nodeCfg !== void 0 ? nodeCfg : {}, nodeType = _a.type, nodeSize = _a.size, nodeAnchorPoints = _a.anchorPoints, nodeStateStyles = _a.nodeStateStyles, nodeStyle = _a.style, nodeLabelCfg = _a.label;\n    var _b = edgeCfg !== null && edgeCfg !== void 0 ? edgeCfg : {}, edgeType = _b.type, edgeStyle = _b.style, startArrowCfg = _b.startArrow, endArrowCfg = _b.endArrow, labelCfg = _b.label, edgeStateStyles = _b.edgeStateStyles;\n    var container = React.useRef(null);\n    var graph = React.useRef(null);\n    var graphId = getGraphId(graph);\n    useGraph(graphs[graphId], uProps, container);\n    useEffect(function () {\n        var graphSize = getGraphSize(width, height, container);\n        var graph = graphs[graphId];\n        if (!graph) {\n            graph = new G6.Graph({\n                container: container.current,\n                width: graphSize[0],\n                height: graphSize[1],\n                animate: animate,\n                modes: {\n                    default: behaviors,\n                },\n                defaultNode: {\n                    type: nodeType,\n                    size: nodeSize,\n                    anchorPoints: nodeAnchorPoints,\n                    nodeCfg: nodeCfg,\n                },\n                defaultEdge: {\n                    type: edgeType,\n                    edgeCfg: edgeCfg,\n                },\n                nodeStateStyles: nodeStateStyles,\n                edgeStateStyles: getEdgeStateStyles(edgeStateStyles),\n                layout: layout,\n                fitView: autoFit,\n                fitCenter: fitCenter,\n            });\n            graphs[graphId] = graph;\n        }\n        // defaultNode 默认只能绑定 plainObject，针对 Function 类型需要通过该模式绑定\n        graph.node(function (node) {\n            var _a;\n            if (node.type === 'fund-card') {\n                node.markerCfg = markerCfg;\n                return {};\n            }\n            var style = (nodeLabelCfg !== null && nodeLabelCfg !== void 0 ? nodeLabelCfg : {}).style;\n            return {\n                label: (_a = node.value) === null || _a === void 0 ? void 0 : _a.text,\n                labelCfg: {\n                    style: getCommonConfig(style, node, graph),\n                },\n                style: __assign({ stroke: '#ccc' }, (typeof nodeStyle === 'function' ? nodeStyle(node, graph) : nodeStyle)),\n            };\n        });\n        if (edgeType !== 'fund-polyline') {\n            graph.edge(function (edge) {\n                var startArrow = getArrowCfg(startArrowCfg, edge);\n                var endArrow = getArrowCfg(endArrowCfg, edge);\n                var style = (labelCfg !== null && labelCfg !== void 0 ? labelCfg : {}).style;\n                var value = edge.value;\n                return {\n                    label: typeof value === 'object' ? value === null || value === void 0 ? void 0 : value.text : value,\n                    labelCfg: {\n                        style: getCommonConfig(style, edge, graph),\n                    },\n                    style: __assign({ stroke: '#ccc', startArrow: startArrow, endArrow: endArrow }, (typeof edgeStyle === 'function' ? edgeStyle(edge, graph) : edgeStyle)),\n                };\n            });\n        }\n        processMinimap(minimapCfg, graph);\n        bindStateEvents(graph, uProps);\n        if (markerCfg) {\n            bindSourceMapCollapseEvents(graph);\n        }\n        renderGraph(graph, data);\n        if (onReady) {\n            onReady(graph);\n        }\n        return function () {\n            if (graphs[graphId]) {\n                graphs[graphId].destroy();\n                delete graphs[graphId];\n            }\n        };\n    }, []);\n    return (React.createElement(ErrorBoundary, { errorTemplate: errorTemplate },\n        loading && React.createElement(ChartLoading, { loadingTemplate: loadingTemplate }),\n        React.createElement(\"div\", { className: className, style: style, ref: container })));\n};\nexport default FundFlowGraph;\n"]},"metadata":{},"sourceType":"module"}