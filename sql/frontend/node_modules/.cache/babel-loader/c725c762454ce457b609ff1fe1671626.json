{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nimport { modifyCSS, createDom } from '@antv/dom-util';\nimport { isString } from '@antv/util';\nimport insertCss from 'insert-css';\nimport Base from '../base';\ninsertCss(\"\\n  .g6-component-contextmenu {\\n    border: 1px solid #e2e2e2;\\n    border-radius: 4px;\\n    font-size: 12px;\\n    color: #545454;\\n    background-color: rgba(255, 255, 255, 0.9);\\n    padding: 10px 8px;\\n    box-shadow: rgb(174, 174, 174) 0px 0px 10px;\\n  }\\n  .g6-contextmenu-ul {\\n    padding: 0;\\n    margin: 0;\\n    list-style: none;\\n  }\\n\\n\");\n\nvar Menu =\n/** @class */\nfunction (_super) {\n  __extends(Menu, _super);\n\n  function Menu() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Menu.prototype.getDefaultCfgs = function () {\n    return {\n      offsetX: 6,\n      offsetY: 6,\n      handleMenuClick: undefined,\n      // 指定菜单内容，function(e) {...}\n      getContent: function getContent(e) {\n        return \"\\n          <ul class='g6-contextmenu-ul'>\\n            <li>\\u83DC\\u5355\\u98791</li>\\n            <li>\\u83DC\\u5355\\u98792</li>\\n          </ul>\\n        \";\n      },\n      shouldBegin: function shouldBegin(e) {\n        return true;\n      },\n      // 菜单隐藏事件\n      onHide: function onHide() {\n        return true;\n      },\n      itemTypes: ['node', 'edge', 'combo'],\n      trigger: 'contextmenu'\n    };\n  }; // class-methods-use-this\n\n\n  Menu.prototype.getEvents = function () {\n    if (this.get('trigger') === 'click') {\n      return {\n        click: 'onMenuShow'\n      };\n    }\n\n    return {\n      contextmenu: 'onMenuShow'\n    };\n  };\n\n  Menu.prototype.init = function () {\n    var className = this.get('className');\n    var menu = createDom(\"<div class=\" + (className || 'g6-component-contextmenu') + \"></div>\");\n    modifyCSS(menu, {\n      top: '0px',\n      position: 'absolute',\n      visibility: 'hidden'\n    });\n    var container = this.get('container');\n\n    if (!container) {\n      container = this.get('graph').get('container');\n    }\n\n    if (isString(container)) {\n      container = document.getElementById(container);\n    }\n\n    container.appendChild(menu);\n    this.set('menu', menu);\n  };\n\n  Menu.prototype.onMenuShow = function (e) {\n    var self = this;\n    e.preventDefault();\n    e.stopPropagation();\n    var itemTypes = this.get('itemTypes');\n\n    if (!e.item) {\n      if (itemTypes.indexOf('canvas') === -1) {\n        self.onMenuHide();\n        return;\n      }\n    } else {\n      if (e.item && e.item.getType && itemTypes.indexOf(e.item.getType()) === -1) {\n        self.onMenuHide();\n        return;\n      }\n    }\n\n    var shouldBegin = this.get('shouldBegin');\n    if (!shouldBegin(e)) return;\n    var menuDom = this.get('menu');\n    var getContent = this.get('getContent');\n    var graph = this.get('graph');\n    var menu = getContent(e, graph);\n\n    if (isString(menu)) {\n      menuDom.innerHTML = menu;\n    } else {\n      menuDom.innerHTML = menu.outerHTML;\n    } // 清除之前监听的事件\n\n\n    this.removeMenuEventListener();\n    var handleMenuClick = this.get('handleMenuClick');\n\n    if (handleMenuClick) {\n      var handleMenuClickWrapper = function handleMenuClickWrapper(evt) {\n        handleMenuClick(evt.target, e.item, graph);\n      };\n\n      this.set('handleMenuClickWrapper', handleMenuClickWrapper);\n      menuDom.addEventListener('click', handleMenuClickWrapper);\n    }\n\n    var width = graph.get('width');\n    var height = graph.get('height');\n    var bbox = menuDom.getBoundingClientRect();\n    var offsetX = this.get('offsetX') || 0;\n    var offsetY = this.get('offsetY') || 0;\n    var graphTop = graph.getContainer().offsetTop;\n    var graphLeft = graph.getContainer().offsetLeft;\n    var x = e.canvasX + graphLeft + offsetX;\n    var y = e.canvasY + graphTop + offsetY; // when the menu is (part of) out of the canvas\n\n    if (x + bbox.width > width) {\n      x = e.canvasX - bbox.width - offsetX + graphLeft;\n    }\n\n    if (y + bbox.height > height) {\n      y = e.canvasY - bbox.height - offsetY + graphTop;\n    }\n\n    modifyCSS(menuDom, {\n      top: y + \"px\",\n      left: x + \"px\",\n      visibility: 'visible'\n    }); // 左键单击会触发 body 上监听的 click 事件，导致菜单展示出来后又立即被隐藏了，需要过滤掉\n\n    var triggeredByFirstClick = this.get('trigger') === 'click';\n\n    var handler = function handler(evt) {\n      if (triggeredByFirstClick) {\n        triggeredByFirstClick = false;\n        return;\n      }\n\n      self.onMenuHide();\n    }; // 如果在页面中其他任意地方进行click, 隐去菜单\n\n\n    document.body.addEventListener('click', handler);\n    this.set('handler', handler);\n  };\n\n  Menu.prototype.removeMenuEventListener = function () {\n    var handleMenuClickWrapper = this.get('handleMenuClickWrapper');\n    var handler = this.get('handler');\n\n    if (handleMenuClickWrapper) {\n      var menuDom = this.get('menu');\n      menuDom.removeEventListener('click', handleMenuClickWrapper);\n      this.set('handleMenuClickWrapper', null);\n    }\n\n    if (handler) {\n      document.body.removeEventListener('click', handler);\n    }\n  };\n\n  Menu.prototype.onMenuHide = function () {\n    var menuDom = this.get('menu');\n\n    if (menuDom) {\n      modifyCSS(menuDom, {\n        visibility: 'hidden'\n      });\n    } // 隐藏菜单后需要移除事件监听\n\n\n    this.removeMenuEventListener();\n  };\n\n  Menu.prototype.destroy = function () {\n    var menu = this.get('menu');\n    this.removeMenuEventListener();\n\n    if (menu) {\n      var container = this.get('container');\n\n      if (!container) {\n        container = this.get('graph').get('container');\n      }\n\n      if (isString(container)) {\n        container = document.getElementById(container);\n      }\n\n      container.removeChild(menu);\n    }\n  };\n\n  return Menu;\n}(Base);\n\nexport default Menu;","map":{"version":3,"sources":["E:/sqlindex2/sql/frontend/node_modules/@antv/g6-plugin/es/menu/index.js"],"names":["__extends","_extendStatics","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","constructor","create","modifyCSS","createDom","isString","insertCss","Base","Menu","_super","apply","arguments","getDefaultCfgs","offsetX","offsetY","handleMenuClick","undefined","getContent","e","shouldBegin","onHide","itemTypes","trigger","getEvents","get","click","contextmenu","init","className","menu","top","position","visibility","container","document","getElementById","appendChild","set","onMenuShow","self","preventDefault","stopPropagation","item","indexOf","onMenuHide","getType","menuDom","graph","innerHTML","outerHTML","removeMenuEventListener","handleMenuClickWrapper","evt","target","addEventListener","width","height","bbox","getBoundingClientRect","graphTop","getContainer","offsetTop","graphLeft","offsetLeft","x","canvasX","y","canvasY","left","triggeredByFirstClick","handler","body","removeEventListener","destroy","removeChild"],"mappings":"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","sourcesContent":["var __extends = this && this.__extends || function () {\r\n  var _extendStatics = function extendStatics(d, b) {\r\n    _extendStatics = Object.setPrototypeOf || {\r\n      __proto__: []\r\n    } instanceof Array && function (d, b) {\r\n      d.__proto__ = b;\r\n    } || function (d, b) {\r\n      for (var p in b) {\r\n        if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\r\n      }\r\n    };\r\n\r\n    return _extendStatics(d, b);\r\n  };\r\n\r\n  return function (d, b) {\r\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n\r\n    _extendStatics(d, b);\r\n\r\n    function __() {\r\n      this.constructor = d;\r\n    }\r\n\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n  };\r\n}();\r\n\r\nimport { modifyCSS, createDom } from '@antv/dom-util';\r\nimport { isString } from '@antv/util';\r\nimport insertCss from 'insert-css';\r\nimport Base from '../base';\r\ninsertCss(\"\\n  .g6-component-contextmenu {\\n    border: 1px solid #e2e2e2;\\n    border-radius: 4px;\\n    font-size: 12px;\\n    color: #545454;\\n    background-color: rgba(255, 255, 255, 0.9);\\n    padding: 10px 8px;\\n    box-shadow: rgb(174, 174, 174) 0px 0px 10px;\\n  }\\n  .g6-contextmenu-ul {\\n    padding: 0;\\n    margin: 0;\\n    list-style: none;\\n  }\\n\\n\");\r\n\r\nvar Menu =\r\n/** @class */\r\nfunction (_super) {\r\n  __extends(Menu, _super);\r\n\r\n  function Menu() {\r\n    return _super !== null && _super.apply(this, arguments) || this;\r\n  }\r\n\r\n  Menu.prototype.getDefaultCfgs = function () {\r\n    return {\r\n      offsetX: 6,\r\n      offsetY: 6,\r\n      handleMenuClick: undefined,\r\n      // 指定菜单内容，function(e) {...}\r\n      getContent: function getContent(e) {\r\n        return \"\\n          <ul class='g6-contextmenu-ul'>\\n            <li>\\u83DC\\u5355\\u98791</li>\\n            <li>\\u83DC\\u5355\\u98792</li>\\n          </ul>\\n        \";\r\n      },\r\n      shouldBegin: function shouldBegin(e) {\r\n        return true;\r\n      },\r\n      // 菜单隐藏事件\r\n      onHide: function onHide() {\r\n        return true;\r\n      },\r\n      itemTypes: ['node', 'edge', 'combo'],\r\n      trigger: 'contextmenu'\r\n    };\r\n  }; // class-methods-use-this\r\n\r\n\r\n  Menu.prototype.getEvents = function () {\r\n    if (this.get('trigger') === 'click') {\r\n      return {\r\n        click: 'onMenuShow'\r\n      };\r\n    }\r\n\r\n    return {\r\n      contextmenu: 'onMenuShow'\r\n    };\r\n  };\r\n\r\n  Menu.prototype.init = function () {\r\n    var className = this.get('className');\r\n    var menu = createDom(\"<div class=\" + (className || 'g6-component-contextmenu') + \"></div>\");\r\n    modifyCSS(menu, {\r\n      top: '0px',\r\n      position: 'absolute',\r\n      visibility: 'hidden'\r\n    });\r\n    var container = this.get('container');\r\n\r\n    if (!container) {\r\n      container = this.get('graph').get('container');\r\n    }\r\n\r\n    if (isString(container)) {\r\n      container = document.getElementById(container);\r\n    }\r\n\r\n    container.appendChild(menu);\r\n    this.set('menu', menu);\r\n  };\r\n\r\n  Menu.prototype.onMenuShow = function (e) {\r\n    var self = this;\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    var itemTypes = this.get('itemTypes');\r\n\r\n    if (!e.item) {\r\n      if (itemTypes.indexOf('canvas') === -1) {\r\n        self.onMenuHide();\r\n        return;\r\n      }\r\n    } else {\r\n      if (e.item && e.item.getType && itemTypes.indexOf(e.item.getType()) === -1) {\r\n        self.onMenuHide();\r\n        return;\r\n      }\r\n    }\r\n\r\n    var shouldBegin = this.get('shouldBegin');\r\n    if (!shouldBegin(e)) return;\r\n    var menuDom = this.get('menu');\r\n    var getContent = this.get('getContent');\r\n    var graph = this.get('graph');\r\n    var menu = getContent(e, graph);\r\n\r\n    if (isString(menu)) {\r\n      menuDom.innerHTML = menu;\r\n    } else {\r\n      menuDom.innerHTML = menu.outerHTML;\r\n    } // 清除之前监听的事件\r\n\r\n\r\n    this.removeMenuEventListener();\r\n    var handleMenuClick = this.get('handleMenuClick');\r\n\r\n    if (handleMenuClick) {\r\n      var handleMenuClickWrapper = function handleMenuClickWrapper(evt) {\r\n        handleMenuClick(evt.target, e.item, graph);\r\n      };\r\n\r\n      this.set('handleMenuClickWrapper', handleMenuClickWrapper);\r\n      menuDom.addEventListener('click', handleMenuClickWrapper);\r\n    }\r\n\r\n    var width = graph.get('width');\r\n    var height = graph.get('height');\r\n    var bbox = menuDom.getBoundingClientRect();\r\n    var offsetX = this.get('offsetX') || 0;\r\n    var offsetY = this.get('offsetY') || 0;\r\n    var graphTop = graph.getContainer().offsetTop;\r\n    var graphLeft = graph.getContainer().offsetLeft;\r\n    var x = e.canvasX + graphLeft + offsetX;\r\n    var y = e.canvasY + graphTop + offsetY; // when the menu is (part of) out of the canvas\r\n\r\n    if (x + bbox.width > width) {\r\n      x = e.canvasX - bbox.width - offsetX + graphLeft;\r\n    }\r\n\r\n    if (y + bbox.height > height) {\r\n      y = e.canvasY - bbox.height - offsetY + graphTop;\r\n    }\r\n\r\n    modifyCSS(menuDom, {\r\n      top: y + \"px\",\r\n      left: x + \"px\",\r\n      visibility: 'visible'\r\n    }); // 左键单击会触发 body 上监听的 click 事件，导致菜单展示出来后又立即被隐藏了，需要过滤掉\r\n\r\n    var triggeredByFirstClick = this.get('trigger') === 'click';\r\n\r\n    var handler = function handler(evt) {\r\n      if (triggeredByFirstClick) {\r\n        triggeredByFirstClick = false;\r\n        return;\r\n      }\r\n\r\n      self.onMenuHide();\r\n    }; // 如果在页面中其他任意地方进行click, 隐去菜单\r\n\r\n\r\n    document.body.addEventListener('click', handler);\r\n    this.set('handler', handler);\r\n  };\r\n\r\n  Menu.prototype.removeMenuEventListener = function () {\r\n    var handleMenuClickWrapper = this.get('handleMenuClickWrapper');\r\n    var handler = this.get('handler');\r\n\r\n    if (handleMenuClickWrapper) {\r\n      var menuDom = this.get('menu');\r\n      menuDom.removeEventListener('click', handleMenuClickWrapper);\r\n      this.set('handleMenuClickWrapper', null);\r\n    }\r\n\r\n    if (handler) {\r\n      document.body.removeEventListener('click', handler);\r\n    }\r\n  };\r\n\r\n  Menu.prototype.onMenuHide = function () {\r\n    var menuDom = this.get('menu');\r\n\r\n    if (menuDom) {\r\n      modifyCSS(menuDom, {\r\n        visibility: 'hidden'\r\n      });\r\n    } // 隐藏菜单后需要移除事件监听\r\n\r\n\r\n    this.removeMenuEventListener();\r\n  };\r\n\r\n  Menu.prototype.destroy = function () {\r\n    var menu = this.get('menu');\r\n    this.removeMenuEventListener();\r\n\r\n    if (menu) {\r\n      var container = this.get('container');\r\n\r\n      if (!container) {\r\n        container = this.get('graph').get('container');\r\n      }\r\n\r\n      if (isString(container)) {\r\n        container = document.getElementById(container);\r\n      }\r\n\r\n      container.removeChild(menu);\r\n    }\r\n  };\r\n\r\n  return Menu;\r\n}(Base);\r\n\r\nexport default Menu;"]},"metadata":{},"sourceType":"module"}